"use strict";(self.webpackChunkapaas_front_doc=self.webpackChunkapaas_front_doc||[]).push([[9142],{3143:n=>{n.exports=JSON.parse('{"blogPosts":[{"id":"TypeScript \u8fdb\u9636","metadata":{"permalink":"/apaas-front-doc/blog/TypeScript \u8fdb\u9636","source":"@site/blog/2024-10-13/index.md","title":"TypeScript \u8fdb\u9636","description":"\u7c7b\u578b","date":"2024-10-13T00:00:00.000Z","formattedDate":"2024\u5e7410\u670813\u65e5","tags":[{"label":"TypeScript","permalink":"/apaas-front-doc/blog/tags/type-script"}],"readingTime":7.985,"hasTruncateMarker":false,"authors":[{"name":"\u9ec4\u632f\u654f","title":"\u70df\u82b1\u6613\u51b7","job_no":25748,"url":"https://github.com/hzm0321","imageURL":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.92fa.com%2Fpic%2FTX1251_03.jpg&refer=http%3A%2F%2Fimg.92fa.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1670915005&t=61e1ff50cd599d4affcc74dfa4b7545d","key":"hzm"}],"frontMatter":{"slug":"TypeScript \u8fdb\u9636","title":"TypeScript \u8fdb\u9636","authors":["hzm"],"tags":["TypeScript"]},"nextItem":{"title":"\u52a8\u6001\u89c4\u5212\u603b\u7ed3","permalink":"/apaas-front-doc/blog/\u52a8\u6001\u89c4\u5212\u603b\u7ed3"}},"content":"## \u7c7b\u578b\\n\\n### \u539f\u59cb\u7c7b\u578b\\n* `boolean`: \u8868\u793a\u5e03\u5c14\u503c (true \u6216 false)\u3002\\n* `number`: \u8868\u793a\u6570\u5b57\uff08\u652f\u6301\u6574\u6570\u548c\u6d6e\u70b9\u6570\uff09\u3002\\n* `string`: \u8868\u793a\u5b57\u7b26\u4e32\u3002\\n* `null`: \u8868\u793a null \u503c\u3002\\n* `undefined`: \u8868\u793a undefined \u503c\u3002\\n* `symbol`: \u7528\u4e8e\u521b\u5efa\u552f\u4e00\u503c\u7684\u7c7b\u578b\u3002\\n\\n\\n### \u590d\u6742\u7c7b\u578b\\n* \u5927\u6574\u6570\u7c7b\u578b: `bigint`\u3002\\n* \u6570\u7ec4\u7c7b\u578b\uff1a`[]` \u6216 `Array<T>`\u3002\\n* \u5bf9\u8c61\u7c7b\u578b\uff1a`{}`\u3002\\n* object \u7c7b\u578b\uff1a`object`, **\u8868\u793a\u975e\u539f\u59cb\u7c7b\u578b**\u3002\\n* Object \u7c7b\u578b\uff1a**\u6240\u6709\u7c7b\u578b\uff08\u5305\u62ec\u539f\u59cb\u7c7b\u578b\uff09\u7684\u57fa\u7c7b**\u3002\\n* \u5143\u7ec4\u7c7b\u578b\uff1a`[T1, T2, ...]`\u3002\\n* \u679a\u4e3e\u7c7b\u578b\uff1a`enum`\u3002\\n* \u51fd\u6570\u7c7b\u578b\uff1a`(args) => returnType`\u3002\\n* \u7c7b\u7c7b\u578b\uff1a`class`\u3002\\n* \u63a5\u53e3\u7c7b\u578b\uff1a`interface`\u3002\\n* \u6cdb\u578b\u7c7b\u578b\uff1a`<T>`\u3002\\n* \u7c7b\u578b\u522b\u540d\uff1a`type`\u3002\\n* any \u7c7b\u578b\uff1a`any`\u3002\\n* unknown \u7c7b\u578b\uff1a`unknown`\u3002\\n* void \u7c7b\u578b\uff1a`void`\u3002\\n* never \u7c7b\u578b\uff1a`never`\u3002\\n* Promise \u7c7b\u578b\uff1a`Promise<T>`\u3002\\n\\n### \u8054\u5408\u7c7b\u578b\\n**\u8bed\u6cd5\u5f62\u5f0f\uff1a**\\n```ts\\nlet value: string | number;\\ntype Direction = \\"up\\" | \\"down\\" | \\"left\\" | \\"right\\";\\n```\\n**\u4f7f\u7528\uff1a**  \\n\u53ea\u6709\u5728\u5bf9`\u8054\u5408\u7684\u6bcf\u4e2a\u6210\u5458\u90fd\u6709\u6548`\u7684\u60c5\u51b5\u4e0b\u624d\u5141\u8bb8\u64cd\u4f5c\u3002\\n```ts\\nfunction example(value: string | number) {\\n  // \u62a5\u9519 toUpperCase \u4e0d\u5c5e\u4e8e number \u7c7b\u578b\u4e0a\u7684\u65b9\u6cd5\\n  console.log(value.toUpperCase());\\n}\\n```\\n\u53ef\u4ee5\u4f7f\u7528\u7c7b\u578b\u4fdd\u62a4\u6765\u8fdb\u4e00\u6b65\u786e\u5b9a\u7c7b\u578b\u3002\\n```ts\\nfunction example(value: string | number) {\\n  if (typeof value === \\"string\\") {\\n    // \u8fd9\u91cc TypeScript \u77e5\u9053 value \u662f string \u7c7b\u578b\\n    console.log(value.toUpperCase());\\n  } else {\\n    // \u8fd9\u91cc TypeScript \u77e5\u9053 value \u662f number \u7c7b\u578b\\n    console.log(value * 2);\\n  }\\n}\\n```\\n\u5f53\u5904\u7406\u5bf9\u8c61\u7684\u5c5e\u6027\u65f6\uff0c`in` \u8fd0\u7b97\u7b26\u53ef\u4ee5\u7528\u6765\u68c0\u67e5\u5bf9\u8c61\u662f\u5426\u5177\u6709\u67d0\u4e2a\u5c5e\u6027\uff1a\\n```ts\\ntype Bird = { fly: () => void };\\ntype Fish = { swim: () => void };\\n\\nfunction move(animal: Bird | Fish) {\\n    if (\'fly\' in animal) {\\n        animal.fly();\\n    } else {\\n        animal.swim();\\n    }\\n}\\n```\\n**\u5408\u5e76\u8054\u5408\u7c7b\u578b**  \\n```ts\\ntype UnionA = \'px\' | \'em\' | \'rem\' | \'%\';\\n\\ntype UnionB = \'vh\' | \'em\' | \'rem\' | \'pt\';\\n\\ntype IntersectionUnion = UnionA & UnionB; // \'em\' | \'rem\'\\n```\\n**\u7c7b\u578b\u7f29\u51cf**  \\n```ts\\ntype URStr = \'string\' | string; // \u7c7b\u578b\u662f string\\n\\ntype URNum = 2 | number; // \u7c7b\u578b\u662f number\\n\\ntype URBoolen = true | boolean; // \u7c7b\u578b\u662f boolean\\n\\nenum EnumUR {\\n  ONE,\\n  TWO\\n}\\n\\ntype URE = EnumUR.ONE | EnumUR; // \u7c7b\u578b\u662f EnumUR\\n\\n```\\n### \u4ea4\u53c9\u7c7b\u578b\\n**\u8bed\u6cd5\u5f62\u5f0f\uff1a**\\n```ts\\ntype Useless = string & number;\\n```\\n### \u679a\u4e3e\u7c7b\u578b\\n**\u8bed\u6cd5\u5f62\u5f0f\uff1a**\\n```ts\\nenum Day {\\n  SUNDAY = \'SUNDAY\',\\n  MONDAY = \'MONDAY\',\\n  TUESDAY = \'TUESDAY\',\\n}  \\n```\\n:::tip\\n\u679a\u4e3e\u662f\u4e00\u79cd\u6bd4\u8f83\u7279\u6b8a\u7684\u7c7b\u578b\uff0c\u56e0\u4e3a\u5b83\u517c\u5177`\u503c\u548c\u7c7b\u578b`\u4e8e\u4e00\u4f53\\n:::\\n**\u6570\u5b57\u679a\u4e3e**  \\n```ts\\nenum Day {\\n  SUNDAY = 1,\\n  MONDAY,\\n  TUESDAY,\\n}\\n```\\n\u4f1a\u4ece1\u5f00\u59cb\u6570\u5b57\u9012\u589e\\n\\n\\n### \u51fd\u6570\u7c7b\u578b\\n**\u57fa\u672c\u7684\u51fd\u6570\u7c7b\u578b\u5b9a\u4e49\uff1a**\\n```ts\\nfunction add(x: number, y: number): number {\\n    return x + y;\\n}\\n```\\n**\u51fd\u6570\u8868\u8fbe\u5f0f\u7c7b\u578b\u5b9a\u4e49\uff1a**\\n```ts\\ntype Fn = (x: number, y: number) => number;\\nlet myAdd: Fn = function(x: number, y: number): number { return x + y; };\\n```\\n**this \u5b9a\u4e49\uff1a**\\n```ts\\nfunction say(this: Window, name: string) {\\n    console.log(this.name);\\n}\\n\\nwindow.say = say;\\nwindow.say(\'hi\');\\nconst obj = {\\n    say\\n};\\n\\nobj.say(\'hi\'); // ts(2684) The \'this\' context of type \'{ say: (this: Window, name: string) => void; }\' is not assignable to method\'s \'this\' of type \'Window\'.\\n```\\n**\u51fd\u6570\u91cd\u8f7d**  \\n\u6839\u636e\u4f20\u9012\u7684\u53c2\u6570\u7c7b\u578b\u4e0d\u540c\uff0c\u51fd\u6570\u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u884c\u4e3a\u3002\u53ef\u4ee5\u4e3a\u540c\u4e00\u4e2a\u51fd\u6570\u58f0\u660e\u591a\u4e2a\u7c7b\u578b\u7b7e\u540d\u3002\\n```ts\\nfunction double(value: number): number;\\nfunction double(value: string): string;\\n\\nfunction double(value: any): any {\\n    if (typeof value === \\"number\\") {\\n        return value * 2;\\n    } else if (typeof value === \\"string\\") {\\n        return value.repeat(2);\\n    }\\n}\\n\\nconsole.log(double(5));       // \u8f93\u51fa: 10\\nconsole.log(double(\\"abc\\"));   // \u8f93\u51fa: abcabc\\n```\\n:::tip\\n\\n\u51fd\u6570\u91cd\u8f7d\u5217\u8868\u7684\u5404\u4e2a\u6210\u5458\u5fc5\u987b\u662f\u51fd\u6570\u5b9e\u73b0\u7684\u5b50\u96c6\\n\\n:::\\n**\u51fd\u6570\u7c7b\u578b\u8c13\u8bcd**  \\n\u8bed\u6cd5\u5f62\u5f0f\uff1a\u53c2\u6570\u540d + is + \u7c7b\u578b\\n```ts\\nfunction isString(value: unknown): value is string {\\n  return typeof value === \\"string\\";\\n}\\n```\\n\\n## \u7c7b\u578b\u65ad\u8a00\\n**\u8bed\u6cd5\u5f62\u5f0f\uff1a**\\n1. \u5c16\u62ec\u53f7\u8bed\u6cd5\uff1a\\n```ts\\nlet someValue: any = \\"this is a string\\";\\nlet strLength: number = (<string>someValue).length;\\n```\\n2. `as` \u8bed\u6cd5\uff08\u63a8\u8350\u4f7f\u7528\uff09\uff1a\\n```ts\\nlet someValue: any = \\"this is a string\\";\\nlet strLength: number = (someValue as string).length;\\n```\\n3. `!` \u975e\u7a7a\u65ad\u8a00\uff08\u4e0d\u63a8\u8350\uff0c\u7528\u7c7b\u578b\u5b88\u536b\u4ee3\u66ff\uff09\uff1a\\n```ts\\nlet someValue: string | null | undefined;\\n// \u4f7f\u7528\u975e\u7a7a\u65ad\u8a00\uff0c\u544a\u8bc9\u7f16\u8bd1\u5668 someValue \u4e0d\u662f null \u6216 undefined\\nconsole.log(someValue!.length);\\n```\\n\\n:::tip\\n\u7c7b\u578b\u65ad\u8a00\u7684\u64cd\u4f5c\u5bf9\u8c61\u5fc5\u987b\u6ee1\u8db3\u67d0\u4e9b`\u7ea6\u675f\u5173\u7cfb`\uff0c\u5426\u5219\u6211\u4eec\u5c06\u5f97\u5230\u4e00\u4e2a ts(2352) \u9519\u8bef\uff0c\u5373\u4ece\u7c7b\u578b\u201c\u6e90\u7c7b\u578b\u201d\u5230\u7c7b\u578b\u201c\u76ee\u6807\u7c7b\u578b\u201d\u7684\u8f6c\u6362\u662f\u9519\u8bef\u7684\uff0c\u56e0\u4e3a\u8fd9\u4e24\u79cd\u7c7b\u578b\u4e0d\u80fd\u5145\u5206\u91cd\u53e0\u3002  \\n\u7236\u5b50\u3001\u5b50\u7236\u7c7b\u578b\u4e4b\u95f4\u53ef\u4ee5\u4f7f\u7528\u7c7b\u578b\u65ad\u8a00\u8fdb\u884c\u8f6c\u6362\u3002  \\n`any` \u548c `unknown` \u8fd9\u4e24\u4e2a\u7279\u6b8a\u7c7b\u578b\u5c5e\u4e8e\u4e07\u91d1\u6cb9\uff0c\u56e0\u4e3a\u5b83\u4eec\u65e2\u53ef\u4ee5\u88ab\u65ad\u8a00\u6210\u4efb\u4f55\u7c7b\u578b\uff0c\u53cd\u8fc7\u6765\u4efb\u4f55\u7c7b\u578b\u4e5f\u90fd\u53ef\u4ee5\u88ab\u65ad\u8a00\u6210 `any` \u6216 `unknown`\u3002\u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u60f3\u5f3a\u884c\u201c\u6307\u9e7f\u4e3a\u9a6c\u201d\uff0c\u5c31\u53ef\u4ee5\u5148\u628a\u201c\u9e7f\u201d\u65ad\u8a00\u4e3a `any` \u6216 `unknown`\uff0c\u7136\u540e\u518d\u628a `any` \u548c `unknown` \u65ad\u8a00\u4e3a\u201c\u9a6c\u201d\uff0c\u6bd4\u5982`\u9e7f as any as \u9a6c`\u3002\\n:::\\n\\n## \u7c7b\u578b\u522b\u540d\\n**\u8bed\u6cd5\u5f62\u5f0f\uff1a**\\n```ts\\ntype Age = number;\\ntype Point = {\\n  x: number;\\n  y: number;\\n};\\ntype ID = number | string;\\n```\\n:::tip\\n\u7c7b\u578b\u522b\u540d\u4e0d\u80fd\u91cd\u590d\u5b9a\u4e49\\n:::\\n\\n## \u7c7b\u578b\u5b88\u536b\uff08\u7f29\u5c0f\u7c7b\u578b\uff09\\n\u4f7f\u7528\u7c7b\u578b\u5b88\u536b\u6765\u533a\u5206\u8054\u5408\u7c7b\u578b\u7684\u4e0d\u540c\u6210\u5458\uff0c\u5e38\u7528\u7684\u7c7b\u578b\u5b88\u536b\u5305\u62ec switch\u3001\u5b57\u9762\u91cf\u6052\u7b49\u3001typeof\u3001instanceof\u3001in \u548c\u81ea\u5b9a\u4e49\u7c7b\u578b\u5b88\u536b\u3002\\n**switch**\\n```ts\\n const convert = (c: \'a\' | 1) => {\\n    switch (c) {\\n      case 1:\\n        return c.toFixed(); // c is 1\\n      case \'a\':\\n        return c.toLowerCase(); // c is \'a\'\\n    }\\n  }\\n```\\n**\u5b57\u9762\u91cf\u6052\u7b49**\\n```ts\\n  const convert = (c: \'a\' | 1) => {\\n    if (c === 1) {\\n      return c.toFixed(); // c is 1\\n    } else if (c === \'a\') {\\n        return c.toLowerCase(); // c is \'a\'\\n    }\\n  }\\n```\\n**typeof**\\n```ts\\n  const convert = (c: \'a\' | 1) => {\\n    if (typeof c === \'number\') {\\n      return c.toFixed(); // c is 1\\n    } else if (typeof c === \'string\') {\\n        return c.toLowerCase(); // c is \'a\'\\n    }\\n  }\\n```\\n**instanceof**  \\n```ts\\nclass Dog {\\n  wang = \'wangwang\';\\n}\\nclass Cat {\\n  miao = \'miaomiao\';\\n}\\n\\nconst getName = (animal: Dog | Cat) => {\\n  if (animal instanceof Dog) {\\n    // Dog\\n    return animal.wang;\\n  } else if (animal instanceof Cat) {\\n    // Cat\\n    return animal.miao;\\n  }\\n}\\n```\\n**in**  \\n```ts\\nclass Dog {\\n  wang = \'wangwang\';\\n}\\nclass Cat {\\n  miao = \'miaomiao\';\\n}\\n\\nconst getName = (animal: Dog | Cat) => {\\n  if (\'wang\' in animal) { \\n    // Dog\\n    return animal.wang;\\n  } else if (\'miao\' in animal) { \\n    // Cat\\n    return animal.miao;\\n  }\\n}\\n```\\n**is**\\n```ts\\nconst isDog = function (animal: Dog | Cat): animal is Dog {\\n  return \'wang\' in animal;\\n}\\nconst getName = (animal: Dog | Cat) => {\\n  if (isDog(animal)) {\\n    return animal.wang;\\n  }\\n}\\n```\\n\\n## \u7c7b\u578b\u517c\u5bb9\\n\\n\\n| \u8d4b\u503c\u7c7b\u578b/\u88ab\u8d4b\u503c\u7c7b\u578b | any | unknown | object | void | undefined | null | never |\\n|:----------:|:---:|:-------:|:------:|:----:|:---------:|:----:|:-----:|\\n|    any     |  \u2713  |    \u2713    |   \u2713    |  \u2713   |     \u2713     |  \u2713   |   \u2715   |\\n|  unknown   |  \u2713  |    \u2713    |   \u2715    |  \u2715   |     \u2715     |  \u2715   |   \u2715   |\\n|   object   |  \u2713  |    \u2713    |   \u2713    |  \u2715   |     \u2715     |  \u2715   |   \u2715   |\\n|    void    |  \u2713  |    \u2713    |   \u2715    |  \u2713   |     \u2715     |  \u2715   |   \u2715   |\\n| undefined  |  \u2713  |    \u2713    |   \u2713    |  \u2713   |     \u2713     |  \u2713   |   \u2715   |\\n|    null    |  \u2713  |    \u2713    |   \u2713    |  \u2713   |     \u2713     |  \u2713   |   \u2715   |\\n|   never    |  \u2713  |    \u2713    |   \u2713    |  \u2713   |     \u2713     |  \u2713   |   \u2713   |\\n\\n\\n## \u6cdb\u578b\\n\\n\\n<comment/>"},{"id":"\u52a8\u6001\u89c4\u5212\u603b\u7ed3","metadata":{"permalink":"/apaas-front-doc/blog/\u52a8\u6001\u89c4\u5212\u603b\u7ed3","source":"@site/blog/2024-07-29/index.md","title":"\u52a8\u6001\u89c4\u5212\u603b\u7ed3","description":"\u6982\u8ff0","date":"2024-07-29T00:00:00.000Z","formattedDate":"2024\u5e747\u670829\u65e5","tags":[{"label":"dp","permalink":"/apaas-front-doc/blog/tags/dp"}],"readingTime":6.41,"hasTruncateMarker":true,"authors":[{"name":"\u9ec4\u632f\u654f","title":"\u70df\u82b1\u6613\u51b7","job_no":25748,"url":"https://github.com/hzm0321","imageURL":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.92fa.com%2Fpic%2FTX1251_03.jpg&refer=http%3A%2F%2Fimg.92fa.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1670915005&t=61e1ff50cd599d4affcc74dfa4b7545d","key":"hzm"}],"frontMatter":{"slug":"\u52a8\u6001\u89c4\u5212\u603b\u7ed3","title":"\u52a8\u6001\u89c4\u5212\u603b\u7ed3","authors":["hzm"],"tags":["dp"]},"prevItem":{"title":"TypeScript \u8fdb\u9636","permalink":"/apaas-front-doc/blog/TypeScript \u8fdb\u9636"},"nextItem":{"title":"antv/x6 v1\u5347\u7ea7v2\u8bb0\u5f55","permalink":"/apaas-front-doc/blog/antv/x6 v1\u5347\u7ea7v2\u8bb0\u5f55"}},"content":"## \u6982\u8ff0\\n`\u52a8\u6001\u89c4\u5212`\uff08Dynamic Programming\uff0c\u7b80\u79f0DP\uff09\u662f\u4e00\u79cd\u7b97\u6cd5\u8bbe\u8ba1\u601d\u60f3\uff0c\u7528\u4e8e\u89e3\u51b3\u5177\u6709\u91cd\u53e0\u5b50\u95ee\u9898\u548c\u6700\u4f18\u5b50\u7ed3\u6784\u6027\u8d28\u7684\u95ee\u9898\u3002\u5b83\u901a\u8fc7\u5c06\u590d\u6742\u95ee\u9898\u5206\u89e3\u4e3a\u8f83\u5c0f\u7684\u5b50\u95ee\u9898\uff0c\u907f\u514d\u91cd\u590d\u8ba1\u7b97\u76f8\u540c\u7684\u5b50\u95ee\u9898\uff0c\u4ece\u800c\u63d0\u9ad8\u8ba1\u7b97\u6548\u7387\u3002  \\n\u57fa\u672c\u601d\u60f3\u53ef\u4ee5\u6982\u62ec\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a\\n1. **\u5b9a\u4e49\u5b50\u95ee\u9898**\uff1a\u5c06\u539f\u95ee\u9898\u5206\u89e3\u4e3a\u591a\u4e2a\u5b50\u95ee\u9898\u3002\u901a\u5e38\uff0c\u5b50\u95ee\u9898\u7684\u89e3\u80fd\u591f\u7ec4\u5408\u6210\u539f\u95ee\u9898\u7684\u89e3\u3002\\n2. **\u786e\u8ba4\u72b6\u6001**\uff1a\u5b9a\u4e49\u95ee\u9898\u7684\u72b6\u6001\uff0c\u4e00\u822c\u901a\u8fc7\u4e00\u4e2a\u6216\u591a\u4e2a\u53d8\u91cf\u6765\u63cf\u8ff0\u5f53\u524d\u7684\u5b50\u95ee\u9898\u3002\u4f8b\u5982\uff0c\u5728\u6c42\u89e3\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u7684\u95ee\u9898\u4e2d\uff0c\u72b6\u6001\u53ef\u4ee5\u7528\u4e24\u4e2a\u53d8\u91cf\u6765\u8868\u793a\u5e8f\u5217\u7684\u957f\u5ea6\u3002\\n3. **\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b**\uff1a\u627e\u51fa\u5b50\u95ee\u9898\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u5373\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u3002\u8fd9\u4e9b\u65b9\u7a0b\u63cf\u8ff0\u4e86\u5982\u4f55\u4ece\u4e00\u4e2a\u6216\u591a\u4e2a\u5b50\u95ee\u9898\u7684\u89e3\u5f97\u5230\u539f\u95ee\u9898\u7684\u89e3\u3002\\n4. **\u521d\u59cb\u6761\u4ef6\u548c\u8fb9\u754c\u60c5\u51b5**\uff1a\u786e\u5b9a\u52a8\u6001\u89c4\u5212\u7684\u521d\u59cb\u6761\u4ef6\uff0c\u5373\u6700\u57fa\u672c\u7684\u5b50\u95ee\u9898\u7684\u89e3\uff0c\u4ee5\u53ca\u8fb9\u754c\u60c5\u51b5\u3002\\n5. **\u6c42\u89e3\u548c\u4f18\u5316**\uff1a\u901a\u8fc7\u8fed\u4ee3\u6216\u9012\u5f52\u65b9\u5f0f\u6c42\u89e3\u6240\u6709\u5b50\u95ee\u9898\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u89e3\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n## \u9898\u578b\\n\\n### 1. \u6590\u6ce2\u90a3\u5951\u6570\u5217\\n\u6590\u6ce2\u90a3\u5951\u6570\u5217\u9898\u578b\u662f dp \u4e2d\u7684\u5178\u578b\u5e94\u7528\u3002\u5b83\u5b58\u5728\u660e\u663e\u7684\u9012\u5f52\u5173\u7cfb\uff0c\u901a\u5e38\u7c7b\u4f3c\u4e8e\u7ecf\u5178\u7684\u6590\u6ce2\u90a3\u5951\u6570\u5217 F(n) = F(n-1) + F(n-2)\\n\\n**LeetCode \u95ee\u9898:**\\n\\n[70. \u722c\u697c\u68af](https://leetcode.cn/problems/climbing-stairs/)  \\n\u5047\u8bbe\u4f60\u6b63\u5728\u722c\u697c\u68af\u3002\u9700\u8981 n \u9636\u4f60\u624d\u80fd\u5230\u8fbe\u697c\u9876\u3002  \\n\u6bcf\u6b21\u4f60\u53ef\u4ee5\u722c 1 \u6216 2 \u4e2a\u53f0\u9636\u3002\u4f60\u6709\u591a\u5c11\u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u53ef\u4ee5\u722c\u5230\u697c\u9876\u5462\uff1f\\n\\n```js\\n/**\\n * @param {number} n\\n * @return {number}\\n */\\nvar climbStairs = function(n) {\\n\\n};\\n\\n// \u8f93\u5165\uff1an = 2 \u8f93\u51fa\uff1a2\\n// \u8f93\u5165\uff1an = 3 \u8f93\u51fa\uff1a3\\n```\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n<div>\\n\\n```js\\nvar climbStairs = function(n) {\\n  if (n < 2) {\\n    return 1;\\n  } else {\\n    const dp = [1, 2];\\n    for (let i = 2; i < n; i++) {\\n      dp[i] = dp[i - 1] + dp[i - 2];\\n    }\\n    return dp.pop();\\n  }\\n};\\n```\\n* **\u72b6\u6001\u5b9a\u4e49**\uff1adp[n] \u8868\u793a\u7b2c n \u5c42\u697c\u68af\\n* **\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b**\uff1adp[n] = dp[n-1] + dp[n-2]\\n* **\u8fb9\u754c\u6761\u4ef6**\uff1adp[0] = 1, dp[1] = 1\\n\\n</div>\\n</details>\\n\\n[509. \u6590\u6ce2\u90a3\u5951\u6570](https://leetcode.cn/problems/fibonacci-number/)  \\n\u6590\u6ce2\u90a3\u5951\u6570 \uff08\u901a\u5e38\u7528 F(n) \u8868\u793a\uff09\u5f62\u6210\u7684\u5e8f\u5217\u79f0\u4e3a \u6590\u6ce2\u90a3\u5951\u6570\u5217 \u3002\u8be5\u6570\u5217\u7531 0 \u548c 1 \u5f00\u59cb\uff0c\u540e\u9762\u7684\u6bcf\u4e00\u9879\u6570\u5b57\u90fd\u662f\u524d\u9762\u4e24\u9879\u6570\u5b57\u7684\u548c\u3002\u4e5f\u5c31\u662f\uff1a  \\nF(0) = 0\uff0cF(1) = 1  \\nF(n) = F(n - 1) + F(n - 2)\uff0c\u5176\u4e2d n > 1  \\n\u7ed9\u5b9a n \uff0c\u8bf7\u8ba1\u7b97 F(n) \u3002\\n\\n```js\\n/**\\n * @param {number} n\\n * @return {number}\\n */\\nvar fib = function(n) {\\n\\n};\\n\\n// \u8f93\u5165\uff1an = 2 \u8f93\u51fa\uff1a1\\n// \u8f93\u5165\uff1an = 3 \u8f93\u51fa\uff1a2\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n<div>\\n\\n```js\\nvar fib = function(n) {\\n  const dp = [0, 1];\\n  if (n <= 1) {\\n    return dp[n]\\n  }\\n  for (let i = 2; i <= n; i++) {\\n    dp[i] = dp[i - 1] + dp[i - 2];\\n  }\\n\\n  return dp[n]\\n\\n};\\n```\\n* **\u72b6\u6001\u5b9a\u4e49**\uff1adp[n] \u8868\u793a\u7b2c n \u4e2a\u6590\u6ce2\u90a3\u5951\u6570\u5217\\n* **\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b**\uff1adp[n] = dp[n-1] + dp[n-2]\\n* **\u8fb9\u754c\u6761\u4ef6**\uff1adp[0] = 0, dp[1] = 1\\n\\n</div>\\n</details>\\n\\n[746. \u4f7f\u7528\u6700\u5c0f\u82b1\u8d39\u722c\u697c\u68af](https://leetcode.cn/problems/min-cost-climbing-stairs/)  \\n\u7ed9\u4f60\u4e00\u4e2a\u6574\u6570\u6570\u7ec4 `cost` \uff0c\u5176\u4e2d `cost[i]` \u662f\u4ece\u697c\u68af\u7b2c `i` \u4e2a\u53f0\u9636\u5411\u4e0a\u722c\u9700\u8981\u652f\u4ed8\u7684\u8d39\u7528\u3002\u4e00\u65e6\u4f60\u652f\u4ed8\u6b64\u8d39\u7528\uff0c\u5373\u53ef\u9009\u62e9\u5411\u4e0a\u722c\u4e00\u4e2a\u6216\u8005\u4e24\u4e2a\u53f0\u9636\u3002  \\n\u4f60\u53ef\u4ee5\u9009\u62e9\u4ece\u4e0b\u6807\u4e3a `0` \u6216\u4e0b\u6807\u4e3a `1` \u7684\u53f0\u9636\u5f00\u59cb\u722c\u697c\u68af\u3002  \\n\u8bf7\u4f60\u8ba1\u7b97\u5e76\u8fd4\u56de\u8fbe\u5230\u697c\u68af\u9876\u90e8\u7684\u6700\u4f4e\u82b1\u8d39\u3002\\n\\n```js\\n/**\\n * @param {number[]} cost\\n * @return {number}\\n */\\nvar minCostClimbingStairs = function(cost) {\\n\\n};\\n// \u8f93\u5165\uff1acost = [10,15,20] \u8f93\u51fa\uff1a15\\n// \u8f93\u5165\uff1acost = [1,100,1,1,1,100,1,1,100,1] \u8f93\u51fa\uff1a6\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n<div>\\n\\n```js\\nvar minCostClimbingStairs = function(cost) {\\n  const dp = [0, 0];\\n\\n  for (let i = 2; i <= cost.length; i++) {\\n    dp[i] = Math.min(dp[i - 1] + cost[i - 1], dp[i - 2] + cost[i - 2]);\\n  }\\n\\n  return dp.pop()\\n};\\n```\\n* **\u72b6\u6001\u5b9a\u4e49**\uff1adp[n] \u8868\u793a\u8d70\u5230\u7b2c n \u7ea7\u53f0\u9636\u6240\u9700\u82b1\u8d39\\n* **\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b**\uff1adp[n] = \u9009\u62e9\u4e0a\u4e00\u7ea7\u6240\u9700\u82b1\u8d39(dp[i - 1] + cost[i - 1])\u548c\u9009\u62e9\u4e0a\u4e0a\u4e00\u7ea7\u6240\u9700\u82b1\u8d39(dp[i - 2] + cost[i - 2])\u7684\u6700\u5c0f\u503c\\n* **\u8fb9\u754c\u6761\u4ef6**\uff1adp[0] = 0, dp[1] = 0\\n\\n</div>\\n</details>\\n\\n### 2. Kadane \u7b97\u6cd5\u6c42\u89e3\u6700\u5927\u5b50\u6570\u7ec4\u95ee\u9898\\nKadane \u7b97\u6cd5\u662f\u4e00\u79cd\u7528\u4e8e\u89e3\u51b3`\u6700\u5927\u5b50\u6570\u7ec4\u548c\u95ee\u9898`\u7684\u9ad8\u6548\u7b97\u6cd5\u3002\u8be5\u95ee\u9898\u8981\u6c42\u5728\u4e00\u4e2a\u6574\u6570\u6570\u7ec4\u4e2d\u627e\u5230\u548c\u6700\u5927\u7684\u8fde\u7eed\u5b50\u6570\u7ec4\u3002Kadane \u7b97\u6cd5\u901a\u8fc7\u7ebf\u6027\u65f6\u95f4\u590d\u6742\u5ea6\\n\ud835\udc42(\ud835\udc5b) \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u662f\u4e00\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u52a8\u6001\u89c4\u5212\u5e94\u7528\u4f8b\u5b50\u3002\\n\\n[53. \u6700\u5927\u5b50\u6570\u7ec4\u548c](https://leetcode.cn/problems/maximum-subarray/)  \\n\u7ed9\u4f60\u4e00\u4e2a\u6574\u6570\u6570\u7ec4 nums \uff0c\u8bf7\u4f60\u627e\u51fa\u4e00\u4e2a\u5177\u6709\u6700\u5927\u548c\u7684\u8fde\u7eed\u5b50\u6570\u7ec4\uff08\u5b50\u6570\u7ec4\u6700\u5c11\u5305\u542b\u4e00\u4e2a\u5143\u7d20\uff09\uff0c\u8fd4\u56de\u5176\u6700\u5927\u548c\u3002  \\n\\n```js\\n/**\\n * @param {number[]} nums\\n * @return {number}\\n */\\nvar maxSubArray = function(nums) {\\n\\n};\\n// \u8f93\u5165\uff1anums = [-2,1,-3,4,-1,2,1,-5,4] \u8f93\u51fa\uff1a6\\n// \u8f93\u5165\uff1anums = [1] \u8f93\u51fa\uff1a1\\n// \u8f93\u5165\uff1anums = [5,4,-1,7,8] \u8f93\u51fa\uff1a23\\n```\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n<div>\\n\\n```js\\nvar maxSubArray = function(nums) {\\n  let globalSum = -Infinity;\\n  let curSum = -Infinity;\\n  for (let i = 0; i < nums.length; i++) {\\n    const value = nums[i];\\n    curSum = Math.max(value, curSum + value);\\n    globalSum = Math.max(globalSum, curSum);\\n  }\\n\\n  return globalSum;\\n};\\n```\\n\\n</div>\\n</details>\\n\\n<comment/>"},{"id":"antv/x6 v1\u5347\u7ea7v2\u8bb0\u5f55","metadata":{"permalink":"/apaas-front-doc/blog/antv/x6 v1\u5347\u7ea7v2\u8bb0\u5f55","source":"@site/blog/2024-07-01/index.md","title":"antv/x6 v1\u5347\u7ea7v2\u8bb0\u5f55","description":"\u6982\u8ff0","date":"2024-07-01T00:00:00.000Z","formattedDate":"2024\u5e747\u67081\u65e5","tags":[{"label":"x6","permalink":"/apaas-front-doc/blog/tags/x-6"}],"readingTime":3.135,"hasTruncateMarker":true,"authors":[{"name":"\u9ec4\u632f\u654f","title":"\u70df\u82b1\u6613\u51b7","job_no":25748,"url":"https://github.com/hzm0321","imageURL":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.92fa.com%2Fpic%2FTX1251_03.jpg&refer=http%3A%2F%2Fimg.92fa.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1670915005&t=61e1ff50cd599d4affcc74dfa4b7545d","key":"hzm"}],"frontMatter":{"slug":"antv/x6 v1\u5347\u7ea7v2\u8bb0\u5f55","title":"antv/x6 v1\u5347\u7ea7v2\u8bb0\u5f55","authors":["hzm"],"tags":["x6"]},"prevItem":{"title":"\u52a8\u6001\u89c4\u5212\u603b\u7ed3","permalink":"/apaas-front-doc/blog/\u52a8\u6001\u89c4\u5212\u603b\u7ed3"},"nextItem":{"title":"\u6808\u7b97\u6cd5\u603b\u7ed3","permalink":"/apaas-front-doc/blog/\u6808\u7b97\u6cd5\u603b\u7ed3"}},"content":"### \u6982\u8ff0\\n\u6bd4\u8d77 antv/x6 \u7684 v1\u7248\u672c\uff0c[antv/x6 v2](https://x6.antv.antgroup.com/) \u63d0\u5347\u4e86\u6e32\u67d3\u6027\u80fd(\u5f02\u6b65)\uff0c\u89e3\u51b3\u4e86 v1 \u65f6\u671f\u5b58\u5728\u7684 react \u8282\u70b9\u6302\u8f7d\u95ee\u9898\u3002\\n\\n### \u4f9d\u8d56\u8c03\u6574\\n\\n\u4e1a\u52a1\u6a21\u5757\u7684\u5305\uff08hmde/hlod\uff09\u4e0d\u518d\u5355\u72ec\u5b89\u88c5 antd/x6 \u4f9d\u8d56\uff0c\u5168\u90e8\u62bd\u79bb\u5230\u516c\u5171\u6a21\u5757\uff08apaas\uff09\u3002\u7edf\u4e00\u8ba9\u516c\u5171\u6a21\u5757\u8fdb\u884c x6 \u6253\u5305\uff0c\u4e1a\u52a1\u6a21\u5757\u91c7\u7528\u8054\u90a6\u7684\u65b9\u5f0f\u8fdb\u884c\u5f15\u5165\u3002  \\n\u65b0\u7684\u5f15\u5165\u65b9\u5f0f\u5982\u4e0b\uff1a\\n\\n```ts\\nimport { Graph } from \'@apaas/components/AntvX6\';\\nimport { Dnd } from \'@apaas/components/AntvX6/plugins\';\\n```\\n\u5982\u9700\u8865\u5145\u5bfc\u51fa\uff0c\u5230\u516c\u5171\u6a21\u5757\u5bf9\u5e94\u7684\u7ec4\u4ef6\u4e0b\u5bfc\u51fa\uff0c\u7136\u540e\u5728\u5b50\u6a21\u5757\u5bfc\u5165\u4f7f\u7528\\n\\n\x3c!--truncate--\x3e\\n\\n### \u521d\u59cb\u5316 Graph \u914d\u7f6e\u8c03\u6574\\n\u7c7b\u4f3c\u4e8e\u6eda\u52a8\u3001\u5feb\u6377\u952e\u3001\u5c0f\u5730\u56fe\u7b49\u914d\u7f6e\u4e0d\u5728 x6 \u5305\u4e2d\u63d0\u4f9b\uff0c\u9700\u8981\u5b89\u88c5\u989d\u5916\u7684\u63d2\u4ef6\u5305\uff0c\u4ee5 use \u7684\u65b9\u5f0f\u5f15\u5165\u3002  \\n\u5177\u4f53\u4f8b\u5b50\u89c1\u5b98\u65b9\u6587\u6863\uff1ahttps://x6.antv.antgroup.com/tutorial/plugins/scroller\\n\\n### \u63d2\u4ef6\u65b9\u6cd5\u8c03\u6574\\n\u548c\u63d2\u4ef6\u76f8\u5173\u7684\u90e8\u5206\u65b9\u6cd5\u9700\u8981\u5148\u83b7\u53d6\u63d2\u4ef6\u5b9e\u4f8b\uff0c\u624d\u80fd\u8c03\u7528\u3002  \\ngraph \u4e0a\u4e0d\u518d\u6302 scroller\u3001history \u7b49\u63d2\u4ef6\u5c5e\u6027\uff0c\u4f8b\uff1a  \\n```ts\\n// \u5347\u7ea7\u524d\\ngraph.history.canUndo()\\n// \u5347\u7ea7\u540e\\ngraph.canUndo()\\n```\\n\u5f53\u914d\u7f6e\u4e86\u63d2\u4ef6\uff0cgraph \u5b9e\u4f8b\u4f1a\u6ce8\u518c\u90e8\u5206\u5bf9\u5e94\u7684\u63d2\u4ef6\u65b9\u6cd5\uff0c\u4f46\u60f3\u5b8c\u6574\u4f7f\u7528\u63d2\u4ef6\u4e2d\u7684\u65b9\u6cd5\uff0c\u9700\u8981\u83b7\u53d6\u63d2\u4ef6\u5b9e\u4f8b\u3002  \\n\u4f8b\u5982\u914d\u7f6e\u4e86\u6eda\u52a8\u63d2\u4ef6\uff0c\u60f3\u5b8c\u6574\u4f7f\u7528\u6eda\u52a8\u63d2\u4ef6\u5b9e\u4f8b\u4e2d\u7684\u65b9\u6cd5\u3002\\n```ts\\nimport { Scroller } from \\"@apaas/components/AntvX6/plugins\\";\\nconst scroller = graph?.getPlugin<Scroller>(\'scroller\');\\n```\\ngetPlugin \u9700\u8981\u63a5\u6536\u4e00\u4e2a `name` \u53c2\u6570\uff0c\u8fd9\u4e2a name \u6765\u7740\u521d\u59cb\u5316 use \u7684\u65f6\u5019\uff0c\u7ed9 graph \u7ed1\u5b9a\u7684\u63d2\u4ef6\u3002\\n\u6bcf\u4e2a\u63d2\u4ef6\u90fd\u6709\u4e00\u4e2a name \u5c5e\u6027\uff0c\u521d\u59cb\u5316\u63d2\u4ef6\u5b9e\u4f8b\u7684\u65f6\u5019\u53ef\u4ee5\u624b\u52a8\u4f20\u5165\uff0c`\u9ed8\u8ba4\u4e3a\u63d2\u4ef6\u540d\u79f0\u5168\u5c0f\u5199`\u3002\\n\\n### \u5f02\u6b65\u6e32\u67d3\\n\u4e3a\u4e86\u63d0\u5347\u6e32\u67d3\u6027\u80fd\uff0cv2 \u7248\u672c\u9ed8\u8ba4\u5f00\u542f\u5f02\u6b65\u6e32\u67d3\uff0c\u56e0\u6b64\u5bf9\u8282\u70b9\u53d8\u5316\u7b49\u5224\u65ad\uff0c\u9700\u8981\u7b49\u5f85\u8282\u70b9\u6e32\u67d3\u5b8c\u6210\u540e\u518d\u6dfb\u52a0\u6216\u8005\u6dfb\u52a0\u53ef\u9009\u94fe\u5199\u6cd5\u3002\\n```ts\\ngraph?.on(\'render:done\', () => {\\n  // \u8282\u70b9\u6e32\u67d3\u5b8c\u6210\uff0c\u903b\u8f91\u5904\u7406\\n});\\n```\\n\\n### React \u7ec4\u4ef6\u8c03\u6574\\n\u6536\u7f29\u4e86 React \u7ec4\u4ef6\u7684\u6ce8\u518c\u65b9\u5f0f\uff0c\u8be6\u60c5\u89c1\u6587\u6863 https://x6.antv.antgroup.com/tutorial/intermediate/react\\n\\n\u6ce8\uff1areact 16 \u7248\u672c \u5b89\u88c5\u7684 x6-react-shape \u7248\u672c\u9700\u63a7\u5236\u5728 `2.0.8`\\n\\n### x6 Chrome \u63d2\u4ef6\\n\u63d2\u4ef6\u5b89\u88c5\u89c1\u6587\u6863 https://x6.antv.antgroup.com/tutorial/devtool\\n\u5df2\u5b89\u88c5\u4e86\u63d2\u4ef6\uff0c\u53ef\u4ee5\u5728\u9879\u76ee\u4e0a\u8c03\u7528 useX6DevTools \u6ce8\u5165 graph \u6570\u636e\u8fdb\u63d2\u4ef6\\n\\n```tsx\\nimport { Graph } from \'@antv/x6\';\\nimport { useEffect } from \'react\';\\n\\nconst useX6DevTools = (graph?: Graph | null) => {\\n  useEffect(() => {\\n    if (graph && process.env.NODE_ENV === \'development\') {\\n      if (!(window as any).__x6_instances__) {\\n        (window as any).__x6_instances__ = [];\\n      }\\n      (window as any).__x6_instances__.push(graph);\\n    }\\n    return () => {\\n      if ((window as any).__x6_instances__ && graph) {\\n        (window as any).__x6_instances__ = (window as any).__x6_instances__.filter(\\n          (x) => x !== graph\\n        );\\n      }\\n    };\\n  }, [graph]);\\n};\\n\\nexport default useX6DevTools;\\n```\\n\\n<comment/>"},{"id":"\u6808\u7b97\u6cd5\u603b\u7ed3","metadata":{"permalink":"/apaas-front-doc/blog/\u6808\u7b97\u6cd5\u603b\u7ed3","source":"@site/blog/2024-06-13/index.md","title":"\u6808\u7b97\u6cd5\u603b\u7ed3","description":"\u57fa\u672c\u6808\u7ed3\u6784","date":"2024-06-13T00:00:00.000Z","formattedDate":"2024\u5e746\u670813\u65e5","tags":[{"label":"\u6808","permalink":"/apaas-front-doc/blog/tags/\u6808"},{"label":"\u5355\u8c03\u6808","permalink":"/apaas-front-doc/blog/tags/\u5355\u8c03\u6808"}],"readingTime":1.085,"hasTruncateMarker":true,"authors":[{"name":"\u9ec4\u632f\u654f","title":"\u70df\u82b1\u6613\u51b7","job_no":25748,"url":"https://github.com/hzm0321","imageURL":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.92fa.com%2Fpic%2FTX1251_03.jpg&refer=http%3A%2F%2Fimg.92fa.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1670915005&t=61e1ff50cd599d4affcc74dfa4b7545d","key":"hzm"}],"frontMatter":{"slug":"\u6808\u7b97\u6cd5\u603b\u7ed3","title":"\u6808\u7b97\u6cd5\u603b\u7ed3","authors":["hzm"],"tags":["\u6808","\u5355\u8c03\u6808"]},"prevItem":{"title":"antv/x6 v1\u5347\u7ea7v2\u8bb0\u5f55","permalink":"/apaas-front-doc/blog/antv/x6 v1\u5347\u7ea7v2\u8bb0\u5f55"},"nextItem":{"title":"\u5806\u7b97\u6cd5\u603b\u7ed3","permalink":"/apaas-front-doc/blog/\u5806\u7b97\u6cd5\u603b\u7ed3"}},"content":"### \u57fa\u672c\u6808\u7ed3\u6784\\n\u6808\u9075\u5faa`\u5148\u5165\u540e\u51fa`\u903b\u8f91\u7684\u7ebf\u6027\u6570\u636e\u7ed3\u6784\u3002\\n<div align=\\"center\\">\\n    <img src={require(\'./assets/stack.jpg\').default} alt=\\"node\\" width=\\"100%\\" />\\n</div>\\n\\n#### \u64cd\u4f5c\\n* **push(val)**: \u5165\u6808\\n* **pop()**: \u51fa\u6808\\n* **peek()**: \u8bbf\u95ee\u6808\u9876\\n\\n\x3c!--truncate--\x3e\\n\\n#### \u89e3\u51b3\u7684\u95ee\u9898\\n* \u6709\u6548\u62ec\u53f7\u5224\u65ad: \u5982 [Leetcode 20. \u6709\u6548\u62ec\u53f7](https://leetcode.cn/problems/valid-parentheses/description/)\\n\\n### \u5355\u8c03\u6808\\n\u5355\u8c03\u6808\u7684\u6838\u5fc3\u601d\u60f3\u662f\u901a\u8fc7\u7ef4\u62a4\u4e00\u4e2a`\u5355\u8c03\u9012\u589e`\u6216`\u5355\u8c03\u9012\u51cf`\u7684\u6808\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u5143\u7d20\u7684\u5165\u6808\u548c\u51fa\u6808\u64cd\u4f5c\u90fd\u4fdd\u6301\u6808\u7684\u5355\u8c03\u6027\uff0c\u4ece\u800c\u5728\u904d\u5386\u6570\u7ec4\u65f6\u80fd\u591f\u5feb\u901f\u627e\u5230\u6240\u9700\u7684\u5143\u7d20\u4f4d\u7f6e\u3002  \\n\u8fd9\u6837\u53ef\u4ee5\u5c06\u4e00\u4e9b\u9700\u8981\u4e8c\u91cd\u5faa\u73af\u624d\u80fd\u89e3\u51b3\u7684\u95ee\u9898\u4f18\u5316\u5230\u7ebf\u6027\u65f6\u95f4\u590d\u6742\u5ea6\u3002\\n\\n#### \u89e3\u51b3\u7684\u95ee\u9898\\n* \u4e0b\u4e00\u4e2a\u66f4\u5927/\u66f4\u5c0f\u5143\u7d20\u95ee\u9898\uff1a\u5982 [Leetcode 1475. \u5546\u54c1\u6298\u6263\u540e\u7684\u6700\u7ec8\u4ef7\u683c](https://leetcode.cn/problems/final-prices-with-a-special-discount-in-a-shop/description/)\\n* \u6808\u7684\u6700\u5c0f\u503c: \u5982 [Leetcode \u9762\u8bd5\u9898 03.02. \u6808\u7684\u6700\u5c0f\u503c](https://leetcode.cn/problems/min-stack-lcci/description/)\\n\\n<comment/>"},{"id":"\u5806\u7b97\u6cd5\u603b\u7ed3","metadata":{"permalink":"/apaas-front-doc/blog/\u5806\u7b97\u6cd5\u603b\u7ed3","source":"@site/blog/2024-06-10/index.md","title":"\u5806\u7b97\u6cd5\u603b\u7ed3","description":"\u9605\u8bfb\u672c\u7bc7\u9700\u8981\u5bf9\u4e8c\u53c9\u6811\u53ca\u5176\u7ed3\u6784\u6709\u57fa\u672c\u7684\u4e86\u89e3\u3002","date":"2024-06-10T00:00:00.000Z","formattedDate":"2024\u5e746\u670810\u65e5","tags":[{"label":"\u5806","permalink":"/apaas-front-doc/blog/tags/\u5806"},{"label":"\u5806\u6392\u5e8f","permalink":"/apaas-front-doc/blog/tags/\u5806\u6392\u5e8f"}],"readingTime":7.775,"hasTruncateMarker":true,"authors":[{"name":"\u9ec4\u632f\u654f","title":"\u70df\u82b1\u6613\u51b7","job_no":25748,"url":"https://github.com/hzm0321","imageURL":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.92fa.com%2Fpic%2FTX1251_03.jpg&refer=http%3A%2F%2Fimg.92fa.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1670915005&t=61e1ff50cd599d4affcc74dfa4b7545d","key":"hzm"}],"frontMatter":{"slug":"\u5806\u7b97\u6cd5\u603b\u7ed3","title":"\u5806\u7b97\u6cd5\u603b\u7ed3","authors":["hzm"],"tags":["\u5806","\u5806\u6392\u5e8f"]},"prevItem":{"title":"\u6808\u7b97\u6cd5\u603b\u7ed3","permalink":"/apaas-front-doc/blog/\u6808\u7b97\u6cd5\u603b\u7ed3"},"nextItem":{"title":"\u57fa\u4e8e antv/x6 \u5b9e\u73b0 ER \u56fe","permalink":"/apaas-front-doc/blog/ER"}},"content":"\u9605\u8bfb\u672c\u7bc7\u9700\u8981\u5bf9\u4e8c\u53c9\u6811\u53ca\u5176\u7ed3\u6784\u6709\u57fa\u672c\u7684\u4e86\u89e3\u3002\\n\\n### \u6982\u5ff5\\n\\n\u5806\u4e00\u5b9a\u662f\u4e00\u9897`\u5b8c\u5168\u4e8c\u53c9\u6811`, \u6309\u6392\u5e8f\u5927\u5c0f\u89c4\u5219\u4e3b\u8981\u5206\u4e3a 2 \u79cd\u7c7b\u578b\u2014\u2014\u2014\u2014`\u6700\u5927\u5806`\u548c`\u6700\u5c0f\u5806`\u3002\\n\\n* **\u6700\u5927\u5806**\uff1a\u6839\u8282\u70b9\u7684\u503c\u5927\u4e8e\u7b49\u4e8e\u5de6\u53f3\u5b50\u8282\u70b9\u7684\u503c\u3002\\n* **\u6700\u5c0f\u5806**\uff1a\u6839\u8282\u70b9\u7684\u503c\u5c0f\u4e8e\u7b49\u4e8e\u5de6\u53f3\u5b50\u8282\u70b9\u7684\u503c\u3002\\n\\n<div align=\\"center\\">\\n    <img src={require(\'./assets/min-max-heap.jpg\').default} alt=\\"node\\" width=\\"100%\\" />\\n</div>\\n\\n\u603b\u7ed3\uff1a\u6700\u5927\u5806\u548c\u6700\u5c0f\u5806\u7684\u6839\u672c\u533a\u522b\u5728\u4e8e\u6839\u8282\u70b9\u7684\u6700\u503c\u60c5\u51b5\u3002\\n\\n### Heap \u7c7b\u8bbe\u8ba1\\n\u5728\u5806\u7b97\u6cd5\u89e3\u9898\u4e2d\uff0c\u4e00\u822c\u90fd\u9700\u8981\u8bbe\u8ba1\u4e00\u4e2a `Heap \u7c7b`\uff0c\u7528\u4e8e\u5b9e\u73b0`\u6700\u5927\u5806`\u548c`\u6700\u5c0f\u5806`\u7684\u901a\u7528\u64cd\u4f5c\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n#### \u6210\u5458\u53d8\u91cf\u8bbe\u8ba1\\n\u5728\u5806\u6392\u5e8f\u4e2d\u4ec5\u9700\u8981\u4e00\u4e2a\u6570\u7ec4\u7ed3\u6784\uff0c\u7528\u4e8e\u8868\u8fbe\u4e8c\u53c9\u6811\u5373\u53ef\u3002\\n* **heapArr** = []\\n\\n#### \u64cd\u4f5c\u65b9\u6cd5\u8bbe\u8ba1\\n\u5728\u5b9e\u9645\u4e66\u5199\u4e2d\u5e94\u5f53\u9075\u5faa\u7531\u57fa\u7840\u5de5\u5177\u65b9\u6cd5\u5230\u5177\u4f53\u903b\u8f91\u65b9\u6cd5\u7684\u987a\u5e8f\u3002\\n\\n**\u5de5\u5177\u65b9\u6cd5\uff1a**\\n\\n<details>\\n<summary>\\n\\n* **getParentIndex(i)**: \u83b7\u53d6\u7236\u8282\u70b9\u7d22\u5f15\\n\\n</summary>\\n<div>\\n\\n```ts\\ngetParentIndex(i) {\\n  return Math.floor((i - 1) / 2);\\n}\\n```\\n\\n</div>\\n</details>\\n\\n<details>\\n<summary>\\n\\n* **getLeftChildIndex(i)**: \u83b7\u53d6\u5de6\u5b50\u8282\u70b9\u7d22\u5f15\\n\\n</summary>\\n<div>\\n\\n```ts\\ngetLeftChildIndex(i) {\\n  return 2 * i + 1;\\n}\\n```\\n\\n</div>\\n</details>\\n\\n<details>\\n  <summary>\\n\\n* **getRightChildIndex(i)**: \u83b7\u53d6\u53f3\u5b50\u8282\u70b9\u7d22\u5f15\\n\\n</summary>\\n<div>\\n\\n```ts\\ngetRightChildIndex(i) {\\n  return 2 * i + 2;\\n}\\n```\\n\\n</div>\\n</details>\\n\\n<details>\\n  <summary>\\n\\n* **size()**: \u5806\u5143\u7d20\u7684\u6570\u91cf\\n\\n</summary>\\n<div>\\n\\n```ts\\nsize() {\\n  return this.heapArr.length;\\n}\\n```\\n\\n</div>\\n</details>\\n\\n<details>\\n  <summary>\\n\\n* **peek()**: \u8bbf\u95ee\u5806\u9876\u5143\u7d20\uff08\u6ce8\u610f\u662f\u8bbf\u95ee\uff0c\u4e0d\u662f\u53d6\u51fa\uff09\\n\\n</summary>\\n<div>\\n\\n```ts\\npeek() {\\n  return this.heapArr[0];\\n}\\n```\\n\\n</div>\\n</details>\\n\\n<details>\\n  <summary>\\n\\n* **swap(i\uff0cj)**: \u4ea4\u6362\u5806\u4e2d\u7684\u4e24\u4e2a\u5143\u7d20\\n\\n</summary>\\n<div>\\n\\n```ts\\nswap(i, j) {\\n  const temp = this.heapArr[i];\\n  this.heapArr[i] = this.heapArr[j];\\n  this.heapArr[j] = temp;\\n}\\n```\\n\\n</div>\\n</details>\\n\\n\u6709\u4e86\u4ee5\u4e0a\u51e0\u4e2a\u5de5\u5177\u65b9\u6cd5\u4e4b\u540e\uff0c\u63a5\u4e0b\u6765\u5f00\u59cb\u8003\u8651\u5efa\u5806\u7684\u6838\u5fc3\u64cd\u4f5c\u3002  \\n\\n\u5806\u5316\u7684\u8fc7\u7a0b\u4e3b\u8981\u5206 2 \u79cd\u60c5\u51b5\u2014\u2014**\u81ea\u4e0a\u800c\u4e0b\u5806\u5316**\u3001**\u81ea\u4e0b\u800c\u4e0a\u5806\u5316**\u3002  \\n\u8fd9\u91cc\u4ee5\u6700\u5927\u5806\u4e3a\u4f8b\uff1a\\n\\n<details>\\n  <summary>\\n\\n* **siftDown**: \u81ea\u4e0a\u800c\u4e0b\u5806\u5316\\n\\n</summary>\\n<div>\\n\\n```ts\\nsiftDown(i) {\\n  while (true) {\\n    // \u5206\u522b\u83b7\u53d6\u5de6\u53f3\u8282\u70b9\u7d22\u5f15\\n    const leftIndex = this.getLeftChildIndex(i);\\n    const rightIndex = this.getRightChildIndex(i);\\n    // \u6700\u5927\u503c\u7684\u7d22\u5f15\\n    let maxIndex = i;\\n    // \u5982\u679c\u6709\u5de6\u8282\u70b9\u4e14\u5de6\u8282\u70b9\u5927\u4e8e\u5f53\u524d\u8282\u70b9\uff0c\u5219\u66f4\u65b0\u6700\u5927\u503c\u7d22\u5f15\\n    if (leftIndex < this.size() && this.heapArr[leftIndex] > this.heapArr[maxIndex]) {\\n      maxIndex = leftIndex;\\n    }\\n    // \u5982\u679c\u6709\u53f3\u8282\u70b9\u4e14\u53f3\u8282\u70b9\u5927\u4e8e\u5f53\u524d\u8282\u70b9\uff0c\u5219\u66f4\u65b0\u6700\u5927\u503c\u7d22\u5f15\\n    if (rightIndex < this.size() && this.heapArr[rightIndex] > this.heapArr[maxIndex]) {\\n      maxIndex = rightIndex;\\n    }\\n    // maxIndex \u6ca1\u53d1\u751f\u4ea4\u6362,\u5219\u7ed3\u675f\\n    if (maxIndex === i) {\\n      break;\\n    }\\n    // \u5982\u679cmaxIndex \u53d1\u751f\u4e86\u4ea4\u6362\uff0c\u5219\u4ea4\u6362\u5f53\u524d\u8282\u70b9\u548c\u6700\u5927\u503c\u8282\u70b9, \u7ee7\u7eed\u5faa\u73af\\n    this.swap(i, maxIndex);\\n    i = maxIndex;\\n  }\\n}\\n```\\n\\n</div>\\n</details>\\n\u81ea\u4e0a\u800c\u4e0b\u5806\u5316\u76ee\u7684\u662f\u4ece\u6839\u8282\u70b9\u5f00\u59cb\uff0c\u4f9d\u6b21\u6bd4\u8f83\u5f53\u524d\u8282\u70b9\u548c\u5de6\u53f3\u5b50\u8282\u70b9\uff0c\u5c06\u8f83\u5927\u7684\u503c\u4e0e\u5f53\u524d\u8282\u70b9\u4ea4\u6362\uff0c\u7136\u540e\u7ee7\u7eed\u6bd4\u8f83\u4ea4\u6362\u540e\u7684\u8282\u70b9\u3002\\n\\n<details>\\n  <summary>\\n\\n* **siftUp**: \u81ea\u4e0b\u800c\u4e0a\u5806\u5316\\n\\n</summary>\\n<div>\\n\\n```ts\\nsiftUp(i) {\\n  while (i > 0) {\\n    const parentIndex = this.getParentIndex(i);\\n    if (this.heapArr[i] <= this.heapArr[parentIndex]) {\\n      break;\\n    }\\n    // \u5982\u679c\u5f53\u524d\u5143\u7d20\u5927\u4e8e\u7236\u8282\u70b9\uff0c\u5219\u4ea4\u6362\\n    this.swap(i, parentIndex);\\n    i = parentIndex;\\n  }\\n}\\n```\\n\\n</div>\\n</details>\\n\u81ea\u4e0b\u800c\u4e0a\u5806\u5316\u76ee\u7684\u662f\u4ece\u53f6\u5b50\u8282\u70b9\u5f00\u59cb\uff0c\u4f9d\u6b21\u6bd4\u8f83\u5f53\u524d\u8282\u70b9\u548c\u7236\u8282\u70b9\uff0c\u5c06\u8f83\u5c0f\u7684\u503c\u4e0e\u5f53\u524d\u8282\u70b9\u4ea4\u6362\uff0c\u7136\u540e\u7ee7\u7eed\u6bd4\u8f83\u4ea4\u6362\u540e\u7684\u8282\u70b9\u3002  \\n\\n<details>\\n  <summary>\\n\\n* **push**: \u5f80\u5806\u4e2d\u8ffd\u52a0\u5143\u7d20\\n\\n</summary>\\n<div>\\n\\n```ts\\npush(val) {\\n  this.heapArr.push(val);\\n  this.siftUp(this.size() - 1);\\n}\\n```\\n\\n</div>\\n</details>\\n\\n\u5728\u5f80\u5806\u4e2d\u8ffd\u52a0\u4e00\u4e2a\u5143\u7d20\u65f6\uff0c\u4f1a\u4ece\u5b8c\u5168\u4e8c\u53c9\u6811\u7684\u672b\u5c3e\u63d2\u5165\uff0c\u7136\u540e\u901a\u8fc7**\u81ea\u4e0b\u800c\u4e0a\u5806\u5316**\u64cd\u4f5c\u5c06\u5176\u79fb\u52a8\u5230\u5408\u9002\u4f4d\u7f6e\u3002\\n<details>\\n  <summary>\\n\\n* **pop**: \u5806\u9876\u5143\u7d20\u51fa\u5806\\n\\n</summary>\\n<div>\\n\\n```ts\\npop() {\\n  if (this.size() === 1) {\\n    return this.heapArr.pop();\\n  }\\n  // \u4ea4\u6362\u5806\u9876\u5143\u7d20\u548c\u6700\u540e\u4e00\u4e2a\u5143\u7d20\\n  const result = this.heapArr[0];\\n  this.heapArr[0] = this.heapArr.pop();\\n  this.siftDown(0);\\n  return result;\\n}\\n```\\n\\n</div>\\n</details>\\n\\n\u5728\u4ece\u5806\u4e2d\u53d6\u51fa\u4e00\u4e2a\u5143\u7d20\u65f6\uff0c\u4e3a\u4e86\u5c3d\u53ef\u80fd\u51cf\u5c11\u4ea4\u6362\u6b21\u6570\uff0c`\u5c06\u5806\u9876\u5143\u7d20\u548c\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u4ea4\u6362`\uff0c\u7136\u540e\u518d\u5bf9\u5806\u9876\u5143\u7d20\u8fdb\u884c**\u81ea\u4e0a\u800c\u4e0b\u5806\u5316**\u64cd\u4f5c\u5c06\u5176\u79fb\u52a8\u5230\u5408\u9002\u4f4d\u7f6e\u3002\\n\\n\u5982\u679c\u5141\u8bb8\u521d\u59cb\u5316\u7684\u65f6\u5019\u4f20\u5165\u4e00\u4e2a\u672a\u8fdb\u884c\u5806\u5316\u7684\u6570\u7ec4, \u90a3\u4e2a\u5728\u7c7b\u7684 construct \u4e2d\u9700\u8981\u4ece\u6700\u540e\u4e00\u4e2a\u7236\u8282\u70b9\u5f00\u59cb, \u4f9d\u6b21\u81ea\u4e0a\u800c\u4e0b\u8fdb\u884c\u5806\u5316\u3002\\n```js\\nconstructor(nums = []) {\\n  if (nums.length) {\\n    this.heapArr = nums;\\n    // \u81ea\u4e0b\u800c\u4e0a\u5806\u5316(\u9664\u53f6\u8282\u70b9\u4ee5\u5916\u7684\u5176\u4ed6\u6240\u6709\u8282\u70b9)\\n    for (let i = this.getParentIndex(nums.length-1); i >= 0; i--) {\\n      this.siftDown(i)\\n    }\\n  }\\n}\\n```\\n\\n\u81f3\u6b64\uff0c\u5806\u7684\u5e38\u7528\u64cd\u4f5c\u5df2\u7ecf\u5168\u90e8\u5b9e\u73b0\u4e86\u3002\\n\u5b8c\u6574\u4ee3\u7801\uff1a\\n```js\\nclass Heap {\\n  heapArr = []\\n\\n  constructor(nums = []) {\\n    if (nums.length) {\\n      this.heapArr = nums;\\n      // \u81ea\u4e0b\u800c\u4e0a\u5806\u5316(\u9664\u53f6\u8282\u70b9\u4ee5\u5916\u7684\u5176\u4ed6\u6240\u6709\u8282\u70b9)\\n      for (let i = this.getParentIndex(nums.length-1); i >= 0; i--) {\\n        this.siftDown(i)\\n      }\\n    }\\n  }\\n\\n  /**\\n   * \u83b7\u53d6\u7236\u8282\u70b9\\n   * @param i\\n   * @return {number}\\n   */\\n  getParentIndex(i) {\\n    return Math.floor((i - 1) / 2);\\n  }\\n\\n  /**\\n   * \u83b7\u53d6\u5de6\u5b50\u8282\u70b9\\n   * @param i\\n   * @return {number}\\n   */\\n  getLeftChildIndex(i) {\\n    return 2 * i + 1;\\n  }\\n\\n  /**\\n   * \u83b7\u53d6\u53f3\u5b50\u8282\u70b9\\n   * @param i\\n   * @return {number}\\n   */\\n  getRightChildIndex(i) {\\n    return 2 * i + 2;\\n  }\\n\\n  /**\\n   * \u5806\u5143\u7d20\u6570\u91cf\\n   * @return {number}\\n   */\\n  size() {\\n    return this.heapArr.length;\\n  }\\n\\n  /**\\n   * \u8bbf\u95ee\u5806\u9876\u5143\u7d20\\n   */\\n  peek() {\\n    return this.heapArr[0];\\n  }\\n\\n  /**\\n   * \u5143\u7d20\u5165\u5806\\n   */\\n  push(val) {\\n    this.heapArr.push(val);\\n    this.siftUp(this.size() - 1);\\n  }\\n\\n  /**\\n   * \u4ece\u4f4e\u5230\u9876\u5806\u5316\\n   */\\n  siftUp(i) {\\n    while (i > 0) {\\n      const parentIndex = this.getParentIndex(i);\\n      if (this.heapArr[i] <= this.heapArr[parentIndex]) {\\n        break;\\n      }\\n      this.swap(i, parentIndex);\\n      i = parentIndex;\\n    }\\n  }\\n\\n  /**\\n   * \u4ece\u9876\u5230\u4f4e\u5806\u5316\\n   * @param i\\n   */\\n  siftDown(i) {\\n    while (true) {\\n      const leftIndex = this.getLeftChildIndex(i);\\n      const rightIndex = this.getRightChildIndex(i);\\n      let maxIndex = i;\\n      if (leftIndex < this.size() && this.heapArr[leftIndex] > this.heapArr[maxIndex]) {\\n        maxIndex = leftIndex;\\n      }\\n      if (rightIndex < this.size() && this.heapArr[rightIndex] > this.heapArr[maxIndex]) {\\n        maxIndex = rightIndex;\\n      }\\n      // maxIndex \u6ca1\u53d1\u751f\u4ea4\u6362,\u5219\u7ed3\u675f\\n      if (maxIndex === i) {\\n        break;\\n      }\\n      this.swap(i, maxIndex);\\n      i = maxIndex;\\n    }\\n  }\\n\\n  /**\\n   * \u4ea4\u6362\u5806\u4e2d\u4e24\u4e2a\u5143\u7d20\\n   * @param i\\n   * @param j\\n   */\\n  swap(i, j) {\\n    const temp = this.heapArr[i];\\n    this.heapArr[i] = this.heapArr[j];\\n    this.heapArr[j] = temp;\\n  }\\n\\n  /**\\n   * \u5806\u9876\u5143\u7d20\u51fa\u5806\\n   * @return {*}\\n   */\\n  pop() {\\n    if (this.size() === 1) {\\n      return this.heapArr.pop();\\n    }\\n    // \u4ea4\u6362\u5806\u9876\u5143\u7d20\u548c\u6700\u540e\u4e00\u4e2a\u5143\u7d20\\n    const result = this.heapArr[0];\\n    this.heapArr[0] = this.heapArr.pop();\\n    this.siftDown(0);\\n    return result;\\n  }\\n}\\n```\\n\\n### \u89e3\u51b3\u7684\u95ee\u9898\\n#### Top-k \u95ee\u9898\\nTop-k \u95ee\u9898\u6d89\u53ca\u4ece\u4e00\u7ec4\u6570\u636e\u4e2d\u627e\u5230\u6700\u5927\u7684 k \u4e2a\u5143\u7d20\uff08\u6216\u6700\u5c0f\u7684 k \u4e2a\u5143\u7d20\uff09\u3002  \\n\\n**\u6838\u5fc3\u601d\u8def:** \u5982\u679c\u8981\u6c42\u7531\u5927\u5230\u5c0f\u7b2c K \u4e2a, \u5219\u5efa\u7acb\u4e00\u4e2a`\u5bb9\u91cf\u4e3a K \u7684\u5c0f\u9876\u5806`, \u4ece\u5934\u5f00\u59cb\u904d\u5386, \u4e0d\u65ad\u4ee5\u5927\u7684\u503c\u66ff\u6362\u6389\u5806\u9876\u5143\u7d20, \u904d\u5386\u5b8c\u6210\u5806\u9876\u5c31\u662f\u76ee\u6807\u503c\u3002\u53cd\u5219\u53cd\u4e4b\u3002\\n\\n\u5982\uff1a[Leetcode 347. \u524d K \u4e2a\u9ad8\u9891\u5143\u7d20](https://leetcode.cn/problems/top-k-frequent-elements/description/)\\n\\n<comment/>"},{"id":"ER","metadata":{"permalink":"/apaas-front-doc/blog/ER","source":"@site/blog/2023-05-06-er/index.md","title":"\u57fa\u4e8e antv/x6 \u5b9e\u73b0 ER \u56fe","description":"X6 \u662f AntV \u65d7\u4e0b\u7684\u56fe\u7f16\u8f91\u5f15\u64ce\uff0c\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u5f00\u7bb1\u5373\u7528\u7684\u4ea4\u4e92\u7ec4\u4ef6\u548c\u7b80\u5355\u6613\u7528\u7684\u8282\u70b9\u5b9a\u5236\u80fd\u529b\uff0c\u65b9\u4fbf\u6211\u4eec\u5feb\u901f\u642d\u5efa\u6d41\u7a0b\u56fe\u3001DAG \u56fe\u3001ER \u56fe\u7b49\u56fe\u5e94\u7528\u3002","date":"2023-05-06T00:00:00.000Z","formattedDate":"2023\u5e745\u67086\u65e5","tags":[{"label":"antv/x6","permalink":"/apaas-front-doc/blog/tags/antv-x-6"},{"label":"er","permalink":"/apaas-front-doc/blog/tags/er"}],"readingTime":22.37,"hasTruncateMarker":true,"authors":[{"name":"\u9ec4\u632f\u654f","title":"\u70df\u82b1\u6613\u51b7","job_no":25748,"url":"https://github.com/hzm0321","imageURL":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.92fa.com%2Fpic%2FTX1251_03.jpg&refer=http%3A%2F%2Fimg.92fa.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1670915005&t=61e1ff50cd599d4affcc74dfa4b7545d","key":"hzm"}],"frontMatter":{"slug":"ER","title":"\u57fa\u4e8e antv/x6 \u5b9e\u73b0 ER \u56fe","authors":["hzm"],"tags":["antv/x6","er"]},"prevItem":{"title":"\u5806\u7b97\u6cd5\u603b\u7ed3","permalink":"/apaas-front-doc/blog/\u5806\u7b97\u6cd5\u603b\u7ed3"},"nextItem":{"title":"TypeScript \u64cd\u4f5c\u7b26","permalink":"/apaas-front-doc/blog/TypeScript Operator"}},"content":"import Tabs from \'@theme/Tabs\';\\nimport TabItem from \'@theme/TabItem\';\\n\\n> X6 \u662f AntV \u65d7\u4e0b\u7684\u56fe\u7f16\u8f91\u5f15\u64ce\uff0c\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u5f00\u7bb1\u5373\u7528\u7684\u4ea4\u4e92\u7ec4\u4ef6\u548c\u7b80\u5355\u6613\u7528\u7684\u8282\u70b9\u5b9a\u5236\u80fd\u529b\uff0c\u65b9\u4fbf\u6211\u4eec\u5feb\u901f\u642d\u5efa\u6d41\u7a0b\u56fe\u3001DAG \u56fe\u3001ER \u56fe\u7b49\u56fe\u5e94\u7528\u3002\\n\\n\u672c\u6587\u9002\u7528\u4e8e\u6709\u4e00\u5b9a [antv/x6](https://x6.antv.vision/zh) \u4f7f\u7528\u57fa\u7840\u7684\u5f00\u53d1\u8005\u3002\\n\\n## \u5b9e\u73b0\u6548\u679c\\n![alt \u5b9e\u73b0\u6548\u679c](./assets/main.png)\\n<p align=\\"center\\">\u5b9e\u73b0\u6548\u679c\u793a\u610f\u56fe</p>\\n\\n\u4e1a\u52a1\u5bf9\u8c61 ER \u56fe\u7528\u6765\u8868\u793a\u4e0d\u540c\u9886\u57df\u4e0b\u4e0d\u540c\u4e1a\u52a1\u5bf9\u8c61\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u5982\u4e0a\u56fe\u6240\u793a:  \\n\\n- \u4e00\u5f20\u5361\u7247\u4ee3\u8868\u4e00\u4e2a\u8282\u70b9\uff08\u4e1a\u52a1\u5bf9\u8c61\uff09\uff0c\u6bcf\u4e2a\u8282\u70b9\u4e0b\u6709\u591a\u4e2a\u5b57\u6bb5\u3002\\n- \u8282\u70b9\u95f4\u5173\u7cfb\uff0c\u4f7f\u7528\u5e26\u6709\u5411\u7bad\u5934\u7684\u8fb9\u8868\u793a\u3002\u4e0d\u540c\u5173\u7cfb\u4f1a\u6709\u4e0d\u540c\u7684\u8fb9\u989c\u8272\u5bf9\u5e94\u5c55\u793a\u3002\\n- \u70b9\u51fb\u9009\u4e2d\u67d0\u4e2a\u8282\u70b9\uff0c\u4e0e\u8be5\u8282\u70b9\u6240\u5173\u8054\u7684\u8fb9\u90fd\u4f1a\u52a0\u7c97\u9ad8\u4eae\u3002\\n- \u5b58\u5728\u64cd\u4f5c\u6309\u94ae\uff0c\u53ef\u52a8\u6001\u5207\u6362\u6bcf\u4e2a\u8282\u70b9\u5185\u5c55\u793a\u7684\u5173\u8054/\u975e\u5173\u8054\u5b57\u6bb5\u3002\\n- \u53ef\u901a\u8fc7\u6309\u94ae\u64cd\u4f5c\u4e1a\u52a1\u5bf9\u8c61\u7684\u589e\u5220\u6539\u67e5\u3002\\n- \u53ef\u62d6\u62fd\u8282\u70b9\uff0c\u4f46\u662f\u4e0d\u80fd\u81ea\u5efa\u8fde\u7ebf\u3002\\n- \u81ea\u52a8\u5e03\u5c40\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n## \u6280\u672f\u6808\\n- react V16\\n- mobx V4\\n- @antv/x6 V1\\n- @antv/x6-react-shape v1\\n\\n## \u521d\u59cb\u5316 Graph\\n\\n```ts\\nconst graph = new Graph({\\n  container: document.getElementById(CONTAINER_ID)!,\\n  width: wrapperRef.current?.clientWidth || 0,\\n  height: wrapperRef.current?.clientHeight || 0,\\n  grid: {\\n    visible: true,\\n    size: 20,\\n    args: {\\n      color: \'#f0f0f0\',\\n      thickness: 3,\\n    },\\n  },\\n  background: { color: \'#f8f8f8\' },\\n  interacting: {\\n    nodeMovable: true, // \u4ec5\u5141\u8bb8\u8282\u70b9\u79fb\u52a8\\n  },\\n  scroller: {\\n    enabled: true,\\n    className: styles[\'graph-scroller\'],\\n    pannable: {\\n      enabled: true,\\n      eventTypes: [\'leftMouseDown\'],\\n    },\\n    autoResize: true,\\n  },\\n  minimap: {\\n    enabled: true, // \u5f00\u542f\u7f29\u7565\u56fe\\n    container: document.getElementById(MINI_MAP_ID)!,\\n    width: 205,\\n    height: 128,\\n    padding: 0,\\n  },\\n  mousewheel: {\\n    enabled: true,\\n    modifiers: [\'ctrl\', \'meta\'],\\n  }, // \u5141\u8bb8\u9f20\u6807\u6eda\u8f6e\u7f29\u653e\u753b\u5e03\\n  connecting: {\\n    router: {\\n      name: ER_ROUTER, // \u57fa\u4e8e er \u8def\u7531\u4fee\u6539\u540e\u7684\u81ea\u5b9a\u4e49\u8def\u7531\\n      args: {\\n        direction: \'H\',\\n      },\\n    },\\n    // \u5c4f\u853d\u4e00\u4e9b\u4e3b\u52a8\u8fde\u7ebf\u64cd\u4f5c\\n    allowEdge: false,\\n    allowPort: false,\\n    allowBlank: false,\\n    allowLoop: false,\\n    allowMulti: false,\\n    allowNode: false,\\n  },\\n});\\n```\\n\\n\u5728\u4ee5\u4e0a\u7684 ER \u56fe\u7684 Graph \u914d\u7f6e\u4ec5\u4f9b\u53c2\u8003\uff0c\u53ef\u6839\u636e\u5b9e\u9645\u9700\u8981\u8c03\u6574\u3002\u5168\u90e8\u7684\u914d\u7f6e\u9879\u53ef\u53c2\u8003\u5b98\u7f51 [Graph](https://x6.antv.vision/zh/docs/api/graph/graph)\u3002\\n\\n## \u6ce8\u518c\u8282\u70b9\\n<div align=\\"center\\">\\n    <img src={require(\'./assets/node.png\').default} alt=\\"node\\" width=\\"50%\\" />\\n</div>\\n\\n\u7531\u4e0a\u56fe\u5b9e\u73b0\u6548\u679c\u53ef\u4ee5\u770b\u51fa\uff0c\u6bcf\u4e2a\u8282\u70b9\u6709\u6837\u5f0f\u4ee5\u53ca\u5305\u542b\u90e8\u5206\u6309\u94ae\u4ea4\u4e92\u6548\u679c\uff0c\u4f7f\u7528 x6 \u9ed8\u8ba4\u7684\u63cf\u8ff0 svg \u6807\u7b7e\u7684 markup\u3001attrs \u7b49\u53c2\u6570\u5b9e\u73b0\u8f83\u4e3a\u590d\u6742\u3002\u56e0\u6b64\u6211\u4eec\u91c7\u7528[\u81ea\u5b9a\u4e49 react \u8282\u70b9](https://x6.antv.vision/zh/docs/tutorial/advanced/react#%E6%B8%B2%E6%9F%93-react-%E8%8A%82%E7%82%B9)\u7684\u5f62\u5f0f\uff0c\u53bb\u521b\u5efa\u8282\u70b9\u3002  \\n**\u6ce8\u518c React \u8282\u70b9\u65b9\u5f0f\u5982\u4e0b\uff1a**  \\n\u4f7f\u7528 `Graph.registerReactComponent(...)` \u65b9\u6cd5\u5c06 React \u7ec4\u4ef6\u6216\u8fd4\u56de React \u7ec4\u4ef6\u7684\u51fd\u6570\u6ce8\u518c\u5230\u7cfb\u7edf\u4e2d\u3002\\n\\n```tsx\\nimport React from \'react\';\\nimport { Graph } from \'@antv/x6\';\\n\\n/**\\n * \u6ce8\u518c ER \u56fe\u8282\u70b9\\n */\\nexport function registerReactERNode() {\\n  Graph.registerReactComponent(REACT_ER_NODE, <ERNode />);\\n  return () => Graph.unregisterReactComponent(REACT_ER_NODE);\\n}\\n```\\n\\n`<ERNode />` \u4e3a ER \u56fe\u4e2d\u6bcf\u4e2a\u8282\u70b9\u7684 react \u7ec4\u4ef6\u3002\\n\\n**\u4f7f\u7528\u65b9\u5f0f\u5982\u4e0b\uff1a**  \\n\\n\u5728\u521d\u59cb\u5316\u753b\u5e03\u7684 useEffect \u4e2d\uff0c\u5728\u8c03\u7528 `new Graph` \u4e4b\u524d\uff0c\u8c03\u7528 `registerReactERNode` \u65b9\u6cd5\u3002`registerReactERNode` \u4f1a\u8fd4\u56de\u4e00\u4e2a\u9500\u6bc1\u7684\u65b9\u6cd5\uff0c\u5728 useEffect \u7684 return \u65b9\u6cd5\u4e2d\u8c03\u7528\u3002\\n\\n```tsx\\nuseEffect(() => {\\n  // \u6ce8\u518c react ER \u56fe\u8282\u70b9\\n  const erReactNodeDispose = registerReactERNode();\\n  // ......\\n  // \u4ec5\u505a\u521d\u59cb\u5316\u5e03\u5c40\\n  const graph = new Graph({......})\\n\\n  return () => {\\n    graph.dispose();\\n    erReactNodeDispose();\\n    // ......\\n  };\\n}, []);\\n```\\n\\n## \u6ce8\u518c\u8def\u7531\\n\\n\u56e0\u4e3a x6 \u81ea\u5e26\u7684 [er \u8def\u7531](https://x6.antv.vision/zh/docs/api/registry/router#er)\u6ca1\u6709\u5b8c\u5168\u6ee1\u8db3\u573a\u666f\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5728\u5b98\u65b9\u63d0\u4f9b\u7684 er \u8def\u7531\u4e0a\u505a\u4e00\u4e0b\u53c2\u6570\u7684\u4fee\u6539\u3002\\n\u4f7f\u7528\u5b98\u65b9\u4e3a\u6ce8\u518c\u81ea\u5b9a\u4e49\u8def\u7531\u63d0\u4f9b\u7684 [registerRouter](https://x6.antv.vision/zh/docs/api/registry/router/#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%B7%AF%E7%94%B1) \u65b9\u6cd5\u3002\u6807\u51c6\u7684\u5b98\u65b9 er \u8def\u7531\u5b9e\u73b0\u9700\u8981\u4ece x6 \u7684 [github \u6e90\u7801](https://github.com/antvis/X6/blob/%40antv/x6%401.34.14/packages/x6/src/registry/router/er.ts)\u4e2d\u590d\u5236\u51fa\u6765\u3002\\n\\n<div align=\\"center\\">\\n    <img src={require(\'./assets/er-router.png\').default} alt=\\"node\\" width=\\"30.88%\\" />\\n    <img src={require(\'./assets/er-router-optimize.png\').default} alt=\\"node\\" width=\\"28%\\" />\\n</div>\\n<p align=\\"center\\">\u672a\u4f18\u5316\u524d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u4f18\u5316\u540e</p>\\n\\n\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u9488\u5bf9\u8282\u70b9\u81ea\u8eab\u7684\u5b57\u6bb5\u6307\u5411\u81ea\u5df1\u8fd9\u79cd\u60c5\u51b5\u505a\u4f18\u5316\u3002\\n\\n```ts\\n/**\\n * \u6ce8\u518c ER \u8def\u7531\\n */\\nexport function registerERRouter() {\\n  Graph.registerRouter(ER_ROUTER, (vertices, options, edgeView) => {\\n    const offsetRaw = options.offset || 32;\\n    const min = options.min == null ? 16 : options.min;\\n\\n    let offset = 0;\\n    let { direction } = options;\\n\\n    const { sourceBBox, targetBBox } = edgeView;\\n    const sourcePoint = sourceBBox.getCenter();\\n    const targetPoint = targetBBox.getCenter();\\n\\n    if (typeof offsetRaw === \'number\') {\\n      offset = offsetRaw;\\n    }\\n\\n    if (direction == null) {\\n      let dx = targetBBox.left - sourceBBox.right;\\n      let dy = targetBBox.top - sourceBBox.bottom;\\n\\n      if (dx >= 0 && dy >= 0) {\\n        direction = dx >= dy ? \'L\' : \'T\';\\n      } else if (dx <= 0 && dy >= 0) {\\n        dx = sourceBBox.left - targetBBox.right;\\n        if (dx >= 0) {\\n          direction = dx >= dy ? \'R\' : \'T\';\\n        } else {\\n          direction = \'T\';\\n        }\\n      } else if (dx >= 0 && dy <= 0) {\\n        dy = sourceBBox.top - targetBBox.bottom;\\n        if (dy >= 0) {\\n          direction = dx >= dy ? \'L\' : \'B\';\\n        } else {\\n          direction = \'L\';\\n        }\\n      } else {\\n        dx = sourceBBox.left - targetBBox.right;\\n        dy = sourceBBox.top - targetBBox.bottom;\\n        if (dx >= 0 && dy >= 0) {\\n          direction = dx >= dy ? \'R\' : \'B\';\\n        } else if (dx <= 0 && dy >= 0) {\\n          direction = \'B\';\\n        } else if (dx >= 0 && dy <= 0) {\\n          direction = \'R\';\\n        } else {\\n          direction = Math.abs(dx) > Math.abs(dy) ? \'R\' : \'B\';\\n        }\\n      }\\n    }\\n\\n    if (direction === \'H\') {\\n      direction = targetPoint.x - sourcePoint.x >= 0 ? \'L\' : \'R\';\\n    } else if (direction === \'V\') {\\n      direction = targetPoint.y - sourcePoint.y >= 0 ? \'T\' : \'B\';\\n    }\\n\\n    if (offsetRaw === \'center\') {\\n      if (direction === \'L\') {\\n        offset = (targetBBox.left - sourceBBox.right) / 2;\\n      } else if (direction === \'R\') {\\n        offset = (sourceBBox.left - targetBBox.right) / 2;\\n      } else if (direction === \'T\') {\\n        offset = (targetBBox.top - sourceBBox.bottom) / 2;\\n      } else if (direction === \'B\') {\\n        offset = (sourceBBox.top - targetBBox.bottom) / 2;\\n      }\\n    }\\n\\n    let coord: \'x\' | \'y\';\\n    let dim: \'width\' | \'height\';\\n    let factor;\\n    const horizontal = direction === \'L\' || direction === \'R\';\\n\\n    if (horizontal) {\\n      if (targetPoint.y === sourcePoint.y) {\\n        return [...vertices];\\n      }\\n\\n      factor = direction === \'L\' ? 1 : -1;\\n      coord = \'x\';\\n      dim = \'width\';\\n    } else {\\n      if (targetPoint.x === sourcePoint.x) {\\n        return [...vertices];\\n      }\\n\\n      factor = direction === \'T\' ? 1 : -1;\\n      coord = \'y\';\\n      dim = \'height\';\\n    }\\n\\n    const source = sourcePoint.clone();\\n    const target = targetPoint.clone();\\n\\n    source[coord] += factor * (sourceBBox[dim] / 2 + offset);\\n    target[coord] -= factor * (targetBBox[dim] / 2 + offset);\\n\\n    if (horizontal) {\\n      const sourceX = source.x;\\n      const targetX = target.x;\\n      const sourceDelta = sourceBBox.width / 2 + min;\\n      const targetDelta = targetBBox.width / 2 + min;\\n      if (targetPoint.x > sourcePoint.x) {\\n        if (targetX <= sourceX) {\\n          source.x = Math.max(targetX, sourcePoint.x + sourceDelta);\\n          target.x = Math.min(sourceX, targetPoint.x - targetDelta);\\n        }\\n      } else if (targetX >= sourceX) {\\n        source.x = Math.min(targetX, sourcePoint.x - sourceDelta);\\n        target.x = Math.max(sourceX, targetPoint.x + targetDelta);\\n      }\\n    } else {\\n      const sourceY = source.y;\\n      const targetY = target.y;\\n      const sourceDelta = sourceBBox.height / 2 + min;\\n      const targetDelta = targetBBox.height / 2 + min;\\n      if (targetPoint.y > sourcePoint.y) {\\n        if (targetY <= sourceY) {\\n          source.y = Math.max(targetY, sourcePoint.y + sourceDelta);\\n          target.y = Math.min(sourceY, targetPoint.y - targetDelta);\\n        }\\n      } else if (targetY >= sourceY) {\\n        source.y = Math.min(targetY, sourcePoint.y - sourceDelta);\\n        target.y = Math.max(sourceY, targetPoint.y + targetDelta);\\n      }\\n    }\\n\\n    // \u5982\u679c\u662f\u81ea\u5df1\u8fde\u81ea\u5df1\\n    if (sourcePoint.x === targetPoint.x) {\\n      target.x = source.x;\\n    }\\n\\n    return [source.toJSON(), ...vertices, target.toJSON()];\\n  });\\n\\n  return () => Graph.unregisterRouter(ER_ROUTER);\\n}\\n```\\n**\u6ce8\u518c\u8def\u7531\u65b9\u5f0f\u5982\u4e0b\uff1a**\\n\u5728\u521d\u59cb\u5316\u753b\u5e03\u7684 useEffect \u4e2d\uff0c\u5728\u8c03\u7528 `new Graph` \u4e4b\u524d\uff0c\u8c03\u7528 [registerERRouter](https://x6.antv.vision/zh/docs/api/registry/router/#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%B7%AF%E7%94%B1) \u65b9\u6cd5\u3002registerERRouter \u4f1a\u8fd4\u56de\u4e00\u4e2a\u9500\u6bc1\u7684\u65b9\u6cd5\uff0c\u5728 useEffect \u7684 return \u65b9\u6cd5\u4e2d\u8c03\u7528\u3002  \\n\u4f8b\uff1a\\n\\n```tsx\\nuseEffect(() => {\\n  // \u6ce8\u518c ER \u8def\u7531\\n  const erRouteDispose = registerERRouter();\\n  // ......\\n  // \u4ec5\u505a\u521d\u59cb\u5316\u5e03\u5c40\\n  const graph = new Graph({......})\\n\\n  return () => {\\n    graph.dispose();\\n    erRouteDispose();\\n    // ......\\n  };\\n}, []);\\n```\\n\\n## ERNode \u7ec4\u4ef6\u5b9e\u73b0\\n<div align=\\"center\\">\\n    <img src={require(\'./assets/er-node-01.png\').default} alt=\\"node\\" width=\\"37%\\" />\\n    <img src={require(\'./assets/er-node-02.png\').default} alt=\\"node\\" width=\\"60%\\" />\\n</div>\\n\u8fd9\u662f\u6211\u4eec\u8981\u5b9e\u73b0\u7684\u4e00\u4e2a ER \u8282\u70b9\u7684\u6837\u5f0f\u3002\u5728\u6e32\u67d3\u5199\u6cd5\u4e0a\u548c\u666e\u901a react \u7ec4\u4ef6\u6ca1\u4ec0\u4e48\u533a\u522b\uff0c\u4e00\u4e2a\u6807\u9898\u533a\u57df\u52a0\u4e00\u4e2a\u5217\u8868\u533a\u57df\uff0c\u4ee5\u53ca\u64cd\u4f5c\u6309\u94ae\u89e6\u53d1\u83dc\u5355\u3002\u533a\u522b\u5728\u4e8e\u5982\u4f55\u89e6\u53d1\u6570\u636e\u72b6\u6001\u66f4\u65b0\u3002\\n\\n`<ERNode/>`\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\n```tsx\\nimport React, { memo } from \\"react\\";\\nimport { ReactShape } from \\"@antv/x6-react-shape\\";\\nimport { isEqual } from \\"lodash\\";\\n\\ninterface Props {\\nnode?: ReactShape;\\n}\\n\\nconst ERNode: React.FC<Props> = ({ node }) => {\\n// \u83b7\u53d6\u8282\u70b9\u6570\u636e\\nconst data = node?.getData() as BusinessObject & NodeExtraProps;\\nconst {\\nselectedNodeId,\\ndomainCode,\\n// ......\\n} = data;\\n\\n// \u66f4\u65b0\u8282\u70b9\u65b9\u6cd5\u793a\u4f8b\\nconst handleShowNonRelationalFields = () => {\\nnode?.setData({\\n...node?.getData(),\\nisShowNonRelationalFields: !isShowNonRelationalFields,\\n});\\n};\\n\\nreturn // ......\\n};\\n\\n\\nexport default memo(ERNode, (prev, next) => {\\n// \u7cbe\u786e\u63a7\u5236\u8282\u70b9\u6e32\u67d3\\nreturn !isEqual(prev.node?.getData(), next.node?.getData());\\n});\\n```\\n\\n\u4e0e\u666e\u901a\u7684 React \u7ec4\u4ef6\u66f4\u65b0\u65b9\u5f0f\u4e0d\u540c\uff0cERNode \u7ec4\u4ef6\u63a5\u6536\u4e00\u4e2a [node](https://x6.antv.vision/zh/docs/api/model/node) \u5c5e\u6027\uff0c\u8be5\u5c5e\u6027\u4e3a x6 \u8282\u70b9\u5b9e\u4f8b\u3002node \u8282\u70b9\u4e0b\u6709\u4e2a [data](https://x6.antv.vision/zh/docs/tutorial/basic/cell#data) \u5c5e\u6027\u3002\u4e0e\u8282\u70b9/\u8fb9\u5173\u8054\u7684\u4e1a\u52a1\u6570\u636e\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u5728\u5b9e\u9645\u4f7f\u7528\u65f6\u901a\u5e38\u4f1a\u5c06\u67d0\u4e9b\u4e1a\u52a1\u6570\u636e\u5b58\u5728\u8282\u70b9/\u8fb9\u7684 data \u4e0a\u3002\u4f7f\u7528 `node.getData()` \u65b9\u6cd5\u53ef\u4ee5\u83b7\u53d6\u5230\u8282\u70b9/\u8fb9\u7684 data\u3002\\n\\n\u4e3a\u4e86\u7cbe\u786e\u63a7\u5236 ERNode \u7ec4\u4ef6\u6e32\u67d3\uff0c\u907f\u514d\u8282\u70b9\u8fc7\u591a\u65f6\u89e6\u53d1\u65e0\u6548\u6e32\u67d3\u5f71\u54cd\u7ec4\u4ef6\u6027\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u76d1\u542c node \u4e0a data \u7684\u53d8\u5316\uff0c\u6765\u66f4\u65b0\u8282\u70b9\u7684\u6e32\u67d3\u3002\\n\\n\u5982\u679c\u60f3\u8981\u4e3b\u52a8\u89e6\u53d1\u8282\u70b9\u7684\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528 `node.setData(...)` \u65b9\u6cd5\u6765\u5b9e\u73b0\u3002\\n\\n\\n:::tip\\n\\n\u5982\u679c\u60f3\u8981\u5728 ERNode \u7ec4\u4ef6\u5185\u83b7\u53d6\u5916\u90e8 React Context\uff08\u5305\u62ec\u9879\u76ee\u4e2d\u5e38\u7528\u7684 mobx store\uff09 \u7684\u503c\uff0cx6 \u6587\u6863\u4e2d\u63d0\u4f9b\u4e86 [Portal \u673a\u5236](https://x6.antv.vision/zh/docs/tutorial/advanced/react#%E8%8E%B7%E5%8F%96%E7%BB%84%E4%BB%B6%E4%B8%8A%E4%B8%8B%E6%96%87)\u3002\u4f46\u662f\u4f7f\u7528\u4e86\u8be5\u65b9\u6cd5\u83b7\u53d6\u5916\u90e8\u4e0a\u4e0b\u6587\u4f1a\u5bfc\u81f4\u5c0f\u5730\u56fe\u7ec4\u4ef6\u65e0\u6cd5\u6e32\u67d3\u3002\u56e0\u6b64\u5c0f\u5730\u56fe\u548c X6ReactPortalProvider \u53ea\u80fd\u4e8c\u9009\u4e00\u3002\\n\\n:::\\n\\n\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cHTML/React/Vue \u8282\u70b9\u5185\u5bb9\u90fd\u662f\u6e32\u67d3\u5728 SVG \u7684 [foreignObject](https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/foreignObject) \u5143\u7d20\u5185\u90e8\uff0c\u56e0\u4e3a\u6d4f\u89c8\u5668\u7684\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u7ecf\u5e38\u4f1a\u51fa\u73b0\u4e00\u4e9b\u5f02\u5e38\u7684\u6e32\u67d3\u884c\u4e3a\u3002\u4e3b\u8981\u8868\u73b0\u5f62\u5f0f\u4e3a\u8282\u70b9\u5185\u5bb9\u5c55\u793a\u4e0d\u5168\u6216\u8005\u8282\u70b9\u5185\u5bb9\u95ea\u70c1\u3002\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u6765\u89c4\u907f\uff1a\\n\u8282\u70b9\u5185\u90e8\u5143\u7d20\u7684 css \u6837\u5f0f\u4e2d\u4e0d\u8981\u4f7f\u7528 `position:absolute\u3001position:relative\u3001transform\u3001opacity`\u3002\\n\u5728 Safari \u6d4f\u89c8\u5668\u4e0a\u517c\u5bb9\u6027\u8868\u73b0\u4f1a\u66f4\u52a0\u5dee\u3002**\u5982\u679c\u9879\u76ee\u9700\u8981\u517c\u5bb9 Safari \u6d4f\u89c8\u5668\uff0c\u5efa\u8bae\u4e0d\u8981\u5728\u7ec4\u4ef6\u4e2d\u4f7f\u7528 react \u7ec4\u4ef6\u5e93\uff08antd\u3001c7n \u7b49\uff09\u7684\u590d\u6742\u7ec4\u4ef6\u3002\u5982\u679c\u4f7f\u7528\u4e86\uff0c\u9700\u8981\u53bb Safari \u6d4f\u89c8\u5668\u9a8c\u8bc1\u4e00\u4e0b\u662f\u5426\u517c\u5bb9\u3002**\\n\\n## \u8fde\u63a5\u6869\u7684\u5b9e\u73b0\\n<div align=\\"center\\">\\n    <img src={require(\'./assets/er-cell.png\').default} alt=\\"node\\" width=\\"100%\\" />\\n</div>\\n\\n\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u8282\u70b9\u4e0e\u8282\u70b9\u95f4\u5b58\u5728\u8fde\u7ebf\u5173\u7cfb\u3002\u6839\u636e x6 \u5bf9\u8fb9\u8fde\u63a5\u4f4d\u7f6e\u7684\u8981\u6c42\uff0c\u6211\u4eec\u9700\u8981\u5728\u8282\u70b9\u4e0a\u5b9a\u4e49\u8fde\u63a5\u6869\u3002\u6839\u636e\u8fde\u63a5\u6869\u7684\u4f4d\u7f6e\uff0c\u7cbe\u51c6\u8fde\u7ebf\u3002  \\n\u56e0\u4e3a\u8fde\u63a5\u6869\u7684\u4f4d\u7f6e\u6570\u636e\u548c\u5b57\u6bb5\u7c7b\u578b\u6570\u636e\u6709\u5173\u8054\uff0c\u6240\u4ee5**\u5728\u751f\u6210\u521d\u59cb\u5316\u8282\u70b9\u6570\u636e\u7684\u65f6\u5019\u6ce8\u5165\u8fde\u63a5\u6869\u6570\u636e**\u3002\u6bcf\u4e2a\u8fde\u63a5\u6869\u7684\u5f62\u72b6\u4e3a\u5b57\u6bb5\u884c\u7684\u5f62\u72b6\uff0c\u5c42\u7ea7 `z-index` \u8bbe\u7f6e\u4e3a -1\uff0c\u9690\u85cf\u5728\u8282\u70b9\u5c42\u7ea7\u4e4b\u540e\u3002\\n\\n<div align=\\"center\\">\\n    <img src={require(\'./assets/er-no-port.png\').default} alt=\\"node\\" width=\\"35%\\" />\\n    <img src={require(\'./assets/er-port.png\').default} alt=\\"node\\" width=\\"35%\\" />\\n</div>\\n\\n\u9ed1\u8272\u533a\u57df\u5373\u4e3a\u751f\u6210\u7684\u8fde\u63a5\u6869\u533a\u57df\u3002\u8fde\u63a5\u6869\u751f\u6210\u7684\u53c2\u6570\u53ef\u53c2\u8003\u5982\u4e0b\u4ee3\u7801\uff1a\\n\\n```ts\\nconst generatePorts = (id: string, attrs: Record<string, any>) => {\\n  return {\\n    id,\\n    markup: [\\n      {\\n        tagName: \'rect\',\\n        selector: \'portBody\',\\n      },\\n    ],\\n    args: {\\n      position: \'top\',\\n    },\\n    attrs: {\\n      portBody: {\\n        width: ER_NODE_WIDTH,\\n        strokeWidth: 1,\\n        stroke: \'rgba(0,0,0,0)\',\\n        fill: \'rgba(0,0,0,0)\',\\n        magnet: true,\\n        transform: \'matrix(1,0,0,1,0,0)\',\\n        ...attrs,\\n      },\\n    },\\n    zIndex: -1,\\n  };\\n};\\n```\\n\\n`attrs` \u4e3a\u989d\u5916\u5c5e\u6027\uff0c\u5728\u5217\u8868\u6570\u636e\u904d\u5386\u65f6\u52a8\u6001\u6ce8\u5165\u3002\\n\\n```ts\\n// \u8bbe\u7f6e\u8fde\u63a5\u6869\\nconst ports: any[] = [];\\n// \u8bbe\u7f6e\u6807\u9898\u8fde\u63a5\u6869\\nports.push(\\n  generatePorts(item.businessObjectId, {\\n    height: ER_LINE_HEIGHT,\\n  })\\n);\\n// \u8bbe\u7f6e\u4e1a\u52a1\u5bf9\u8c61\u5b57\u6bb5\u8fde\u63a5\u6869\\nitem.businessObjectFields.forEach((field, index) => {\\n  // \u5982\u679c\u662f\u5173\u8054\u7c7b\u578b\\n  if (RELATION_TYPE.includes(field.componentType)) {\\n    ports.push(\\n      generatePorts(field.businessObjectFieldId, {\\n        height: ER_LINE_HEIGHT,\\n        refY: ER_TITLE_HEIGHT + ER_LINE_HEIGHT * index,\\n      })\\n    );\\n  }\\n});\\n```\\n\u6839\u636e\u4e0d\u540c\u7684\u5217\u8868 y \u8f74\u4f4d\u7f6e\u7ed3\u5408\u7d22\u5f15\u751f\u6210 `refY` \u53c2\u6570\uff0c\u4f7f\u5f97\u8fde\u63a5\u6869\u77e9\u5f62\u5728 y \u8f74\u4ea7\u751f\u504f\u79fb\u5b9a\u4e49\u5230\u6240\u5bf9\u5e94\u7684\u5173\u8054\u5b57\u6bb5\u533a\u57df\u3002\\n\\nERNode \u8282\u70b9\u4e2d\u6709\u4e2a`\u9690\u85cf/\u663e\u793a\u975e\u5173\u7cfb\u5b57\u6bb5`\u7684\u529f\u80fd\uff0c\u8be5\u529f\u80fd\u4f1a\u5f71\u54cd\u5230\u8fde\u63a5\u6869\u7684\u751f\u6210\u3002\u6211\u4eec\u901a\u8fc7\u5728 node \u7684 data \u6570\u636e\u4e0a\u7ed1\u5b9a `isShowNonRelationalFields` \u5c5e\u6027\u6765\u63a7\u5236\u662f\u5426\u663e\u793a\u975e\u5173\u7cfb\u5b57\u6bb5\u3002\u6bcf\u5f53\u503c\u5207\u6362\u65f6\uff0c\u8fde\u63a5\u6869\u4f4d\u7f6e\u4e5f\u5f97\u91cd\u65b0\u8ba1\u7b97\u3002\\n\\n## \u8282\u70b9\u548c\u8fb9\u6570\u636e\u7684\u751f\u6210\\n\\n\u5728\u521d\u59cb\u5316\u8282\u70b9\u7684\u65f6\u5019\u6211\u4eec\u9700\u8981\u628a\u540e\u7aef\u4f20\u8fc7\u6765\u7684\u6570\u636e\u683c\u5f0f\u5316\u6210 x6 \u8282\u70b9\u9700\u8981\u7684\u6570\u636e\u683c\u5f0f\u3002\\n\\n<Tabs>\\n  <TabItem value=\\"1\\" label=\\"\u540e\u7aef\u7684\u6570\u636e\\" default>\\n\\n```ts\\nenum SourceType {\\n  PREDEFINE = \'PREDEFINE\', // \u7cfb\u7edf\u9884\u7f6e\\n  PLATFORM = \'PLATFORM\', // \u5e73\u53f0\u81ea\u5b9a\u4e49\\n  TENANT = \'TENANT\', // \u79df\u6237\u81ea\u5b9a\u4e49\\n}\\n\\n// \u4e1a\u52a1\u5bf9\u8c61\u5b57\u6bb5\u6570\u636e\uff08\u5305\u542b\u5173\u8054\uff09\\ninterface BusinessObjectField {\\n  businessObjectFieldId: string;\\n  businessObjectId: string;\\n  businessObjectFieldCode: string;\\n  businessObjectFieldName: string;\\n  requiredFlag: boolean;\\n  componentType: FieldComponentType; // \u4e1a\u52a1\u5bf9\u8c61\u7ec4\u4ef6\u7c7b\u578b\\n  inheritSourceType: string;\\n  requiredFlagValue: string;\\n  masterBusinessObjectId?: string; // \u5173\u8054\u7684\u4e1a\u52a1\u5bf9\u8c61id\\n  linkRelationType?: string; // \u8fde\u63a5\u7c7b\u578b ONE_TO_ONE ONE_TO_MANY\\n  relateType?: string; // \u5173\u7cfb\u7c7b\u578b\\n}\\n\\n// \u4e1a\u52a1\u5bf9\u8c61\u9ad8\u7ea7\u5173\u8054\u6570\u636e\\ninterface BusinessObjectAssociate {\\n  _token: string;\\n  businessObjectAssociateId: string;\\n  associateName: string;\\n  associateType: string;\\n  associateCode: string;\\n  linkRelationType: string;\\n  associateBusinessObjectId: string;\\n  preConditionFlag: boolean;\\n}\\n\\n// \u4e1a\u52a1\u5bf9\u8c61\u6570\u636e\\ninterface BusinessObject {\\n  _token: string;\\n  businessObjectId: string;\\n  businessObjectCode: string;\\n  businessObjectName: string;\\n  domainId: string;\\n  domainCode: string;\\n  publishStatus: string;\\n  businessObjectFields: BusinessObjectField[];\\n  skipResetPhysicalSyncFlag: boolean;\\n  extendFieldCreatedFlag: boolean;\\n  updatePhysicalFlag: boolean;\\n  sourceType: SourceType;\\n  businessObjectCategory: string;\\n  flexFieldEnabledFlag: boolean;\\n  extendTableEnabledFlag: boolean;\\n  objectVersionNumber: number;\\n  businessObjectAssociateList?: BusinessObjectAssociate[];\\n  relationBusinessObjectIds?: string[]; // \u4e0e\u6b64\u5bf9\u8c61\u5173\u8054\u7684\u4e1a\u52a1\u5bf9\u8c61id\\n  extendFieldPrefixRule?: string;\\n  physicalModelType?: string;\\n}\\n```\\n\\n  </TabItem>\\n  <TabItem value=\\"2\\" label=\\"\u683c\u5f0f\u5316\u540e\u7684 x6 \u6570\u636e\\">\\n\\n```ts\\n// \u8fde\u63a5\u6869\u6570\u636e\\ninterface Port {\\n  id: string;\\n  markup: any[];\\n  args: {\\n    position: string;\\n  };\\n  attrs: {\\n    portBody: {\\n      width: number;\\n      strokeWidth: number;\\n      stroke: string;\\n      fill: string;\\n      magnet: boolean;\\n      transform: string;\\n      height: number;\\n      refY?: number;\\n    };\\n  };\\n  zIndex: number;\\n}\\n\\n// x6 \u8282\u70b9\u6570\u636e\\ninterface Node {\\n  id: string;\\n  component: string;\\n  data: object; // \u6e32\u67d3 ERNode \u7ec4\u4ef6\u6240\u9700\u7684\u6570\u636e\\n  height: number;\\n  width: number;\\n  shape: string; // \u533a\u5206\u8282\u70b9\u6216\u8fb9\\n  ports: Port[];\\n}\\n\\n// x6 \u8fb9\u6570\u636e\\ninterface Edge {\\n  attrs: any[];\\n  labels: any[];\\n  shape: string;\\n  source: {\\n    cell: string;\\n    port: string;\\n  };\\n  target: {\\n    cell: string;\\n    port: string;\\n  };\\n}\\n\\ntype GraphData = Node[] | Edge[];\\n\\n```\\n\\n  </TabItem>\\n</Tabs>\\n\\n\u901a\u8fc7 `formatBoDataToReactERGraph` \u65b9\u6cd5\uff08\u89c1\u9879\u76ee\u4ee3\u7801\uff09\u53bb\u683c\u5f0f\u5316\u540e\u7aef\u6570\u636e\uff0c\u8be5\u65b9\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7b26\u5408x6\u6e32\u67d3\u6570\u636e\u7c7b\u578b\u7684\u6570\u7ec4\uff0c\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e00\u9879\u90fd\u662f\u4e00\u4e2a\u8282\u70b9\u6216\u8fb9\u7684\u6570\u636e\u3002  \\n\\n:::caution\\n\\n\u540e\u7aef\u8fd4\u56de\u7684\u8fb9\u6570\u636e\u5305\u542b\u5168\u90e8\u4e0e\u6b64\u8282\u70b9\u6709\u5173\u8054\u7684\u6570\u636e\u3002\u4f46\u662f\u9875\u9762\u4e0a\u5c55\u793a\u7684\u8282\u70b9\u5e76\u4e0d\u5168\u662f\u4e0e\u6b64\u8282\u70b9\u6709\u5173\u8054\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u65b9\u6cd5\u7684\u6700\u540e\u4e00\u6b65\u9700\u8981\u5bf9\u8fb9\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\uff0c**\u53ea\u4fdd\u7559\u4e0e\u753b\u5e03\u4e0a\u8282\u70b9\u6709\u5173\u8054\u7684\u6570\u636e**\u3002\u5982\u679c\u6dfb\u52a0\u7684\u8fb9\u6570\u636e\u7684\u6307\u5411 id \u7684\u8282\u70b9\u6ca1\u6709\u5728\u753b\u5e03\u4e2d\uff0c\u5219\u4f1a\u62a5\u9519\u3002\\n\\n:::\\n\\n\u751f\u6210\u8fb9\u7684\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\n```ts\\n// \u8bbe\u7f6e\u666e\u901a\u5b57\u6bb5\u7bad\u5934\\nitem.businessObjectFields.forEach((field) => {\\n  if (field.linkRelationType) {\\n    const edge: any = {\\n      shape: \'edge\',\\n      source: {\\n        cell: item.businessObjectId,\\n        port: field.businessObjectFieldId,\\n      },\\n      target: {\\n        cell: field.masterBusinessObjectId,\\n        port: field.masterBusinessObjectId,\\n      },\\n      attrs: {\\n        line: getEdgeLine(field.componentType),\\n      },\\n      labels: getEdgeLabels(field.linkRelationType),\\n    };\\n    edgesData.push(edge);\\n  }\\n});\\n```\\n\\n\u8fb9\u7684\u8d77\u7ec8\u70b9\u6570\u636e\u90fd\u9700\u8981 `cell` \u548c `port` \u5c5e\u6027\u6765\u51b3\u5b9a\u8fb9\u7684\u5750\u6807\u3002\\n- `cell` \u4ee3\u8868\u662f\u76ee\u6807\u8282\u70b9\uff0c\u53d6\u81ea `businessObjectFieldId`\u3002\\n- `port` \u4ee3\u8868\u662f\u5f53\u524d\u8282\u70b9\u4e2d\u7684\u54ea\u4e2a\u8fde\u63a5\u6869\uff0c\u53d6\u81ea `businessObjectId`\u3002  \\n\\n## \u9009\u4e2d\u8282\u70b9\u9ad8\u4eae\u5468\u56f4\u8fb9\u529f\u80fd\\n\\n<div align=\\"center\\">\\n    <img src={require(\'./assets/er-cell.png\').default} alt=\\"node\\" width=\\"100%\\" />\\n</div>\\n\\n\u6bcf\u4e2a ER \u8282\u70b9\u5206\u4e3a`\u9009\u4e2d`\u548c`\u975e\u9009\u4e2d`\u4e24\u79cd\u72b6\u6001\u3002\u5f53\u8282\u70b9\u4e3a\u9009\u4e2d\u72b6\u6001\u65f6\uff0c\u4f1a\u9ad8\u4eae\u8282\u70b9\u548c\u4e0e\u8282\u70b9\u76f8\u8fde\u7684\u8fb9\u3002  \\n\u5224\u65ad\u753b\u5e03\u4e2d\u54ea\u4e2a\u8282\u70b9\u88ab\u9009\u4e2d\u7684\u6570\u636e\u5b58\u5728\u4e8e\u8282\u70b9\u7684 `data` \u6570\u636e\u4e2d\uff0c\u901a\u8fc7 `selectedNodeId` \u5c5e\u6027\u6765\u63a7\u5236\u3002\u5982\u679c `selectedNodeId` \u548c\u5f53\u524d\u8282\u70b9\u7684 id \u76f8\u7b49\uff0c\u5219\u4ee3\u8868\u5f53\u524d\u8282\u70b9\u88ab\u9009\u4e2d\u3002  \\n\u5728\u5916\u90e8\u6570\u636e\u7ba1\u7406\u4e2d\uff0c`selectedNodeId` \u5b58\u5728\u4e8e Mobx Store \u4e2d\u7edf\u4e00\u7ba1\u7406\uff0c\u5e76\u4e14\u548c x6 \u753b\u5e03\u4e2d\u7684\u8282\u70b9\u6570\u636e\u8fdb\u884c\u7ed1\u5b9a\u7684\u3002\u5f53\u66f4\u65b0 Mobx Store \u7684 `selectedNodeId` \u7684\u65f6\u5019\uff0c\u4f1a\u89e6\u53d1 x6 \u753b\u5e03\u4e2d\u8282\u70b9\u7684\u66f4\u65b0\u3002  \\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 graph \u63d0\u4f9b\u7684 `on \u65b9\u6cd5`\uff0c\u53bb\u76d1\u542c\u8282\u70b9\u70b9\u51fb\u4e8b\u4ef6\u3002\\n\\n```ts\\nfunction addNodeClickListener({ node }: NodeView.EventArgs[\'node:click\']) {\\n  if (!graph) return;\\n  erStore.setState(\'selectedNodeId\', node.getData()?.businessObjectId || \'\');\\n}\\n\\n// \u6dfb\u52a0\u70b9\u51fb\u4e8b\u4ef6\\ngraph?.on(\'node:click\', addNodeClickListener);\\n```\\n\\n```tsx\\nuseEffect(() => {\\n  selectNode();\\n}, [erStore.getState(\'selectedNodeId\')]);\\n```\\n\\n\u8fd9\u6837\u4f7f\u5f97\u526f\u4f5c\u7528\u903b\u8f91\u5168\u90e8\u88ab\u63d0\u53d6\u5230 `selectNode` \u8fd9\u4e00\u4e2a\u65b9\u6cd5\u4e2d\u3002\\n\\n```tsx\\nexport const NORMAL_SOURCE_EDGE_ATTR = {\\n  strokeWidth: 1,\\n  sourceMarker: {\\n    r: 4,\\n    cx: 4,\\n  },\\n};\\n\\nexport const SELECTED_SOURCE_EDGE_ATTR = {\\n  strokeWidth: 2,\\n  sourceMarker: {\\n    r: 5,\\n    cx: 5,\\n  },\\n};\\n\\nconst curNodeRef = useRef<Cell>(); // \u5f53\u524d\u9009\u4e2d\u7684\u8282\u70b9\\nconst curEdgesRef = useRef<Edge[]>([]); // \u5f53\u524d\u9009\u4e2d\u7684\u8fb9\\n\\n// \u9009\u4e2d\u4e00\u4e2a\u8282\u70b9\\nfunction selectNode() {\\n  const selectedNode = graph?.getCellById(erStore.getState(\'selectedNodeId\'));\\n  const selectedNodeId = selectedNode?.getData()?.businessObjectId || \'\';\\n\\n  // \u8fd8\u539f\u4e0a\u4e00\u4e2a\u9009\u4e2d\u8282\u70b9\u989c\u8272\\n  if (curNodeRef.current) {\\n    curNodeRef.current?.setData({\\n      ...curNodeRef.current.getData(),\\n      selectedNodeId,\\n    });\\n  }\\n  // \u8fd8\u539f\u8fb9\\n  if (isArray(curEdgesRef.current) && curEdgesRef.current.length > 0) {\\n    curEdgesRef.current?.forEach((edge) => {\\n      edge.attr(\'line/strokeWidth\', NORMAL_SOURCE_EDGE_ATTR.strokeWidth);\\n      edge.attr(\'line/sourceMarker\', {\\n        ...(edge.getAttrs().line.sourceMarker as any),\\n        ...NORMAL_SOURCE_EDGE_ATTR.sourceMarker,\\n      });\\n    });\\n  }\\n\\n  if (selectedNode && graph) {\\n    // \u8bbe\u7f6e\u9009\u4e2d\u72b6\u6001\\n    selectedNode.toFront();\\n    selectedNode.setData({\\n      ...selectedNode.getData(),\\n      selectedNodeId,\\n    });\\n\\n    // \u8bbe\u7f6e\u8fb9\u5bbd\u5ea6\\n    const edges = graph.getConnectedEdges(selectedNode);\\n    edges.forEach((edge) => {\\n      edge.attr(\'line/strokeWidth\', SELECTED_SOURCE_EDGE_ATTR.strokeWidth);\\n      edge.attr(\'line/sourceMarker\', {\\n        ...(edge.getAttrs().line.sourceMarker as any),\\n        ...SELECTED_SOURCE_EDGE_ATTR.sourceMarker,\\n      });\\n    });\\n\\n    curNodeRef.current = selectedNode;\\n    curEdgesRef.current = edges;\\n  } else {\\n    curNodeRef.current = undefined;\\n    curEdgesRef.current = [];\\n  }\\n}\\n```\\n\\n\u5728\u6bcf\u6b21\u65b0\u9009\u62e9\u4e00\u4e2a\u8282\u70b9\u65f6\u8bfb\u53d6\u4e0a\u4e00\u6b21\u5b58\u50a8\u7684\u8282\u70b9\u6570\u636e\u3002\u5982\u679c\u6709\u6570\u636e\u5c31\u8fd8\u539f\uff0c\u518d\u8bbe\u7f6e\u5f53\u524d\u9009\u62e9\u8282\u70b9\u7684\u6570\u636e\u5e76\u5907\u4efd\u5230 `curNodeRef` \u548c `curEdgesRef` \u4e2d\u3002\\n\\n\\n## \u81ea\u52a8\u5e03\u5c40\\n\u81ea\u52a8\u5e03\u5c40\u65b9\u6cd5\u4fee\u6539\u81ea @antv/layout \u4e2d\u7b2c\u4e09\u65b9\u5f00\u53d1\u8005\u5199\u7684 [ErLayout](https://github.com/antvis/layout/blob/master/src/layout/er/index.ts)\u3002\u4e3b\u8981\u4fee\u6539\u4e86\u5bf9\u6570\u636e\u683c\u5f0f\u7684\u517c\u5bb9\u548c\u8282\u70b9\u73af\u7ed5\u7684\u95f4\u8ddd\u3002  \\n\u4ee5\u4e0b\u662f `ERLayout` \u4f7f\u7528\u65b9\u6cd5\u3002\\n\\n\\n```ts\\n/**\\n * \u6267\u884c ER \u5e03\u5c40\u7b97\u6cd5\\n * @constructor\\n */\\nexport function executeERLayout(graph: Graph) {\\n  const nodes = graph.getNodes();\\n  const edges = graph.getEdges();\\n  const width = graph.container.clientWidth;\\n  const height = graph.container.clientHeight;\\n  // \u52a0\u8f7d ER \u56fe\u5e03\u5c40\\n  const ERLayoutInstance = new ERLayout({\\n    nodes,\\n    edges,\\n    nodeMinGap: 20,\\n    width,\\n    height,\\n  });\\n\\n  return new Promise<void>((resolve) => {\\n    ERLayoutInstance.execute().then(({ nodes: newNodes = [] }) => {\\n      nodes.forEach((item) => {\\n        const node = newNodes.find((n) => n.id === item.id);\\n        if (node) {\\n          item.position(node.x || 0, node.y || 0);\\n        }\\n      });\\n      graph.zoomToFit({ padding: 10, maxScale: 1 });\\n      resolve();\\n    });\\n  });\\n}\\n```\\n\\n## \u4f4d\u7f6e\u7f13\u5b58\\n\u5982\u679c\u4e00\u4e2a\u8282\u70b9\u88ab\u62d6\u52a8\u5230\u4e00\u4e2a\u65b0\u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8282\u70b9\u7684\u4f4d\u7f6e\u4fe1\u606f\u5c31\u4f1a\u88ab\u7f13\u5b58\u5230 Mobx Store \u4e2d\u3002\u5f53\u518d\u6b21\u6253\u5f00\u8fd9\u4e2a\u8282\u70b9\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u8bfb\u53d6\u7f13\u5b58\u7684\u4f4d\u7f6e\u4fe1\u606f\uff0c\u7136\u540e\u8bbe\u7f6e\u5230\u8282\u70b9\u4e0a\u3002  \\n`nodePositions` \u7528\u6765\u5b58\u50a8\u8282\u70b9\u7684\u4f4d\u7f6e\u4fe1\u606f\uff0ckey \u4e3a\u8282\u70b9\u7684 id\uff08\u5373\u4e1a\u52a1\u5bf9\u8c61id\uff09\uff0cvalue \u4e3a\u8282\u70b9\u7684\u4f4d\u7f6e\u4fe1\u606f\u3002\\n\\n```ts\\n// \u91cd\u65b0\u8bbe\u7f6e\u8282\u70b9\\nconst nodePositions = erStore.getState(\'nodePositions\', true);\\nconst _cacheNodePositions = cloneDeep(nodePositions);\\nconst cells: any[] = [];\\nconst graphNodeIds = graph.getNodes().map((item) => item.id);\\nlet newNodeId = \'\';\\nnodes.forEach((node) => {\\n  if (graphNodeIds.indexOf(node.id) === -1) {\\n    newNodeId = node.id;\\n  }\\n  // \u8bfb\u53d6\u7f13\u5b58\u4f4d\u7f6e\\n  const position = nodePositions[node.id];\\n  if (position) {\\n    // eslint-disable-next-line no-param-reassign\\n    node.x = position.x;\\n    // eslint-disable-next-line no-param-reassign\\n    node.y = position.y;\\n  } else {\\n    // \u83b7\u53d6\u5f53\u524d graph \u5e73\u79fb\u7684\u4f4d\u7f6e, \u6dfb\u52a0\u8282\u70b9\u5230\u753b\u5e03\u5de6\u4e0a\u89d2(\u5982\u679c\u7f29\u7565\u56fe\u5728\u5c55\u5f00,\u9700\u8981\u907f\u5f00\u7f29\u7565\u56fe\u4f4d\u7f6e)\\n    const { x, y } = graph.scroller.widget!.getVisibleArea();\\n    let newX = isShowMiniMap ? x + 200 : x;\\n    let newY = isShowMiniMap ? y + 140 : y;\\n    // \u5f53\u524d\u753b\u5e03\u4e0a\u5b58\u5728\u7684\u8282\u70b9\u7684\u4f4d\u7f6e\u4fe1\u606f\\n    const curNodePositions = graph.getNodes().map((item) => {\\n      return item.position();\\n    });\\n    const _nodePositions = `${curNodePositions\\n      .map((item: any) => `${item.x},${item.y}`)\\n      .join(\';\')};`;\\n    while (_nodePositions.indexOf(`${newX},${newY};`) !== -1) {\\n      newX += 20;\\n      newY += 20;\\n    }\\n    // eslint-disable-next-line no-param-reassign\\n    node.x = newX;\\n    // eslint-disable-next-line no-param-reassign\\n    node.y = newY;\\n    // \u7f13\u5b58\u4f4d\u7f6e\\n    nodePositions[node.id] = { x: newX, y: newY };\\n  }\\n  cells.push(graph.createNode(node));\\n});\\nedges.forEach((edge) => {\\n  if (!graph.getCellById(edge.id)) {\\n    cells.push(graph.createEdge(edge));\\n  }\\n});\\n\\n// \u628a\u8282\u70b9\u548c\u8fb9\u8bbe\u7f6e\u5230\u753b\u5e03\u4e0a\\ngraph.resetCells(cells);\\n\\n// \u6ca1\u6709\u7f13\u5b58\u4f4d\u7f6e\u65f6,\u4e00\u6b21\u6dfb\u52a0\u591a\u4e2a\u8282\u70b9,\u4f7f\u7528\u81ea\u52a8\u5e03\u5c40\\nif (keys(_cacheNodePositions).length === 0 && ids.length - graphNodes.length > 1) {\\n  await executeERLayout(graph);\\n}\\n\\n// \u7f13\u5b58\u8282\u70b9\u4f4d\u7f6e\\ngraph.getNodes().forEach((node) => {\\n  const { x, y } = node.getBBox();\\n  nodePositions[node.id] = { x, y };\\n});\\nerStore.setState(\'nodePositions\', nodePositions);\\n\\n// \u5982\u679c\u662f\u65b0\u7684\u8282\u70b9\uff0c\u653e\u5230\u753b\u5e03\u5c42\u7ea7\u6700\u524d\u9762\\nif (newNodeId) {\\n  const newNode = graph.getCellById(newNodeId);\\n  if (newNode) {\\n    newNode.toFront();\\n  }\\n}\\n```\\n\u8bbe\u7f6e\u8282\u70b9\u4f4d\u7f6e\u4fe1\u606f\u5728 `updateGraphCells` \u65b9\u6cd5\u4e2d\uff0c\u8fd9\u91cc\u53ea\u5c55\u793a\u4e86\u90e8\u5206\u4ee3\u7801\u3002  \\n\u5982\u679c\u6dfb\u52a0\u7684\u662f\u65b0\u7684\u8282\u70b9\u4e14\u6ca1\u6709\u7f13\u5b58\u4f4d\u7f6e\uff0c\u5219\u8282\u70b9\u4f1a\u4ece\u753b\u5e03\u5de6\u4e0a\u89d2\u5f80\u53f3\u4e0b\u89d2\u6839\u636e\u504f\u79fb\u91cf\u8fdb\u884c\u8ba1\u7b97\u4f4d\u7f6e\u3002\\n\\n## \u53c2\u8003\u8d44\u6599\\n\\n - [antv/x6 \u5b98\u65b9\u6587\u6863(v1\u7248\u672c)](https://x6.antv.vision/zh/docs/tutorial/about)\\n - [antv/x6 Github \u6e90\u7801(v1.34.14)](https://github.com/antvis/X6/tree/%40antv/x6%401.34.14)\\n - [MDN SVG \u76f8\u5173\u6587\u6863](https://developer.mozilla.org/zh-CN/docs/Web/SVG)\\n - [\u6d45\u6790\u56fe\u5e03\u5c40\uff1a\u5e38\u89c1\u53ef\u89c6\u5316\u5e03\u5c40\u7b97\u6cd5\u539f\u7406](https://juejin.cn/post/7130468756379140104)\\n\\n<comment/>"},{"id":"TypeScript Operator","metadata":{"permalink":"/apaas-front-doc/blog/TypeScript Operator","source":"@site/blog/2022-11-13-TypeScript-Operator/index.md","title":"TypeScript \u64cd\u4f5c\u7b26","description":"\u4e09\u7c7b\u7a7a\u95f4","date":"2022-11-13T00:00:00.000Z","formattedDate":"2022\u5e7411\u670813\u65e5","tags":[{"label":"TypeScript","permalink":"/apaas-front-doc/blog/tags/type-script"}],"readingTime":5.54,"hasTruncateMarker":true,"authors":[{"name":"\u9ec4\u632f\u654f","title":"\u70df\u82b1\u6613\u51b7","job_no":25748,"url":"https://github.com/hzm0321","imageURL":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.92fa.com%2Fpic%2FTX1251_03.jpg&refer=http%3A%2F%2Fimg.92fa.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1670915005&t=61e1ff50cd599d4affcc74dfa4b7545d","key":"hzm"}],"frontMatter":{"slug":"TypeScript Operator","title":"TypeScript \u64cd\u4f5c\u7b26","authors":["hzm"],"tags":["TypeScript"]},"prevItem":{"title":"\u57fa\u4e8e antv/x6 \u5b9e\u73b0 ER \u56fe","permalink":"/apaas-front-doc/blog/ER"},"nextItem":{"title":"TypeScript \u7ec3\u4e60\u9898","permalink":"/apaas-front-doc/blog/TypeScript Challenge"}},"content":"## \u4e09\u7c7b\u7a7a\u95f4\\n\\n- **\u547d\u540d\u7a7a\u95f4**  \\n  \u58f0\u660e\u7684\u5206\u7c7b\uff0c\u4e0d\u662f\u5177\u4f53\u7684\u5b9e\u4f53\u3002\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u5185\u53ef\u4ee5\u5305\u542b\u503c\u6216\u7c7b\u578b\u3002\u5bf9\u547d\u540d\u7a7a\u95f4\u5efa\u7acb\u5e94\u7528\u9700\u8981\u4f7f\u7528 import \u8bed\u53e5\uff0c\u5982\u679c\u4f7f\u7528 const\u3001let \u6216 var \u4f1a\u4f7f\u65b0\u7684\u5b9e\u4f53\u4e0d\u518d\u5177\u6709\u547d\u540d\u7a7a\u95f4\u7684\u5c5e\u6027\u3002\u7f16\u8bd1\u6210 JS \u4ee3\u7801\u540e\u4f1a\u88ab\u6e05\u9664\u3002\\n- **\u7c7b\u578b\u7a7a\u95f4**  \\n  \u63cf\u8ff0\u4e00\u4e2a\u503c\u7684\u7c7b\u578b\u3002\u5e38\u89c1\u6709 type\u3001interface\u3001class\u3001enum \u7b49\u3002\u7f16\u8bd1\u6210 JS \u4ee3\u7801\u540e\u4f1a\u88ab\u6e05\u9664\u3002\\n- **\u503c\u7a7a\u95f4**  \\n  \u771f\u5b9e\u53ef\u53c2\u4e0e\u8fd0\u7b97\u7684\u503c\u3002\u5e38\u89c1\u6709\u53d8\u91cf\u3001\u5bf9\u8c61\u3001\u6570\u7ec4\u3001class\u3001enum \u7b49\u3002\u7f16\u8bd1\u6210 JS\u4ee3\u7801\u540e\u4f1a\u88ab\u4fdd\u7559\u3002\\n\\n## \u64cd\u4f5c\u7b26\\n- `typeof`\u3001`instanceof`\uff1a\u8fd4\u56de\u66f4\u8be6\u7ec6\u7684\u7c7b\u578b\\n- `keyof`\uff1a\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\u7684\u5c5e\u6027\u540d\u79f0\u7684\u5b57\u7b26\u4e32\u6570\u7ec4\\n- `O[K]`\uff1a\u8fd4\u56de\u5bf9\u8c61 K \u7684\u503c\\n- `[K in O]`\uff1a\u9010\u4e00\u6620\u5c04 O \u7684\u7c7b\u578b\\n- `extends`\uff1a\u6cdb\u578b\u3001\u7c7b\u578b\u522b\u540d\u3001\u51fd\u6570\u53c2\u6570\u3001\u8054\u5408\u7c7b\u578b\u7684\u6761\u4ef6\u7c7b\u578b\u5224\u65ad\\n- `infer`\uff1a\u5b9a\u4e49\u7c7b\u578b\u53d8\u91cf\\n- `readonly` \uff1a\u53ea\u8bfb\\n- `?`\uff1a\u53ef\u9009\\n- `-?`\uff1a\u53bb\u9664\u7c7b\u578b\u7684\u53ef\u9009\u5c5e\u6027\\n- `!`: \u975e\u7a7a\u65ad\u8a00\\n- `=`: \u6cdb\u578b\u7684\u9ed8\u8ba4\u503c\\n- `as`: \u7c7b\u578b\u65ad\u8a00\\n- `is`: \u7c7b\u578b\u8c13\u8bcd\uff0c\u8f85\u52a9\u7c7b\u578b\u63a8\u65ad\\n\\n\x3c!--truncate--\x3e\\n\\n### [typeof](https://www.typescriptlang.org/docs/handbook/2/typeof-types.html#handbook-content)\\n\\n**\u4f5c\u7528\uff1a\u628a\u503c\u7a7a\u95f4\u7684\u6570\u636e\u8f6c\u6362\u6210\u7c7b\u578b\u7a7a\u95f4\u7684\u6570\u636e\u3002**\\n\\n:::tip\\n\\n\u5728\u6807\u8bc6\u7b26\uff08\u5373\u53d8\u91cf\u540d\uff09\u6216\u5176\u5c5e\u6027\u4e0a\u4f7f\u7528 `typeof` \u624d\u5408\u6cd5\uff0c\u4e0d\u80fd\u4f5c\u7528\u4e8e\u6267\u884c\u7684\u4ee3\u7801\u3002  \\n\u4f8b\uff1alet shouldContinue: typeof msgbox(\\"Are you sure you want to continue?\\"); // error\\n\\n:::\\n\\n\u5e38\u7528\u4e8e\u5bfc\u5165\u503c\u7a7a\u95f4\u6570\u636e\u7684\u7c7b\u578b\uff0c\u4f8b\uff1a\\n\\n1. \u5bf9 function \u503c\u8f6c\u6362\uff0c\u83b7\u53d6\u5176\u8fd4\u56de\u503c\\n\\n```ts\\nfunction f() {\\n  return { x: 10, y: 3 };\\n}\\n\\ntype P = ReturnType<typeof f>; // {x: number \uff0cy: number}\\n```\\n\\n2. \u5bf9 enum \u503c\u8f6c\u6362\\n\\n```ts\\nenum Color {\\n  RED = \'red\',\\n  BLUE = \'blue\',\\n}\\n\\ntype C = typeof Color;\\n\\nconst c: C = {\\n  RED: Color.RED, // \u5fc5\u987b\u662f Color.RED\uff0c\u4e0d\u80fd\u662f red\\n  BLUE: Color.BLUE,\\n}\\n```\\n\\n3. \u5bf9 object \u503c\u8f6c\u6362\\n\\n```ts\\nconst Color = {\\n  RED : \'red\',\\n  BLUE : \'blue\',\\n}\\n\\ntype C = typeof Color; // {red: string \uff0cblue: string}\\n```\\n\\n4. \u5bf9 array \u503c\u8f6c\u6362\\n\\n```ts\\nconst Color = [\'red\',\'blue\', 1]\\n\\ntype C = typeof Color; // (string|number)[]\\n```\\n\\n5. \u5bf9\u57fa\u7840\u7c7b\u578b\u53d8\u91cf\uff0c\u83b7\u53d6\u5176\u5b57\u9762\u91cf\u7c7b\u578b\\n\\n```ts\\nconst str = \'red\'\\n\\ntype S = typeof str; // \'red\'\\n```\\n\\n### [keyof](https://www.typescriptlang.org/docs/handbook/2/keyof-types.html)\\n\\n**\u4f5c\u7528\uff1a\u83b7\u53d6\u5bf9\u8c61\u6216\u6570\u7ec4\u7b49\u7c7b\u578b\u7684\u6240\u6709\u952e\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u8054\u5408\u7c7b\u578b**\\n\\n```ts\\ninterface Person {\\n  name: string\\n  age: number\\n}\\n\\ntype K1 = keyof Person  // \\"name\\" | \\"age\\"\\n\\ntype K2 = keyof []      // \\"length\\" | \\"toString\\" | \\"push\\" | \\"concat\\" | \\"join\\"\\n\\ntype K3 = keyof { [x: string]: Person }  // string | number\\n```\\n\\n1. \u5bf9\u666e\u901a\u5bf9\u8c61\u7c7b\u578b\\n\\n```ts\\ninterface Person {\\n  name: string\\n  age: number\\n}\\n\\ntype K1 = keyof Person  // \\"name\\" | \\"age\\"\\n```\\n\\n2. \u5bf9 string \u6216 number \u7b7e\u540d\u5bf9\u8c61\u7c7b\u578b\\n\\n```ts\\ntype Arrayish = { [n: number]: unknown };\\ntype A = keyof Arrayish; // number\\n\\ntype Mapish = { [k: string]: boolean };\\ntype M = keyof Mapish; // number | string\\n```\\n\\n:::tip\\n\\nJS \u7684\u5bf9\u8c61 key \u7c7b\u578b\u53ea\u80fd\u662f `string`\u3001`number` \u6216 `Symbol` \u7c7b\u578b\\n\\n:::\\n\\n### [O[K]](https://www.typescriptlang.org/docs/handbook/2/indexed-access-types.html)\\n\\n**\u4f5c\u7528\uff1a\u4f7f\u7528\u7d22\u5f15\u8bbf\u95ee\u7c7b\u578b\u67e5\u627e\u53e6\u4e00\u79cd\u7c7b\u578b\u7684\u7279\u5b9a\u5c5e\u6027**\\n\\n1. \u666e\u901a\u8bbf\u95ee\\n\\n```ts\\ntype Person = { age: number; name: string; alive: boolean };\\ntype Age = Person[\\"age\\"]; // number\\n```\\n\\n2. \u8054\u5408\u8bbf\u95ee\\n\\n```ts\\ntype Person = { age: number; name: string; alive: boolean };\\ntype I1 = Person[\\"age\\" | \\"name\\"]; // string | number\\n```\\n\\n### [in](https://www.typescriptlang.org/docs/handbook/2/mapped-types.html)\\n\\n**\u4f5c\u7528\uff1a\u5bf9`\u8054\u5408\u7c7b\u578b`\u8fdb\u884c\u904d\u5386**\\n\\n```ts\\ntype Keys = \\"firstName\\" | \\"lastName\\";\\ntype Person = {\\n  [key in Keys]: string;\\n}; // {firstName: string; lastName: string}\\n```\\n\\n### [extends](https://www.typescriptlang.org/docs/handbook/2/conditional-types.html)\\n\\n**\u4f5c\u7528\uff1a\u6839\u636e\u6761\u4ef6\u8fd4\u56de\u7ed3\u679c\uff0c\u7c7b\u4f3c\u4e09\u5143\u8fd0\u7b97\u7b26\u3002**\\n\\n1. \u7c7b\u7ee7\u627f\u6761\u4ef6\\n\\n```ts\\ninterface Animal {\\n  live(): void;\\n}\\ninterface Dog extends Animal {\\n  woof(): void;\\n}\\ntype Example1 = Dog extends Animal ? number : string; // number\\n```\\n\\n2. \u5bf9\u8c61\u5c5e\u6027\u6761\u4ef6\\n\\n```ts\\ntype MessageOf<T extends { message: unknown }> = T[\\"message\\"];\\ntype B = MessageOf<{ message: string }>; // string\\n```\\n\\n3. \u904d\u5386\u8054\u5408\u7c7b\u578b\\n\\n```ts\\ntype OnlyNumber<T> = T extends number ? T : never;\\ntype N = OnlyNumber<1 | 2 | true | \\"a\\" | \\"b\\">; // 1 | 2\\n```\\n\\n4. \u4e0d\u5206\u5e03\u7684\u6761\u4ef6\u7c7b\u578b\\n\\n```ts\\ntype ToArrayNonDist<T> = [T] extends [any] ? T[] : never;\\ntype R = ToArrayNonDist<string | number>; // (string|number)[]\\n```\\n\\n### [infer](https://www.typescriptlang.org/docs/handbook/2/conditional-types.html#inferring-within-conditional-types)\\n\\n**\u4f5c\u7528\uff1a\u5bf9\u8fd0\u7b97\u8fc7\u7a0b\u4e2d\u7684\u7c7b\u578b\u8fdb\u884c\u5b58\u50a8\uff0c\u7c7b\u4f3c\u4e8e\u5b9a\u4e49\u4e00\u4e2a\u53d8\u91cf\u3002**\\n\\n1. \u5bf9\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u7684\u5b58\u50a8\\n\\n```ts\\ntype ReturnType<T> = T extends (...args: any) => infer R ? R : any;\\ntype R1 = ReturnType<() => number>; // number\\n```\\n\\n### [readonly](https://www.typescriptlang.org/docs/handbook/2/objects.html#readonly-properties)\\n\\n**\u4f5c\u7528\uff1a\u8bbe\u7f6e\u7c7b\u578b\u4e3a\u53ea\u8bfb**\\n\\n```ts\\ninterface SomeType {\\n  readonly name: string;\\n}\\n\\nconst My: SomeType = {\\n  name: \'123\'\\n}\\n\\nMy.name = \'456\'; // \u65e0\u6cd5\u5206\u914d\u5230 \\"name\\" \uff0c\u56e0\u4e3a\u5b83\u662f\u53ea\u8bfb\u5c5e\u6027\u3002\\n```\\n\\n### ?\\n\\n**\u4f5c\u7528\uff1a\u8bbe\u7f6e\u7c7b\u578b\u4e3a\u53ef\u9009**\\n\\n```ts\\ninterface SomeType {\\n  readonly name?: string;\\n}\\nconst My: SomeType = {}\\n```\\n\\n### -?\\n\\n**\u4f5c\u7528\uff1a\u53bb\u9664\u7c7b\u578b\u7684\u53ef\u9009\u5c5e\u6027(\u53d8\u6210\u5fc5\u9009)**\\n\\n```ts\\ninterface SomeType {\\n  readonly name?: string;\\n}\\n\\ntype MyRequired<T> = {\\n  [P in keyof T]-?: T[P];\\n};\\n\\nconst My: MyRequired<SomeType> = {}; // \u7c7b\u578b \\"{}\\" \u4e2d\u7f3a\u5c11\u5c5e\u6027 \\"name\\"\\n```\\n<comment/>"},{"id":"TypeScript Challenge","metadata":{"permalink":"/apaas-front-doc/blog/TypeScript Challenge","source":"@site/blog/2022-09-14-TypeScript-Challenge/index.md","title":"TypeScript \u7ec3\u4e60\u9898","description":"TypeScript \u7c7b\u578b\u4f53\u64cd\uff0c\u8ba9\u4f60\u7684 TypeScript \u4ee3\u7801\u66f4\u52a0\u5065\u58ee\u3002\u9898\u5e93\u5730\u5740: TypeScript Challenge","date":"2022-09-14T00:00:00.000Z","formattedDate":"2022\u5e749\u670814\u65e5","tags":[{"label":"TypeScript","permalink":"/apaas-front-doc/blog/tags/type-script"}],"readingTime":12.465,"hasTruncateMarker":true,"authors":[{"name":"\u9ec4\u632f\u654f","title":"\u70df\u82b1\u6613\u51b7","job_no":25748,"url":"https://github.com/hzm0321","imageURL":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.92fa.com%2Fpic%2FTX1251_03.jpg&refer=http%3A%2F%2Fimg.92fa.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1670915005&t=61e1ff50cd599d4affcc74dfa4b7545d","key":"hzm"}],"frontMatter":{"slug":"TypeScript Challenge","title":"TypeScript \u7ec3\u4e60\u9898","authors":["hzm"],"tags":["TypeScript"]},"prevItem":{"title":"TypeScript \u64cd\u4f5c\u7b26","permalink":"/apaas-front-doc/blog/TypeScript Operator"},"nextItem":{"title":"react-monaco-editor \u5e38\u7528\u914d\u7f6e\u9879","permalink":"/apaas-front-doc/blog/react-monaco-editor \u5e38\u7528\u914d\u7f6e\u9879"}},"content":"TypeScript \u7c7b\u578b\u4f53\u64cd\uff0c\u8ba9\u4f60\u7684 TypeScript \u4ee3\u7801\u66f4\u52a0\u5065\u58ee\u3002\u9898\u5e93\u5730\u5740: [TypeScript Challenge](https://github.com/type-challenges/type-challenges)\\n\\n\x3c!--truncate--\x3e\\n\\n## \u70ed\u8eab\\n\\n### 13. Hello World\\n\\n\u671f\u671b `HelloWorld` \u662f\u4e00\u4e2a `string` \u7c7b\u578b\\n\\n```ts\\ntype HelloWorld = any\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype HelloWorld = string\\n```\\n</details>\\n\\n## \u7b80\u5355\\n\\n### 4. Pick\\n\\n\u5b9e\u73b0\u4e00\u4e2a `Pick<T, K>`\uff0c\u4ece `T` \u4e2d\u6311\u9009\u51fa\u4e00\u7cfb\u5217 `K` \u7684\u5c5e\u6027\u3002  \\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\ninterface Todo {\\n  title: string\\n  description: string\\n  completed: boolean\\n}\\n\\ntype TodoPreview = MyPick<Todo, \'title\' | \'completed\'>\\n\\nconst todo: TodoPreview = {\\n    title: \'Clean room\',\\n    completed: false,\\n}\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype Pick<T, K extends keyof T> = {\\n  [P in K]: T[P]\\n}\\n```\\n\u77e5\u8bc6\u70b9\uff1a  \\n1. \u4f7f\u7528 `in` \u64cd\u4f5c\u7b26\u904d\u5386\u8054\u5408\u7c7b\u578b\u7684\u952e\\n\\n</details>\\n\\n### 7. Readonly\\n\\n\u4e0d\u8981\u4f7f\u7528\u5185\u7f6e\u7684`Readonly<T>`\uff0c\u81ea\u5df1\u5b9e\u73b0\u4e00\u4e2a\u3002\\n\\n\u8be5 `Readonly` \u4f1a\u63a5\u6536\u4e00\u4e2a _\u6cdb\u578b\u53c2\u6570_\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u5b8c\u5168\u4e00\u6837\u7684\u7c7b\u578b\uff0c\u53ea\u662f\u6240\u6709\u5c5e\u6027\u90fd\u4f1a\u88ab `readonly` \u6240\u4fee\u9970\u3002\\n\\n\u4e5f\u5c31\u662f\u4e0d\u53ef\u4ee5\u518d\u5bf9\u8be5\u5bf9\u8c61\u7684\u5c5e\u6027\u8d4b\u503c\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\ninterface Todo {\\n  title: string\\n  description: string\\n}\\n\\nconst todo: MyReadonly<Todo> = {\\n  title: \\"Hey\\",\\n  description: \\"foobar\\"\\n}\\n\\ntodo.title = \\"Hello\\" // Error: cannot reassign a readonly property\\ntodo.description = \\"barFoo\\" // Error: cannot reassign a readonly property\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype Readonly<T> = {\\n  readonly [P in keyof T] : T[P]\\n}\\n\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u4f7f\u7528 `readonly` \u521b\u5efa\u53ea\u8bfb\u5c5e\u6027\\n2. \u4f7f\u7528 `keyof` \u83b7\u53d6\u5bf9\u8c61\u7684\u952e\uff0c\u518d\u7528 `in` \u8fdb\u884c\u904d\u5386\\n\\n</details>\\n\\n### 11. \u5143\u7ec4\u8f6c\u6362\u4e3a\u5bf9\u8c61\\n\\n\u4f20\u5165\u4e00\u4e2a\u5143\u7ec4\u7c7b\u578b\uff0c\u5c06\u8fd9\u4e2a\u5143\u7ec4\u7c7b\u578b\u8f6c\u6362\u4e3a\u5bf9\u8c61\u7c7b\u578b\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u7c7b\u578b\u7684\u952e/\u503c\u90fd\u662f\u4ece\u5143\u7ec4\u4e2d\u904d\u5386\u51fa\u6765\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\nconst tuple = [\'tesla\', \'model 3\', \'model X\', \'model Y\'] as const\\n\\ntype result = TupleToObject<typeof tuple> // expected { tesla: \'tesla\', \'model 3\': \'model 3\', \'model X\': \'model X\', \'model Y\': \'model Y\'}\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype TupleToObject<T extends readonly PropertyKey[]> = {\\n  [P in T[number]]: P\\n}\\n\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1.  `PropertyKey` \u5c5e\u4e8e TS \u5185\u7f6e\u7c7b\u578b\uff0c\u4e3a `string | number | symbol` \u7684\u8054\u5408\u7c7b\u578b\\n2. \u4f7f\u7528 `T[number]]` \u904d\u5386\u5143\u7ec4\u7c7b\u578b\\n\\n</details>\\n\\n### 14. \u7b2c\u4e00\u4e2a\u5143\u7d20\\n\\n\u5b9e\u73b0\u4e00\u4e2a\u901a\u7528`First<T>`\uff0c\u5b83\u63a5\u53d7\u4e00\u4e2a\u6570\u7ec4`T`\u5e76\u8fd4\u56de\u5b83\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u7c7b\u578b\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\ntype arr1 = [\'a\', \'b\', \'c\']\\ntype arr2 = [3, 2, 1]\\n\\ntype head1 = First<arr1> // expected to be \'a\'\\ntype head2 = First<arr2> // expected to be 3\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype First<T extends any[]> = T extends [] ? never :  T[0]\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1.  \u4f7f\u7528\u7d22\u5f15\u8bbf\u95ee\u6570\u7ec4\u7c7b\u578b\u7684\u5143\u7d20\\n\\n</details>\\n\\n### 18. \u83b7\u53d6\u5143\u7ec4\u957f\u5ea6\\n\\n\u521b\u5efa\u4e00\u4e2a\u901a\u7528\u7684`Length`\uff0c\u63a5\u53d7\u4e00\u4e2a`readonly`\u7684\u6570\u7ec4\uff0c\u8fd4\u56de\u8fd9\u4e2a\u6570\u7ec4\u7684\u957f\u5ea6\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\ntype tesla = [\'tesla\', \'model 3\', \'model X\', \'model Y\']\\ntype spaceX = [\'FALCON 9\', \'FALCON HEAVY\', \'DRAGON\', \'STARSHIP\', \'HUMAN SPACEFLIGHT\']\\n\\ntype teslaLength = Length<tesla> // expected 4\\ntype spaceXLength = Length<spaceX> // expected 5\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype Length<T extends readonly any[]> = T[\\"length\\"]\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1.  \u4f7f\u7528 `\\"length\\"` \u8bbf\u95ee\u5143\u7ec4\u7c7b\u578b\u7684\u957f\u5ea6\\n\\n</details>\\n\\n### 43. Exclude\\n\\n\u5b9e\u73b0\u5185\u7f6e\u7684 `Exclude<T, U>` \u7c7b\u578b\uff0c\u4f46\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528\u5b83\u672c\u8eab\u3002\\n\\n> \u4ece\u8054\u5408\u7c7b\u578bT\u4e2d\u6392\u9664U\u7684\u7c7b\u578b\u6210\u5458\uff0c\u6765\u6784\u9020\u4e00\u4e2a\u65b0\u7684\u7c7b\u578b\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\ntype Result = Exclude<\'a\' | \'b\' | \'c\', \'a\'> // \'b\' | \'c\'\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype Exclude<T, U> = T extends U ? never : T\\n```\\n</details>\\n\\n### 189. Awaited\\n\\n\u5b9e\u73b0\u4e00\u4e2a `Awaited<T>`\uff0c\u5b83\u63a5\u53d7\u4e00\u4e2a `Promise` \u7c7b\u578b\u5e76\u8fd4\u56de\u5b83 resolve \u7684\u7c7b\u578b\u3002\\n\\n\u4f8b\u5982\uff1a`Promise<ExampleType>`\uff0c\u8bf7\u4f60\u8fd4\u56de ExampleType \u7c7b\u578b\u3002\\n\\n```ts\\ntype ExampleType = Promise<string>\\n\\ntype Result = Awaited<ExampleType> // string\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype MyAwaited<T extends PromiseLike<any>> = \\n  T extends PromiseLike<infer R> \\n    ? R extends PromiseLike<any> \\n      ? MyAwaited<R> \\n      : R \\n    : never\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u4f7f\u7528 `PromiseLike` \u5224\u65ad\u6570\u636e\u7c7b\u578b\u662f\u5426\u4e3a\u7c7b\u4f3c `Promise` \u7684\u7c7b\u578b\\n2. \u4f7f\u7528 `infer` \u63a5\u6536 `Promise` `resolve` \u7684\u53d8\u91cf\\n3. \u9012\u5f52\u5224\u65ad `Promise` \u7684 `resolve` \u7c7b\u578b\u662f\u5426\u4e3a `Promise` \u7c7b\u578b\uff08Promise \u5177\u5907\u503c\u7a7f\u900f\u7684\u7279\u6027\uff09\\n\\n</details>\\n\\n### 268. If\\n\\n\u5b9e\u73b0\u4e00\u4e2a `IF` \u7c7b\u578b\uff0c\u5b83\u63a5\u6536\u4e00\u4e2a\u6761\u4ef6\u7c7b\u578b `C` \uff0c\u4e00\u4e2a\u5224\u65ad\u4e3a\u771f\u65f6\u7684\u8fd4\u56de\u7c7b\u578b `T` \uff0c\u4ee5\u53ca\u4e00\u4e2a\u5224\u65ad\u4e3a\u5047\u65f6\u7684\u8fd4\u56de\u7c7b\u578b `F`\u3002 `C` \u53ea\u80fd\u662f `true` \u6216\u8005 `false`\uff0c `T` \u548c `F` \u53ef\u4ee5\u662f\u4efb\u610f\u7c7b\u578b\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\ntype A = If<true, \'a\', \'b\'>  // expected to be \'a\'\\ntype B = If<false, \'a\', \'b\'> // expected to be \'b\'\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype If<T extends boolean, A ,B> = T extends true ? A : B;\\n```\\n</details>\\n\\n### 533. Concat\\n\\n\u5728\u7c7b\u578b\u7cfb\u7edf\u91cc\u5b9e\u73b0 JavaScript \u5185\u7f6e\u7684 `Array.concat` \u65b9\u6cd5\uff0c\u8fd9\u4e2a\u7c7b\u578b\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff0c\u8fd4\u56de\u7684\u65b0\u6570\u7ec4\u7c7b\u578b\u5e94\u8be5\u6309\u7167\u8f93\u5165\u53c2\u6570\u4ece\u5de6\u5230\u53f3\u7684\u987a\u5e8f\u5408\u5e76\u4e3a\u4e00\u4e2a\u65b0\u7684\u6570\u7ec4\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\ntype Result = Concat<[1], [2]> // expected to be [1, 2]\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype Concat<T extends unknown[], U extends unknown[]> = [...T, ...U]\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u4f7f\u7528 `...` \u62fc\u63a5\u6570\u7ec4\\n\\n</details>\\n\\n### 898. Includes\\n\\n\u5728\u7c7b\u578b\u7cfb\u7edf\u91cc\u5b9e\u73b0 JavaScript \u7684 `Array.includes` \u65b9\u6cd5\uff0c\u8fd9\u4e2a\u7c7b\u578b\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff0c\u8fd4\u56de\u7684\u7c7b\u578b\u8981\u4e48\u662f `true` \u8981\u4e48\u662f `false`\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\ntype isPillarMen = Includes<[\'Kars\', \'Esidisi\', \'Wamuu\', \'Santana\'], \'Dio\'> // expected to be `false`\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\n\\ntype Equal<X, Y> =\\n  (<T>() => T extends X ? 1 : 2) extends\\n    (<T>() => T extends Y ? 1 : 2) ? true : false\\n\\ntype Includes<T extends readonly unknown[], U> = T extends [infer F, ...infer R] \\n  ? Equal<F, U> extends true \\n    ? true \\n    : Includes<R, U> \\n  : false\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u4f7f\u7528 `...` \u62fc\u63a5\u6570\u7ec4\\n\\n</details>\\n\\n### 3057. Push\\n\\n\u5728\u7c7b\u578b\u7cfb\u7edf\u91cc\u5b9e\u73b0\u901a\u7528\u7684 ```Array.push``` \u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```typescript\\ntype Result = Push<[1, 2], \'3\'> // [1, 2, \'3\']\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype Push<T extends unknown[], U> = [...T, U]\\n```\\n</details>\\n\\n### 3060. Unshift\\n\\n\u5b9e\u73b0\u7c7b\u578b\u7248\u672c\u7684 ```Array.unshift```\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```typescript\\ntype Result = Unshift<[1, 2], 0> // [0, 1, 2,]\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype Unshift<T extends unknown[], U> = [U, ...T]\\n```\\n</details>\\n\\n### 3312. Parameters\\n\\n\u5b9e\u73b0\u4e00\u4e2a `Parameters<T>`\uff0c\u5b83\u63a5\u53d7\u4e00\u4e2a\u51fd\u6570\u7c7b\u578b `T` \u5e76\u8fd4\u56de\u4e00\u4e2a\u7531\u53c2\u6570\u7c7b\u578b\u7ec4\u6210\u7684\u5143\u7ec4\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\nconst foo = (arg1: string, arg2: number): void => {}\\n\\ntype FunctionParamsType = MyParameters<typeof foo> // [arg1: string, arg2: number]\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype Parameters<T extends (...args: any[]) => any> = T extends (...args: infer P) => any ? P : never\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u4f7f\u7528 `infer` \u63a5\u6536\u51fd\u6570\u53c2\u6570\u7c7b\u578b\\n\\n</details>\\n\\n## \u4e2d\u7b49\\n\\n### 2. \u83b7\u53d6\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\\n\\n\u4e0d\u4f7f\u7528 `ReturnType` \u5b9e\u73b0 TypeScript \u7684 `ReturnType<T>` \u6cdb\u578b\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\nconst fn = (v: boolean) => {\\n  if (v)\\n    return 1\\n  else\\n    return 2\\n}\\n\\ntype a = MyReturnType<typeof fn> // \u5e94\u63a8\u5bfc\u51fa \\"1 | 2\\"\\n```\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype ReturnType<T extends (...args: any[])=> any> = T extends (...args: any[]) => infer R ? R : any\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u4f7f\u7528 `infer` \u63a5\u6536\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\\n\\n</details>\\n\\n### 3. Omit\\n\\n\u4e0d\u4f7f\u7528 `Omit` \u5b9e\u73b0 TypeScript \u7684 `Omit<T, K>` \u6cdb\u578b\u3002\\n\\n`Omit` \u4f1a\u521b\u5efa\u4e00\u4e2a\u7701\u7565 `K` \u4e2d\u5b57\u6bb5\u7684 `T` \u5bf9\u8c61\u3002\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\ninterface Todo {\\n  title: string\\n  description: string\\n  completed: boolean\\n}\\n\\ntype TodoPreview = MyOmit<Todo, \'description\' | \'title\'>\\n\\nconst todo: TodoPreview = {\\n  completed: false,\\n}\\n```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype MyOmit<T, K extends keyof T> = { [P in keyof T as P extends K ? never : P]: T[P] };\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u4f7f\u7528 `as` \u5728 TS \u8fd0\u7b97\u4e2d\u91cd\u65b0\u5b9a\u4e49\u7c7b\u578b\uff0c\u518d\u6b21\u53c2\u4e0e\u540e\u7eed\u8fd0\u7b97\\n\\n</details>\\n\\n### 8. Readonly 2\\n\\n\u5b9e\u73b0\u4e00\u4e2a\u901a\u7528MyReadonly2<T, K>\uff0c\u5b83\u5e26\u6709\u4e24\u79cd\u7c7b\u578b\u7684\u53c2\u6570T\u548cK\u3002 \\n\\nK\u6307\u5b9a\u5e94\u8bbe\u7f6e\u4e3a\u53ea\u8bfb\u7684\u5c5e\u6027\u7684\u5b50\u96c6\u3002\\n\\n\\n\u4f8b\u5982\uff1a\\n\\n```ts\\ninterface Todo {\\n  title: string\\n  description: string\\n  completed: boolean\\n}\\n\\nconst todo: MyReadonly2<Todo, \'title\' | \'description\'> = {\\n  title: \\"Hey\\",\\n  description: \\"foobar\\",\\n  completed: false,\\n}\\n\\ntodo.title = \\"Hello\\" // Error: cannot reassign a readonly property\\ntodo.description = \\"barFoo\\" // Error: cannot reassign a readonly property\\ntodo.completed = true // OK\\n```\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype MyReadonly2<T, K extends keyof T = keyof T> = {\\n  [P in keyof T as P extends K ? never : P]: T[P]\\n} & {\\n  readonly [Key in K]: T[Key]\\n}\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u7ed9 `K` \u5b9a\u4e49\u9ed8\u8ba4\u503c\uff0c\u8ba9 `K` \u4e3a\u7a7a\u65f6\uff0c\u6240\u6709\u5c5e\u6027\u90fd\u4e3a\u53ea\u8bfb\\n2. \u628a\u7ed3\u679c\u7684\u7c7b\u578b\u62c6\u4e3a\u4e24\u90e8\u5206\uff0c\u4e00\u90e8\u5206\u4e3a\u6392\u9664\u4e86`K`\u7684\u539f\u6709\u5c5e\u6027\uff0c\u4e00\u90e8\u5206\u4e3a\u53ea\u8bfb\u5c5e\u6027\\n\\n</details>\\n\\n### 9. \u5bf9\u8c61\u5c5e\u6027\u53ea\u8bfb\uff08\u9012\u5f52\uff09\\n\u5b9e\u73b0\u4e00\u4e2a\u6cdb\u578b `DeepReadonly<T>`\uff0c\u5b83\u5c06\u5bf9\u8c61\u7684\u6bcf\u4e2a\u53c2\u6570\u53ca\u5176\u5b50\u5bf9\u8c61\u9012\u5f52\u5730\u8bbe\u4e3a\u53ea\u8bfb\u3002\\n\\n\u60a8\u53ef\u4ee5\u5047\u8bbe\u5728\u6b64\u6311\u6218\u4e2d\u6211\u4eec\u4ec5\u5904\u7406\u5bf9\u8c61\u3002\u4e0d\u8003\u8651\u6570\u7ec4\u3001\u51fd\u6570\u3001\u7c7b\u7b49\u3002\u4f46\u662f\uff0c\u60a8\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7\u8986\u76d6\u5c3d\u53ef\u80fd\u591a\u7684\u4e0d\u540c\u6848\u4f8b\u6765\u6311\u6218\u81ea\u5df1\u3002\\n\\n\u4f8b\u5982\\n\\n  ```ts\\n  type X = {\\n    x: {\\n      a: 1\\n      b: \'hi\'\\n    }\\n    y: \'hey\'\\n  }\\n\\n  type Expected = {\\n    readonly x: {\\n      readonly a: 1\\n      readonly b: \'hi\'\\n    }\\n    readonly y: \'hey\'\\n  }\\n\\n  type Todo = DeepReadonly<X> // should be same as `Expected`\\n  ```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype DeepReadonly<T> = {\\n  readonly [P in keyof T]: keyof T[P] extends never ? T[P] : DeepReadonly<T[P]>\\n}\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u4f7f\u7528 `keyof` \u5bf9\u5bf9\u8c61\u7684\u503c\uff08`T[P]`\uff09\u8fdb\u884c\u904d\u5386\\n2. \u9012\u5f52\\n\\n</details>\\n\\n### 10. \u5143\u7ec4\u8f6c\u5408\u96c6\\n\u5b9e\u73b0\u6cdb\u578b`TupleToUnion<T>`\uff0c\u5b83\u8fd4\u56de\u5143\u7ec4\u6240\u6709\u503c\u7684\u5408\u96c6\u3002\\n\\n\u4f8b\u5982\\n\\n  ```ts\\n  type Arr = [\'1\', \'2\', \'3\']\\n\\n  type Test = TupleToUnion<Arr> // expected to be \'1\' | \'2\' | \'3\'\\n  ```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype TupleToUnion<T extends readonly unknown[]> = T[number]\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u4f7f\u7528 `readonly unknown[]` \u6765\u5b9a\u4e49\u5143\u7ec4\u7c7b\u578b\\n2. \u4f7f\u7528 `T[number]` \u6765\u904d\u5386\u5143\u7ec4\\n\\n</details>\\n\\n### 12. \u53ef\u4e32\u8054\u6784\u9020\u5668\\n\u5728 JavaScript \u4e2d\u6211\u4eec\u7ecf\u5e38\u4f1a\u4f7f\u7528\u53ef\u4e32\u8054\uff08Chainable/Pipeline\uff09\u7684\u51fd\u6570\u6784\u9020\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f46\u5728 TypeScript \u4e2d\uff0c\u4f60\u80fd\u5408\u7406\u7684\u7ed9\u5b83\u8d4b\u4e0a\u7c7b\u578b\u5417\uff1f\\n\\n\u5728\u8fd9\u4e2a\u6311\u6218\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u4f60\u559c\u6b22\u7684\u65b9\u5f0f\u5b9e\u73b0\u8fd9\u4e2a\u7c7b\u578b - Interface, Type \u6216 Class \u90fd\u884c\u3002\u4f60\u9700\u8981\u63d0\u4f9b\u4e24\u4e2a\u51fd\u6570 `option(key, value)` \u548c `get()`\u3002\u5728 `option` \u4e2d\u4f60\u9700\u8981\u4f7f\u7528\u63d0\u4f9b\u7684 key \u548c value \u6269\u5c55\u5f53\u524d\u7684\u5bf9\u8c61\u7c7b\u578b\uff0c\u901a\u8fc7 `get` \u83b7\u53d6\u6700\u7ec8\u7ed3\u679c\u3002\\n\\n\u4f8b\u5982\\n\\n  ```ts\\n  declare const config: Chainable\\n\\n  const result = config\\n    .option(\'foo\', 123)\\n    .option(\'name\', \'type-challenges\')\\n    .option(\'bar\', { value: \'Hello World\' })\\n    .get()\\n\\n  // \u671f\u671b result \u7684\u7c7b\u578b\u662f\uff1a\\n  interface Result {\\n    foo: number\\n    name: string\\n    bar: {\\n      value: string\\n    }\\n  }\\n  ```\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype Chainable<T = {}> = {\\n  option<K extends PropertyKey, V>(key: K extends keyof T\\n    ? never\\n    : K,\\n    value: V): Chainable<Omit<T, K> & { [P in K]: V }>\\n  get(): {\\n    [P in keyof T]: T[P]\\n  }\\n}\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u5b9a\u4e49\u4e00\u4e2a\u6cdb\u578b\u7c7b\u578b `T`\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u5bf9\u8c61\uff0c\u8ba9 `T` \u53ef\u4ee5\u63a5\u53d7\u4efb\u610f\u7c7b\u578b\u7684\u53c2\u6570\\n2. `K extends keyof T ? never : K` \u907f\u514d\u91cd\u590d\u7684 key\\n3. `Omit<T, K> & { [P in K]: V }` \u4f7f\u7528 `Omit` \u4ece `T` \u4e2d\u5254\u9664 `K`\uff08\u65b0\u8986\u76d6\u65e7\uff09\uff0c\u5e76\u6dfb\u52a0 `K` \u7684\u503c\u4e3a `V` \u7684\u5c5e\u6027\\n\\n</details>\\n\\n### 15. \u6700\u540e\u4e00\u4e2a\u5143\u7d20\\n\\n\u5b9e\u73b0\u4e00\u4e2a`Last<T>`\u6cdb\u578b\uff0c\u5b83\u63a5\u53d7\u4e00\u4e2a\u6570\u7ec4`T`\u5e76\u8fd4\u56de\u5176\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u7684\u7c7b\u578b\u3002\\n\\n\u4f8b\u5982\\n\\n  ```ts\\n  type arr1 = [\'a\', \'b\', \'c\']\\n  type arr2 = [3, 2, 1]\\n\\n  type tail1 = Last<arr1> // \u5e94\u63a8\u5bfc\u51fa \'c\'\\n  type tail2 = Last<arr2> // \u5e94\u63a8\u5bfc\u51fa 1\\n  ```\\n\\n<details>\\n  <summary>\u9898\u89e3</summary>\\n\\n```ts\\ntype Last<T extends any[]> = [never, ...T][T[\'length\']]\\n```\\n\u77e5\u8bc6\u70b9\uff1a\\n1. \u6dfb\u52a0\u4e00\u4e2a `never` \u7c7b\u578b\u7684\u5143\u7d20\uff0c\u8ba9 `T` \u7684\u957f\u5ea6\u4e3a `T[\'length\'] + 1`\\n2. \u4f7f\u7528 `T[\'length\']` \u6765\u83b7\u53d6\u6700\u540e\u4e00\u4e2a\u5143\u7d20\\n\\n</details>\\n\\n<comment/>"},{"id":"react-monaco-editor \u5e38\u7528\u914d\u7f6e\u9879","metadata":{"permalink":"/apaas-front-doc/blog/react-monaco-editor \u5e38\u7528\u914d\u7f6e\u9879","source":"@site/blog/2022-08-14-Monaco/index.md","title":"react-monaco-editor \u5e38\u7528\u914d\u7f6e\u9879","description":"\u57fa\u7840\u4f7f\u7528","date":"2022-08-14T00:00:00.000Z","formattedDate":"2022\u5e748\u670814\u65e5","tags":[{"label":"monaco-editor","permalink":"/apaas-front-doc/blog/tags/monaco-editor"}],"readingTime":21.94,"hasTruncateMarker":true,"authors":[{"name":"\u9ec4\u632f\u654f","title":"\u70df\u82b1\u6613\u51b7","job_no":25748,"url":"https://github.com/hzm0321","imageURL":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.92fa.com%2Fpic%2FTX1251_03.jpg&refer=http%3A%2F%2Fimg.92fa.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1670915005&t=61e1ff50cd599d4affcc74dfa4b7545d","key":"hzm"}],"frontMatter":{"slug":"react-monaco-editor \u5e38\u7528\u914d\u7f6e\u9879","title":"react-monaco-editor \u5e38\u7528\u914d\u7f6e\u9879","authors":["hzm"],"tags":["monaco-editor"]},"prevItem":{"title":"TypeScript \u7ec3\u4e60\u9898","permalink":"/apaas-front-doc/blog/TypeScript Challenge"},"nextItem":{"title":"Promise \u77e5\u8bc6\u70b9","permalink":"/apaas-front-doc/blog/Promise \u77e5\u8bc6\u70b9"}},"content":"### \u57fa\u7840\u4f7f\u7528\\n\\n```tsx\\nimport React, { useState, useCallback, useRef } from \\"react\\";\\nimport MonacoEditor from \\"react-monaco-editor\\";\\nimport * as monaco from \\"monaco-editor\\";\\n\\nconst Demo = () => {\\n  const [value, setValue] = useState(\\"\\");\\n\\n  const editorRef = useRef<monaco.editor.IStandaloneCodeEditor>(); // \u7f16\u8f91\u5668\u5b9e\u4f8b\\n  const monacoRef = useRef<typeof monaco>(); // monaco \u5b9e\u4f8b\\n  \\n  // \u83b7\u53d6\u7f16\u8f91\u5668\u5b9e\u4f8b\\n  const editorDidMountHandle = useCallback(\\n    (editor: monaco.editor.IStandaloneCodeEditor, monacoIns: typeof monaco) => {\\n      editorRef.current = editor;\\n      monacoRef.current = monacoIns;\\n    },[]);\\n\\n  return (\\n    <MonacoEditor\\n      language=\\"javascript\\"\\n      height=\\"100%\\"\\n      theme=\\"vs\\"\\n      value={value}\\n      onChange={setValue}\\n      options={{\\n        roundedSelection: false,\\n        cursorStyle: \\"line\\",\\n        wordWrap: \\"on\\",\\n      }}\\n      editorDidMount={editorDidMountHandle}\\n    />\\n  );\\n};\\n\\n```\\n`editorInstance` \u548c `monacoInstance` \u7684\u533a\u522b\uff1a\\n - `editorInstance`\uff1a\u4e3b\u8981\u4f5c\u7528\u4e8e\u7f16\u8f91\u5668\u4e0a\u64cd\u4f5c\u7684\u65b9\u6cd5\uff0c\u4f8b\u5982\u7f16\u8f91\u5668\u5199\u5165\u64cd\u4f5c\u7b49\u3002\\n - `monacoInstance`\uff1a\u4e3b\u8981\u662f\u7f16\u8f91\u5668\u8bed\u8a00\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u4f8b\u5982\u53d8\u91cf\u63d0\u793a\u3001\u9f20\u6807\u60ac\u6d6e\u63d0\u793a\u7b49\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n### \u914d\u7f6e\u9879\\n- `value`: \u7f16\u8f91\u5668\u521d\u59cb\u663e\u793a\u6587\u5b57\\n- `language`\uff1a\u8bed\u8a00\u652f\u6301\\n- dimension\uff1a\u521d\u59cb\u7f16\u8f91\u5668\u5c3a\u5bf8\\n- inDiffEditor\uff1a\u662f\u5426\u4f5c\u4e3a diff \u7f16\u8f91\u5668\u4e2d\u4f7f\u7528\\n- ariaLabel\uff1aaria-label \u9605\u8bfb\u8f85\u52a9\u6807\u7b7e\\n- rulers\uff1a\u5728\u6307\u5b9a\u7684\u5217\u4e0a\u5448\u73b0\u7ad6\u7ebf\u3002\u9ed8\u8ba4\u4e3a\u7a7a\u6570\u7ec4\\n- wordSeparators\uff1a\u5305\u542b\u5355\u8bcd\u5bfc\u822a\u65f6\u4f7f\u7528\u7684\u5355\u8bcd\u5206\u9694\u7b26\u7684\u5b57\u7b26\u4e32\u3002\u9ed8\u8ba4\u4e3a `~!@#$%^&*()-=+[{]}\\\\|;:\'\u201c,\\n- selectionClipboard\uff1a\u542f\u7528Linux\u4e3b\u526a\u8d34\u677f\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- `lineNumbers`\uff1a\u63a7\u5236\u884c\u53f7\u7684\u5448\u73b0\u3002\u5982\u679c\u5b83\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u5b83\u5c06\u5728\u5448\u73b0\u884c\u53f7\u65f6\u88ab\u8c03\u7528\uff0c\u5e76\u5c06\u5448\u73b0\u8fd4\u56de\u503c\u3002\u5426\u5219\uff0c\u5982\u679c\u4e3a\u771f\u503c\uff0c\u884c\u53f7\u5c06\u6b63\u5e38\u5448\u73b0(\u76f8\u5f53\u4e8e\u4f7f\u7528\u4e00\u4e2a\u6052\u7b49\u51fd\u6570)\u3002\u5426\u5219\uff0c\u5c06\u4e0d\u4f1a\u5448\u73b0\u884c\u53f7\u3002\u9ed8\u8ba4\u4e3a\'on\'\u3002\\n- renderFinalNewline\uff1a\u5f53\u6587\u4ef6\u4ee5\u6362\u884c\u7b26\u7ed3\u675f\u65f6\uff0c\u5448\u73b0\u6700\u540e\u4e00\u884c\u53f7\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- selectOnLineNumbers\uff1a\u5355\u51fb\u884c\u53f7\u65f6\u662f\u5426\u5e94\u9009\u62e9\u76f8\u5e94\u7684\u884c\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- lineNumbersMinChars\uff1a\u63a7\u5236\u884c\u53f7\u7684\u5b57\u7b26\u5bbd\u5ea6\u6570\u91cf, \u9ed8\u8ba4\u503c\u4e3a 5\\n- glyphMargin: \u662f\u5426\u542f\u7528\u5b57\u5f62\u8fb9\u8ddd\uff0c\u9ed8\u8ba4 false\\n- lineDecorationsWidth\uff1a\u7f16\u8f91\u5668\u8f93\u5165\u6846\u4e0e\u884c\u53f7\u4e4b\u95f4\u5bbd\u5ea6\uff0c\u9ed8\u8ba4 10\\n- revealHorizontalRightPadding\uff1a\u5f53\u663e\u793a\u6e38\u6807\u65f6\uff0c\u4f1a\u5411\u6e38\u6807\u6dfb\u52a0\u4e00\u4e2a\u865a\u62df\u586b\u5145(px)\uff0c\u5c06\u5176\u53d8\u6210\u4e00\u4e2a\u77e9\u5f62\u3002\u8fd9\u4e2a\u865a\u62df\u586b\u5145\u786e\u4fdd\u5149\u6807\u5728\u5230\u8fbe\u89c6\u53e3\u8fb9\u7f18\u4e4b\u524d\u88ab\u663e\u793a\u51fa\u6765\u3002\u9ed8\u8ba4\u503c\u4e3a30 (px)\\n- roundedSelection\uff1a\u5448\u73b0\u5e26\u6709\u5706\u89d2\u8fb9\u6846\u7684\u7f16\u8f91\u5668\u9009\u62e9\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- extraEditorClassName\uff1a\u6dfb\u52a0\u989d\u5916\u7684\u6837\u5f0f\\n- `readOnly`\uff1a\u662f\u5426\u53ea\u8bfb\\n- renderValidationDecorations\uff1a\u7f16\u8f91\u5668\u662f\u5426\u5e94\u8be5\u5448\u73b0\u9a8c\u8bc1\u88c5\u9970\u3002\u9ed8\u8ba4\u4e3a \u2018editable\u2019\u3002\\n- scrollbar\uff1a\u63a7\u5236\u6eda\u52a8\u6761\u7684\u53c2\u6570\\n- minimap\uff1a\u63a7\u5236\u7f29\u7565\u56fe\\n- find\uff1a\u63a7\u5236\u67e5\u627e\u7ec4\u4ef6\u884c\u4e3a\\n- fixedOverflowWidgets\uff1a\u5c06\u6ea2\u51fa\u5c0f\u90e8\u4ef6\u663e\u793a\u4e3a\u56fa\u5b9a\u72b6\u6001\u3002\u9ed8\u8ba4\u503c\u4e3afalse\u3002\\n- overviewRulerLanes\uff1a\u603b\u89c8\u6807\u5c3a\u5e94\u8be5\u663e\u793a\u7684\u5782\u76f4\u5217\u6570\u3002\u9ed8\u8ba4\u4e3a3\u3002\\n- overviewRulerBorder\uff1a\u63a7\u5236\u662f\u5426\u5e94\u8be5\u5728\u6982\u89c8\u6807\u5c3a\u5468\u56f4\u7ed8\u5236\u8fb9\u6846\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- cursorBlinking\uff1a\u63a7\u5236\u5149\u6807\u7684\u52a8\u753b\u6837\u5f0f\uff0c\u53ef\u80fd\u7684\u503c\u4e3a\'blink\'\uff0c \'smooth\'\uff0c \'phase\'\uff0c \'expand\'\u548c\'solid\'\u3002\u9ed8\u8ba4\u4e3a\u201cblink\u201d\u3002\\n- mouseWheelZoom\uff1a\u5f53\u4f7f\u7528\u9f20\u6807\u6eda\u8f6e\u5e76\u6309\u4f4fCtrl\u952e\u65f6\uff0c\u53ef\u4ee5\u653e\u5927\u7f16\u8f91\u5668\u4e2d\u7684\u5b57\u4f53\u3002\u9ed8\u8ba4\u503c\u4e3afalse\u3002\\n- mouseStyle\uff1a\u63a7\u5236\u9f20\u6807\u6307\u9488\u6837\u5f0f\uff0c\'text\'\u6216\'default\'\u6216\'copy\'\u9ed8\u8ba4\u4e3a\'text\'\\n- cursorSmoothCaretAnimation\uff1a\u542f\u7528\u5e73\u6ed1\u63d2\u5165\u7b26\u53f7\u52a8\u753b\u3002\u9ed8\u8ba4\u503c\u4e3afalse\u3002\\n- cursorStyle\uff1a\u5149\u6807\u6837\u5f0f\uff0c\u53ef\u9009 \'line\' | \'block\' | \'underline\' | \'line-thin\' | \'block-outline\' | \'underline-thin\' \u9ed8\u8ba4 \'line\'\\n- cursorWidth\uff1a\u5149\u6807\u5bbd\u5ea6\\n- fontLigatures\uff1a\u662f\u5426\u542f\u7528 font ligatures\uff0c\u9ed8\u8ba4 false\\n- disableLayerHinting\uff1a\u7981\u6b62\u5bf9\u7f16\u8f91\u5668\u8fb9\u8ddd\u548c\u884c\u56fe\u5c42\u4f7f\u7528\u201ctransform:translate3d\uff080px\uff0c0px\uff0c0px\uff09\u201d\u3002\u201ctransform:translate3d\uff080px\uff0c0px\uff0c0px\uff09\u201d\u7684\u7528\u6cd5\u53ef\u4ee5\u4f5c\u4e3a\u6d4f\u89c8\u5668\u521b\u5efa\u989d\u5916\u5c42\u7684\u63d0\u793a\u3002\u9ed8\u8ba4\u503c false\\n- disableMonospaceOptimizations\uff1a\u7981\u7528monospace\u5b57\u4f53\u7684\u4f18\u5316\u3002\u9ed8\u8ba4\u503c\u4e3afalse\u3002\\n- hideCursorInOverviewRuler\uff1a\u5149\u6807\u662f\u5426\u9690\u85cf\u5728\u6982\u89c8\u6807\u5c3a\u4e2d\u3002\u9ed8\u8ba4\u503c\u4e3afalse\u3002\\n- scrollBeyondLastLine\uff1a\u4f7f\u6eda\u52a8\u53ef\u4ee5\u5728\u6700\u540e\u4e00\u884c\u4e4b\u540e\u79fb\u52a8\u4e00\u4e2a\u5c4f\u5e55\u5927\u5c0f\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- scrollBeyondLastColumn\uff1a\u542f\u7528\u6eda\u52a8\u53ef\u4ee5\u8d85\u8d8a\u6700\u540e\u4e00\u5217\u7684\u591a\u4e2a\u5217\u3002\u9ed8\u8ba4\u4e3a5\u3002\\n- smoothScrolling\uff1a\u542f\u7528\u7f16\u8f91\u5668\u6eda\u52a8\u5230\u4e00\u4e2a\u4f4d\u7f6e\u7684\u52a8\u753b\u3002\u9ed8\u8ba4\u503c\u4e3afalse\u3002\\n- `automaticLayout`\uff1a\u7f16\u8f91\u5668\u5c06\u8bbe\u7f6e\u4e00\u4e2a\u95f4\u9694\u65f6\u95f4\u6765\u68c0\u67e5\u5176dom\u8282\u70b9\u5927\u5c0f\u662f\u5426\u5df2\u66f4\u6539\u3002\u542f\u7528\u6b64\u529f\u80fd\u53ef\u80fd\u4f1a\u5bf9\u6027\u80fd\u4ea7\u751f\u4e25\u91cd\u5f71\u54cd\u3002\u9ed8\u8ba4\u503c false\\n- `wordWrap`\uff1a\u8bbe\u7f6e\u7f16\u8f91\u5668\u7684\u6362\u884c.\u9ed8\u8ba4 \\"off\\".\\n- wordWrapColumn\uff1awordWrap\u8bbe\u7f6e\u4e3awordWrapColumn\u751f\u6548\uff0c\u9ed8\u8ba4\u503c 80.\\n- wordWrapMinified\uff1a\u5f53\u6587\u672c\u770b\u8d77\u6765\u662f\u4e00\u4e2a\u7f29\u5c0f/\u751f\u6210\u7684\u6587\u4ef6\u65f6\u5f3a\u5236\u6362\u884c\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- wrappingIndent\uff1a\u63a7\u5236\u6362\u884c\u884c\u7684\u7f29\u8fdb\u3002\u53ef\u4ee5\u662f:\'none\'\uff0c \'same\'\uff0c \'indent\'\u6216\'deepIndent\'\u3002\u5728vscode\u4e2d\u9ed8\u8ba4\u4e3a\'same\'\uff0c\u5728\u6469\u7eb3\u54e5\u7f16\u8f91\u5668\u4e2d\u9ed8\u8ba4\u4e3a\'none\'\\n- wrappingStrategy\uff1a\u6362\u884c\u7b56\u7565. \u9ed8\u8ba4 \'simple\'.\\n- wordWrapBreakBeforeCharacters\uff1a\u914d\u7f6e\u6362\u884c\u5b57\u7b26\u3002\u5728\u8fd9\u4e9b\u5b57\u7b26\u4e4b\u524d\u5c06\u5f15\u5165\u4e00\u4e2a\u4e2d\u65ad Defaults to \'([{\u2018\u201c\u3008\u300a\u300c\u300e\u3010\u3014\uff08\uff3b\uff5b\uff62\xa3\xa5\uff04\uffe1\uffe5+\uff0b\'\\n- wordWrapBreakAfterCharacters\uff1a\u914d\u7f6e\u6362\u884c\u5b57\u7b26\u3002\u5728\u8fd9\u4e9b\u5b57\u7b26\u4e4b\u540e\u5c06\u5f15\u5165\u4e2d\u65ad\\n- stopRenderingLineAfter\uff1a\u505c\u6b62\u6e32\u67d3x\u4e2a\u5b57\u7b26\u540e\u7684\u884c Defaults to 10000. \u4f7f\u7528-1\u6c38\u4e0d\u505c\u6b62\u6e32\u67d3\\n- hover\uff1a\u914d\u7f6e hover\\n- links\uff1a\u542f\u7528\u68c0\u6d4b\u94fe\u63a5\u5e76\u4f7f\u5176\u53ef\u5355\u51fb. \u9ed8\u8ba4 true.\\n- colorDecorators\uff1a\u542f\u7528\u5185\u8054\u989c\u8272\u88c5\u9970\u5668\u548c\u989c\u8272\u9009\u62e9\u5668\u6e32\u67d3\\n- comments\uff1a\u63a7\u5236\u7f16\u8f91\u5668\u4e2d\u7684\u6ce8\u91ca\u884c\u4e3a\\n- contextmenu\uff1a\u542f\u7528\u81ea\u5b9a\u4e49\u5feb\u6377\u83dc\u5355\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- mouseWheelScrollSensitivity\uff1a\u4e00\u4e2a\u4e58\u6570\uff0c\u7528\u4e8e\u9f20\u6807\u6eda\u8f6e\u6eda\u52a8\u4e8b\u4ef6\u7684deltaX\u548cdeltaY\u3002\u9ed8\u8ba4\u4e3a1\u3002\\n- fastScrollSensitivity\uff1a\u5f53\u6309\u4e0bAlt\u952e\u65f6\uff0cFastScrolling\u500d\u7387\u9ed8\u8ba4\u4e3a5\u3002\\n- multiCursorModifier\uff1a\u7528\u4e8e\u7528\u9f20\u6807\u6dfb\u52a0\u591a\u4e2a\u6e38\u6807\u7684\u4fee\u9970\u7b26\u3002\u9ed8\u8ba4\u4e3a\u201calt\u201d\\n- multiCursorMergeOverlapping\uff1a\u5408\u5e76\u91cd\u590d\u9009\u62e9\u3002\u9ed8\u8ba4\u503c\u4e3atrue\\n- multiCursorPaste\uff1a\u914d\u7f6e\u7c98\u8d34\u884c\u6570\u7b49\u4e8e\u6e38\u6807\u6570\u7684\u6587\u672c\u65f6\u7684\u884c\u4e3a\u3002\u9ed8\u8ba4\u4e3a\u201cspread\u201d\u3002\\n- suggest\uff1a\u63d0\u793a\u5efa\u8bae\\n- quickSuggestions\uff1a\u662f\u5426\u542f\u7528\u5feb\u901f\u5efa\u8bae\uff0c\u9ed8\u8ba4 true\\n- quickSuggestionsDelay\uff1a\u5feb\u901f\u5efa\u8bae\u5ef6\u8fdf\uff0c\u9ed8\u8ba4 10 \u6beb\u79d2\\n- parameterHints\uff1a\u53c2\u6570\u63d0\u793a\u9009\u9879\u3002\\n- autoClosingBrackets\uff1a\u81ea\u52a8\u5173\u95ed\u62ec\u53f7\u7684\u9009\u9879\u3002\u9ed8\u8ba4\u4e3a\u8bed\u8a00\u5b9a\u4e49\u7684\u884c\u4e3a\u3002\\n- formatOnType\uff1a\u5728\u7c7b\u578b\u4e0a\u542f\u7528\u683c\u5f0f\u3002\u9ed8\u8ba4\u503c\u4e3afalse\u3002\\n- formatOnPaste\uff1a\u542f\u7528\u7c98\u8d34\u683c\u5f0f\u3002\u9ed8\u8ba4\u503c\u4e3afalse\u3002\\n- dragAndDrop\uff1a\u63a7\u5236\u7f16\u8f91\u5668\u662f\u5426\u5141\u8bb8\u901a\u8fc7\u62d6\u653e\u79fb\u52a8\u9009\u62e9\u9879\u3002\u9ed8\u8ba4\u503c\u4e3afalse\u3002\\n- suggestOnTriggerCharacters\uff1a\u542f\u7528\u5efa\u8bae\u6846\u5728\u89e6\u53d1\u5b57\u7b26\u65f6\u5f39\u51fa\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- acceptSuggestionOnEnter\uff1a\u6309\u4e0b\u56de\u8f66\u63a5\u53d7\u5efa\u8bae\uff0c \u9ed8\u8ba4 \'on\'\\n- acceptSuggestionOnCommitCharacter\uff1a\u63a5\u53d7\u8bed\u8a00\u63d0\u4f9b\u7684\u5b9a\u4e49\u5b57\u7b26\u7684\u5efa\u8bae\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- snippetSuggestions\uff1a\u4f7f\u4ee3\u7801\u7247\u6bb5\u7684\u5efa\u8bae\u3002\u9ed8\u8ba4\u4e3atrue\u3002\\n- emptySelectionClipboard\uff1a\u4e0d\u5e26\u9009\u5b9a\u9879\u7684\u590d\u5236\u590d\u5236\u5f53\u524d\u884c\u3002\\n- copyWithSyntaxHighlighting\uff1a\u590d\u5236\u8bed\u6cd5\u9ad8\u4eae\u663e\u793a\u3002\\n- suggestSelection\uff1a\u5386\u53f2\u6a21\u5f0f\u5efa\u8bae\u3002\\n- suggestFontSize\uff1a\u5efa\u8bae\u5b57\u4f53\u5927\u5c0f\\n- suggestLineHeight\uff1a\u5efa\u8bae\u6587\u5b57\u884c\u9ad8\\n- tabCompletion\uff1a\u542f\u7528\u9009\u9879\u5361\\n- selectionHighlight\uff1a\u4f7f\u9009\u62e9\u7a81\u51fa\u663e\u793a\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- occurrencesHighlight\uff1a\u542f\u7528\u8bed\u4e49\u7a81\u51fa\u663e\u793a\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- codeLens\uff1a\u663e\u793acode len\u9ed8\u8ba4\u4e3a true\u3002\\n- lightbulb\uff1a\u63a7\u5236\u4ee3\u7801\u52a8\u4f5c\u706f\u6ce1\u7684\u884c\u4e3a\u548c\u5448\u73b0\u3002\\n- codeActionsOnSaveTimeout\uff1a\u4fdd\u5b58\u65f6\u8fd0\u884c\u4ee3\u7801\u64cd\u4f5c\u7684 time\u3002\\n- folding\uff1a\u652f\u6301\u4ee3\u7801\u6298\u53e0\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- foldingStrategy\uff1a\u9009\u62e9\u6298\u53e0\u7b56\u7565\u3002\'auto\'\u4f7f\u7528\u4e3a\u5f53\u524d\u6587\u6863\u63d0\u4f9b\u7684\u7b56\u7565\uff0c\'indentation\'\u4f7f\u7528\u57fa\u4e8e\u7f29\u8fdb\u7684\u6298\u53e0\u7b56\u7565\u3002\u9ed8\u8ba4\u4e3a\u201cauto\u201d\u3002\\n- foldingHighlight\uff1a\u5bf9\u6298\u53e0\u533a\u57df\u542f\u7528\u9ad8\u4eae\u663e\u793a\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- showFoldingControls\uff1a\u63a7\u5236\u8fb9\u680f\u4e2d\u7684\u6298\u53e0\u64cd\u4f5c\u662f\u59cb\u7ec8\u53ef\u89c1\u8fd8\u662f\u9690\u85cf\uff0c\u9664\u975e\u9f20\u6807\u5728\u8fb9\u680f\u4e0a\u65b9\u3002\u9ed8\u8ba4\u4e3a\u201cmouseover\u201d\u3002\\n- matchBrackets\uff1a\u542f\u7528\u5339\u914d\u65b9\u62ec\u53f7\u7684\u9ad8\u4eae\u663e\u793a\u3002\u9ed8\u8ba4\u4e3a\u201calways\u201d\u3002\\n- renderWhitespace\uff1a\u542f\u7528\u7a7a\u767d\u7684\u5448\u73b0\u3002\u9ed8\u8ba4\u4e3a none\u3002\\n- renderControlCharacters\uff1a\u542f\u7528\u63a7\u5236\u5b57\u7b26\u7684\u5448\u73b0\u3002\u9ed8\u8ba4\u503c\u4e3afalse\u3002\\n- renderIndentGuides\uff1a\u542f\u7528\u7f29\u8fdb\u7ebf\u7684\u5448\u73b0\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- highlightActiveIndentGuide\uff1a\u542f\u7528\u7a81\u51fa\u663e\u793a\u6d3b\u52a8\u7f29\u8fdb\u6307\u5357\u3002\u9ed8\u8ba4\u503c\u4e3atrue\u3002\\n- renderLineHighlight\uff1a\u542f\u7528\u5f53\u524d\u884c\u9ad8\u4eae\u663e\u793a\u3002\u9ed8\u8ba4\u4e3a all\u3002\\n- useTabStops\uff1a\u662f\u5426\u5728\u5236\u8868\u4f4d\u4e4b\u540e\u63d2\u5165\u548c\u5220\u9664\u7a7a\u683c\u3002\\n- fontFamily\uff1a\u5b57\u4f53\\n- fontWeight\uff1a\u5b57\u4f53\u5bbd\u5ea6\\n- fontSize\uff1a\u5b57\u4f53\u5927\u5c0f\\n- lineHeight\uff1a \u884c\u9ad8\\n- letterSpacing\uff1a\u5b57\u95f4\u8ddd\\n\\n### \u63d2\u5165\u5185\u5bb9\\n\u65b9\u5f0f\u4e00\uff1a\u6a21\u62df\u952e\u76d8\u8f93\u5165\u4ece\u5149\u6807\u540e\u63d2\u5165  \\n```tsx\\nconst str = \'\u5f85\u63d2\u5165\u7684\u5185\u5bb9\'\\neditorInstance?.trigger(\'keyboard\', \'type\', { text: str });\\n```\\n\u65b9\u5f0f\u4e8c\uff1a\u76f4\u63a5\u4ece\u5149\u6807\u5904\u63d2\u5165\u5185\u5bb9\\n```tsx\\n// \u5feb\u901f\u63d2\u5165\\nconst code = \'\u5f85\u63d2\u5165\u7684\u5185\u5bb9\'\\nconst position = editorInstance?.getPosition();\\nconst selection = editorInstance?.getSelection();\\neditorInstance?.executeEdits(\'\', [\\n  {\\n    range: {\\n      startLineNumber: position?.lineNumber || 0,\\n      startColumn: position?.column || 0,\\n      endLineNumber: selection?.endLineNumber || position?.lineNumber || 0,\\n      endColumn: selection?.endColumn || position?.column || 0,\\n    } as any,\\n    text: code,\\n  },\\n]);\\n```\\n### \u4ee3\u7801\u683c\u5f0f\u5316\\n```tsx\\n// \u683c\u5f0f\u5316\\nawait editorInstance?.getAction(\'editor.action.formatDocument\').run();\\n```\\n\\n### \u53d8\u91cf\u63d0\u793a\\n```tsx\\nimport React, { useState, useCallback, useRef, useEffect } from \\"react\\";\\nimport MonacoEditor from \\"react-monaco-editor\\";\\nimport * as monaco from \\"monaco-editor\\";\\n\\nconst Demo = () => {\\n  const [value, setValue] = useState(\\"\\");\\n\\n  const editorRef = useRef<monaco.editor.IStandaloneCodeEditor>(); // \u7f16\u8f91\u5668\u5b9e\u4f8b\\n  const monacoRef = useRef<typeof monaco>(); // monaco \u5b9e\u4f8b\\n  const monacoHoverProviderRef = useRef<monaco.IDisposable>(); // monaco \u6ce8\u518c\u7f13\u5b58\\n  const monacoCompletionItemProviderRef = useRef<monaco.IDisposable>(); // monaco \u6ce8\u518c\u7f13\u5b58\\n\\n  useEffect(() => {\\n    // \u4e3a\u7f16\u8f91\u5668\u6ce8\u5165\u53d8\u91cf\u63d0\u793a\\n    monacoCompletionItemProviderRef.current =\\n      monacoRef.current?.languages.registerCompletionItemProvider(\\n        \\"javascript\\",\\n        {\\n          provideCompletionItems: (model, position) => {\\n            // \u53ea\u5bf9\u5f53\u524d\u7f16\u8f91\u5668\u5b9e\u4f8b\u8fdb\u884c\u5904\u7406\\n            if (model.uri.toString() === editorRef.current?.getModel()?.uri.toString()) {\\n              // \u81ea\u5b9a\u4e49\u53d8\u91cf\u63d0\u793a\u89c4\u5219\\n              return {\\n                suggestions,\\n              };\\n            }\\n          },\\n          triggerCharacters: [\\".\\"],\\n        }\\n      );\\n    // \u9f20\u6807\u60ac\u6d6e\u63d0\u793a\\n    monacoHoverProviderRef.current = monaco.languages.registerHoverProvider(\\n      \\"javascript\\",\\n      {\\n        provideHover: (model, position) => {\\n          // \u53ea\u5bf9\u5f53\u524d\u7f16\u8f91\u5668\u5b9e\u4f8b\u8fdb\u884c\u5904\u7406\\n          if (model.uri.toString() !== editorRef.current?.getModel()?.uri.toString()) {\\n            // \u81ea\u5b9a\u4e49\u53d8\u91cf\u63d0\u793a\u89c4\u5219\\n            return {\\n              contents,\\n            };\\n          }\\n        },\\n      }\\n    );\\n\\n    return () => {\\n      // \u9000\u51fa\u65f6,\u9500\u6bc1\u6ce8\u518c\u7684\u5185\u5bb9\u907f\u514d\u91cd\u590d\u521b\u5efa\\n      monacoCompletionItemProviderRef.current?.dispose();\\n      monacoHoverProviderRef.current?.dispose();\\n    };\\n  }, []);\\n\\n  // \u83b7\u53d6\u7f16\u8f91\u5668\u5b9e\u4f8b\\n  const editorDidMountHandle = useCallback(\\n    (editor: monaco.editor.IStandaloneCodeEditor, monacoIns: typeof monaco) => {\\n      editorRef.current = editor;\\n      monacoRef.current = monacoIns;\\n    },\\n    []\\n  );\\n\\n  return (\\n    <MonacoEditor\\n      language=\\"javascript\\"\\n      height=\\"100%\\"\\n      theme=\\"vs\\"\\n      value={value}\\n      onChange={setValue}\\n      options={{\\n        roundedSelection: false,\\n        cursorStyle: \\"line\\",\\n        automaticLayout: true,\\n        selectOnLineNumbers: true,\\n        wordWrap: \\"on\\",\\n      }}\\n      editorDidMount={editorDidMountHandle}\\n    />\\n  );\\n};\\n```\\n\u4e3a\u4e86\u907f\u514d\u53d8\u91cf\u88ab\u91cd\u590d\u6ce8\u518c\uff0c\u56e0\u6b64\u9700\u8981 `ref` \u5b58\u4e00\u4e0b\u53d8\u91cf\u63d0\u793a\u5b9e\u4f8b\uff0c\u5728\u9500\u6bc1\u9636\u6bb5\u6ce8\u9500\u53d8\u91cf\u6ce8\u518c\u3002  \\n\\n\u4e3a\u4e86\u4fbf\u4e8e\u52a8\u6001\u53d8\u91cf\u89c4\u5219\u7684\u4f7f\u7528\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7684\u7c7b\uff0c\u7528\u4e8e\u8ba1\u7b97\u53d8\u91cf\u5c42\u7ea7\u63d0\u793a\u3002\\n\\n```tsx\\nimport { isArray } from \'lodash\';\\nimport * as monaco from \'monaco-editor\';\\n\\nimport {\\n  FormatFunctionProps,\\n  InsertFunctionProps,\\n} from \'@/routes/ScriptEvent/EditPage/types/function\';\\n\\ninterface MonacoVariableTipsProps {\\n  variableData: FormatFunctionProps[];\\n  level: number;\\n}\\n\\ninterface TipProps {\\n  word: string;\\n  remark?: string;\\n}\\n\\nexport class MonacoVariableTips {\\n  // \u5f53\u524d\u884c\u8f93\u5165\u7684\u8fde\u7eed\u5185\u5bb9\\n  content: string | undefined;\\n\\n  // \u5f53\u524d\u884c\u8f93\u5165\u7684\u5185\u5bb9\\n  lineContent: string | undefined;\\n\\n  // \u521a\u8f93\u5165\u7684\u5185\u5bb9\\n  input: string | undefined;\\n\\n  // \u5f53\u524d\u884c\u8f93\u5165\u7684\u5355\u8bcd\\n  word: string | undefined;\\n\\n  private model: monaco.editor.ITextModel | undefined;\\n\\n  private position: monaco.Position | undefined;\\n\\n  // \u8981\u63d0\u793a\u7684\u5c42\u7ea7\uff0c \u9ed8\u8ba4\u63d0\u793a\u4e0b\u4e00\u5c42\\n  private readonly level: number;\\n\\n  // \u5b8c\u6574\u7684\u53d8\u91cf\u6570\u636e\\n  private readonly variableData: FormatFunctionProps[];\\n\\n  /**\\n   * \u4e3a monaco \u7f16\u8f91\u5668\u6dfb\u52a0\u53d8\u91cf\u63d0\u793a\\n   * @param props\\n   */\\n  constructor(props: MonacoVariableTipsProps) {\\n    this.level = props.level || 1;\\n    this.variableData = props.variableData;\\n  }\\n\\n  /**\\n   * \u662f\u5426\u7531 . \u89e6\u53d1\\n   */\\n  get isDotTrigger() {\\n    return this.input === \'.\';\\n  }\\n\\n  /**\\n   * \u89e3\u6790\u5f53\u524d\u884c\\n   */\\n  parseContinuousContent(model: monaco.editor.ITextModel, position: monaco.Position) {\\n    if (!position || !model) {\\n      throw new Error(\'position | model is undefined\');\\n    }\\n    this.model = model;\\n    this.position = position;\\n    const { column, lineNumber } = this.position;\\n    this.lineContent = this.model.getLineContent(lineNumber);\\n    this.content =\\n      this.lineContent\\n        .slice(0, column - 1)\\n        .split(\' \')\\n        .pop() || \'\';\\n    this.input = this.lineContent[column - 2];\\n    this.word = this.model.getWordAtPosition(position)?.word;\\n  }\\n\\n  /**\\n   * \u89e3\u6790\u5185\u5bb9\u4e3a\u53d8\u91cf\u5c42\u7ea7\\n   * @param str\\n   * @param isFlat \u662f\u5426\u6253\u5e73\u4e3a\u4e00\u7ef4\u5b57\u7b26\u4e32\u6570\u7ec4\\n   */\\n  static analysisWords(str: string = \'\', isFlat?: boolean) {\\n    // \u628a ... \u66ff\u6362\u6210 ***\\n    const _str = str.replace(/\\\\.\\\\.\\\\./g, \'***\');\\n    const res = _str\\n      .split(\'.\')\\n      .filter(Boolean)\\n      .map((v) => {\\n        return {\\n          word: v.replace(/\\\\*\\\\*\\\\*/g, \'...\'),\\n          match: v.match(/^\\\\w*/g)?.join(\'\')!,\\n        };\\n      });\\n    if (isFlat) {\\n      return res.map((v) => v.match);\\n    }\\n    return res;\\n  }\\n\\n  /**\\n   * \u6839\u636e\u8f93\u5165\u5728\u53d8\u91cf\u5339\u914d tree \u4e2d\u641c\u7d22\u547d\u4e2d\u7684\u5c42\u7ea7\\n   * @param inputWords\\n   */\\n  searchFunctionsVariable(inputWords: string[]) {\\n    let res: FormatFunctionProps[] = [];\\n    let target: FormatFunctionProps | undefined;\\n    inputWords.forEach((word, index) => {\\n      if (!target) {\\n        target = this.variableData.find((v) => v.match.startsWith(word));\\n        if (target && inputWords.length === index + 1) {\\n          // \u6700\u540e\u4e00\u5c42\\n          res = [target];\\n        }\\n      } else if (inputWords.length === index + 1) {\\n        // \u8868\u793a\u5df2\u7ecf\u5230\u76ee\u6807\u6700\u540e\u4e00\u5c42\uff0c\u8fdb\u884c\u6a21\u7cca\u641c\u7d22\\n        const r = target.children.filter((v) => v.match.startsWith(word));\\n        res = r;\\n      } else {\\n        target = target.children.find((v) => v.match.startsWith(word));\\n      }\\n    });\\n\\n    return res;\\n  }\\n\\n  /**\\n   * \u6df1\u641c\u7ed3\u679c\uff0c\u62c9\u5e73\u6210\u4e00\u7ef4\u6570\u7ec4\\n   * @param searchResult\\n   * @param isDotTrigger\\n   * @param inputLength\\n   */\\n  dfsSearchResult(searchResult: FormatFunctionProps[], isDotTrigger: boolean, inputLength: number) {\\n    const tips: TipProps[] = [];\\n    const { level } = this;\\n\\n    const clearStartDot = (word: string = \'\') => {\\n      if (word.startsWith(\'.\')) {\\n        return word.substring(1);\\n      }\\n      return word;\\n    };\\n    dfs(searchResult, { word: \'\' }, 0, {});\\n\\n    function dfs(curSearchResult, curTip, curLevel, parentSearchResult) {\\n      // \u8fb9\u754c\\n      if (!curSearchResult || curSearchResult.length === 0 || curLevel > level) {\\n        if (isDotTrigger) {\\n          if (curLevel === level) {\\n            // eslint-disable-next-line no-param-reassign\\n            curTip.word = curTip.word.substring(parentSearchResult.parentWord.length + 1);\\n          } else if (curLevel > level) {\\n            // eslint-disable-next-line no-param-reassign\\n            curTip.word = curTip.word.substring(inputLength + 1);\\n          }\\n        }\\n        // eslint-disable-next-line no-param-reassign\\n        curTip.word = clearStartDot(curTip.word);\\n        if (curTip.word) {\\n          tips.push(curTip);\\n        }\\n        return;\\n      }\\n\\n      // \u6dfb\u52a0\u7236\u7ea7\u6570\u636e\\n      if (curLevel > 0) {\\n        const _tip = { ...curTip };\\n        if (!isDotTrigger) {\\n          _tip.word = clearStartDot(_tip.word);\\n          if (_tip.word) {\\n            tips.push(_tip);\\n          }\\n        }\\n      }\\n\\n      // \u5982\u679c\u8fd8\u6ca1\u5230\u5c42\u7ea7\u7ee7\u7eed\u5f80\u4e0b\u8d70\\n      curSearchResult.forEach((item) => {\\n        dfs(\\n          item.children,\\n          {\\n            ...curTip,\\n            word: `${curTip.word}.${item.word}`,\\n            remark: item.remark || curTip.remark,\\n          },\\n          curLevel + 1,\\n          item\\n        );\\n      });\\n    }\\n\\n    return tips;\\n  }\\n\\n  /**\\n   * \u751f\u6210\u63d0\u793a\\n   * @param tips\\n   */\\n  generateSuggestions(tips: TipProps[]) {\\n    return tips.map((item) => ({\\n      label: item.word,\\n      kind: monaco.languages.CompletionItemKind.Function,\\n      insertText: item.word,\\n      documentation: item.remark,\\n      detail: item.remark,\\n      // range: {\\n      //   startLineNumber: 1,\\n      // },\\n    }));\\n  }\\n\\n  /**\\n   * \u751f\u6210\u60ac\u6d6e\u63d0\u793a\u6570\u636e\u683c\u5f0f\\n   * @param hoverTips\\n   */\\n  generateHover(hoverTips: FormatFunctionProps[]) {\\n    return hoverTips.map((item) => ({\\n      value: item.remark || \'\',\\n      isTrusted: true,\\n      supportThemeIcons: true,\\n    }));\\n  }\\n\\n  getSuggestions() {\\n    const words = MonacoVariableTips.analysisWords(this.content, true) as string[];\\n    const searchResult = this.searchFunctionsVariable(words);\\n    const inputLength = words.join(\'\').length;\\n    const tips = this.dfsSearchResult(searchResult, this.isDotTrigger, inputLength);\\n    const suggestions = this.generateSuggestions(tips);\\n    return suggestions;\\n  }\\n\\n  getHover() {\\n    const words = MonacoVariableTips.analysisWords(this.content, true) as string[];\\n    if (isArray(words) && words.length > 0) {\\n      words[words.length - 1] = this.word!;\\n    }\\n    const hoverTips = this.searchFunctionsVariable(words);\\n    const hovers = this.generateHover(hoverTips);\\n    return hovers;\\n  }\\n}\\n```\\n\u76f8\u5173\u7c7b\u578b\u6587\u4ef6\\n```ts\\nexport interface FormatFunctionProps {\\n  word: string;\\n  match: string;\\n  children: FormatFunctionProps[];\\n  remark?: string;\\n  parentWord?: string;\\n}\\n```\\n\\n\\n\u4ec5\u9700\u6309\u7167 `FormatFunctionProps[]` \u7c7b\u578b\u4f20\u5165\u53d8\u91cf\u89c4\u5219\u5373\u53ef\uff0c\u5177\u4f53\u89c1\u9879\u76ee\u6587\u4ef6\u3002\\n\\n```tsx\\nuseEffect(() => {\\n  if (!isEmpty(variableData)) {\\n    const monacoVariableTips = new MonacoVariableTips({ variableData, level: 2 });\\n    // \u4e3a\u7f16\u8f91\u5668\u6ce8\u5165\u53d8\u91cf\u63d0\u793a\\n    monacoCompletionItemProviderRef.current = monacoRef.current?.languages.registerCompletionItemProvider(\\n      \'javascript\',\\n      {\\n        provideCompletionItems: (model, position) => {\\n          // \u53ea\u5bf9\u5f53\u524d\u7f16\u8f91\u5668\u5b9e\u4f8b\u8fdb\u884c\u5904\u7406\\n          if (model.uri.toString() !== editorRef.current?.getModel()?.uri.toString()) {\\n            monacoVariableTips.parseContinuousContent(model, position);\\n            return {\\n              suggestions: monacoVariableTips.getSuggestions() as any,\\n            };\\n          }\\n        },\\n        triggerCharacters: [\'.\'],\\n      }\\n    );\\n    // \u9f20\u6807\u60ac\u6d6e\u63d0\u793a\\n    monacoHoverProviderRef.current = monaco.languages.registerHoverProvider(\'javascript\', {\\n      provideHover: (model, position) => {\\n        // \u53ea\u5bf9\u5f53\u524d\u7f16\u8f91\u5668\u5b9e\u4f8b\u8fdb\u884c\u5904\u7406\\n        if (model.uri.toString() !== editorRef.current?.getModel()?.uri.toString()) {\\n          monacoVariableTips.parseContinuousContent(model, position);\\n          return {\\n            contents: monacoVariableTips.getHover(),\\n          };\\n        }\\n      },\\n    });\\n  }\\n  return () => {\\n    // \u9000\u51fa\u65f6,\u9500\u6bc1\u6ce8\u518c\u7684\u5185\u5bb9\u907f\u514d\u91cd\u590d\u521b\u5efa\\n    monacoCompletionItemProviderRef.current?.dispose();\\n    monacoHoverProviderRef.current?.dispose();\\n  };\\n}, [variableData]);\\n```\\n\\n### \u64a4\u9500/\u91cd\u505a\\n\\n```tsx\\n// \u64a4\u9500\\neditorInstance.trigger(\'keyboard\', \'undo\', null);\\n// \u91cd\u505a\\neditorInstance.trigger(\'keyboard\', \'redo\', null);\\n```\\n\\n### \u6c49\u5316\\n\\n\u5b89\u88c5 webpack \u63d2\u4ef6 `monaco-editor-chinese-plugin`\uff0c\u5e76\u5728 `config/config.ts` \u4e2d\u914d\u7f6e\\n\\n```ts\\nconst MonacoWebpackPlugin = require(\'monaco-editor-webpack-plugin\');\\n// This will right\\nconst MonacoChinesePlugin = require(\'monaco-editor-chinese-plugin\');\\n\\nconst config: IConfig = {\\n  chainWebpack: (c) => {\\n    c.plugin(\'monaco-editor-webpack-plugin\').use(new MonacoWebpackPlugin({\\n      languages: [\'javascript\', \'typescript\', \'sql\', \'json\'],\\n    }));\\n    // This will right\\n    c.plugin(\'monaco-editor-chinese-plugin\').use(new MonacoChinesePlugin());\\n    // ......\\n  },\\n  // \u5176\u4f59\u914d\u7f6e ......\\n};\\nexport default config;\\n```\\n\\n### \u65ad\u70b9\u8c03\u8bd5\u6548\u679c\\n<div align=\\"center\\">\\n    <img src={require(\'./assets/debugger.png\').default} alt=\\"node\\" width=\\"100%\\" />\\n</div>\\n\\n\u5b9e\u73b0\u4e00\u4e2a\u80fd\u5c55\u793a\u65ad\u70b9\u8c03\u8bd5\u6548\u679c\u7684\u7f16\u8f91\u5668\u3002\\n\\n\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\nindex.jsx\\n```tsx\\nimport React, { useCallback, useEffect, useRef } from \'react\';\\nimport MonacoEditor from \'react-monaco-editor\';\\nimport { MonacoEditorProps } from \'react-monaco-editor/src/types\';\\nimport * as monaco from \'monaco-editor\';\\nimport { isNumber, uniqWith } from \'lodash\';\\n\\nimport \'./editor.css\';\\n\\ninterface Props extends MonacoEditorProps {\\n  breakPoints: monaco.editor.IModelDeltaDecoration[]; // \u65ad\u70b9\u6807\u8bb0\\n  onBreakPointsChange?: (breakPoints: monaco.editor.IModelDeltaDecoration[]) => void;\\n  onBreakPointsDataChange?: () => void; // \u65ad\u70b9\u6570\u636e\u53d1\u751f\u4e86\u53d8\u5316\\n  stopBreakpoint?: number; // \u5f53\u524d\u65ad\u70b9\u505c\u5728\u54ea\u4e00\u884c\\n}\\n\\n/**\\n * \u57fa\u4e8e monaco-editor \u7684\u8bbe\u8ba1\u7684\u8c03\u8bd5\u7f16\u8f91\u5668\\n * @constructor\\n */\\nconst MonacoDebugger: React.FC<Props> = ({\\n  editorDidMount,\\n  onBreakPointsChange,\\n  onBreakPointsDataChange,\\n  breakPoints,\\n  stopBreakpoint,\\n  ...props\\n}) => {\\n  const editorRef = useRef<monaco.editor.IStandaloneCodeEditor>(); // \u7f16\u8f91\u5668\u5b9e\u4f8b\\n  const monacoRef = useRef<typeof monaco>(); // monaco \u5b9e\u4f8b\\n  const decorationsRef = useRef<string[] | null>([]); // \u88c5\u9970\u5668\u7f13\u5b58\\n\\n  const stopBreakpointRef = useRef<number | undefined>(stopBreakpoint); // \u5f53\u524d\u65ad\u70b9\u505c\u5728\u54ea\u4e00\u884c\\n\\n  useEffect(() => {\\n    stopBreakpointRef.current = stopBreakpoint;\\n    setCurrentBreakPoint(stopBreakpoint);\\n  }, [stopBreakpoint]);\\n\\n  useEffect(() => {\\n    const model = editorRef.current?.getModel();\\n    if (model) {\\n      model.deltaDecorations([], breakPoints);\\n    }\\n  }, [breakPoints]);\\n\\n  useEffect(() => {\\n    // \u7f16\u8f91\u5668\u9f20\u6807\u79fb\u52a8\u4e8b\u4ef6\\n    editorRef.current?.onMouseMove((e) => {\\n      if (\\n        e.target.detail &&\\n        e.target.detail.offsetX &&\\n        e.target.detail.offsetX >= 0 &&\\n        e.target.detail.offsetX <= 50\\n      ) {\\n        const line = e.target.position?.lineNumber;\\n        addFakeBreakPoint(line);\\n      } else {\\n        removeFakeBreakPoint();\\n      }\\n    });\\n\\n    // \u7f16\u8f91\u5668\u9f20\u6807\u79bb\u5f00\u4e8b\u4ef6\\n    editorRef.current?.onMouseLeave(() => {\\n      removeFakeBreakPoint();\\n    });\\n\\n    // \u7f16\u8f91\u5668\u9f20\u6807\u70b9\u51fb\u4e8b\u4ef6\\n    editorRef.current?.onMouseDown((e) => {\\n      if (\\n        e.target.detail &&\\n        e.target.detail.offsetX &&\\n        e.target.detail.offsetX >= 0 &&\\n        e.target.detail.offsetX <= 50\\n      ) {\\n        const line = e.target.position?.lineNumber || 0;\\n        let isChangeFlag = false;\\n\\n        if (!hasBreakPoint(line)) {\\n          if (editorRef.current?.getModel()?.getLineContent(line).trim() !== \'\') {\\n            addBreakPoint(line);\\n            isChangeFlag = true;\\n          }\\n        } else {\\n          removeBreakPoint(line);\\n          isChangeFlag = true;\\n        }\\n\\n        if (isChangeFlag) {\\n          onBreakPointsDataChange?.();\\n        }\\n      }\\n    });\\n  }, []);\\n\\n  // \u8bbe\u7f6e\u5f53\u524d\u65ad\u70b9\u505c\u5728\u54ea\u4e00\u884c\\n  const setCurrentBreakPoint = (line?: number) => {\\n    const allDecorations = editorRef.current?.getModel()?.getAllDecorations();\\n    // \u53d6\u6d88\u884c\u4e0a\u7684\u88c5\u9970\u5668\\n    const cancelLinesClassName = () => {\\n      if (!allDecorations) return;\\n      const lineBgDecorations = allDecorations.filter((v) => v.options.className);\\n      const lineBgIds = lineBgDecorations.map((v) => v.id);\\n      editorRef.current?.deltaDecorations(lineBgIds, []);\\n    };\\n    if (isNumber(line)) {\\n      cancelLinesClassName();\\n      // \u6dfb\u52a0\u65ad\u70b9\u884c\u88c5\u9970\u5668\\n      const curLineDecoration = {\\n        range: new monacoRef.current!.Range(line, 1, line, 1),\\n        options: {\\n          isWholeLine: true,\\n          className: \'breakpoints-line\',\\n        },\\n      };\\n      editorRef.current?.deltaDecorations([], [curLineDecoration]);\\n    } else {\\n      cancelLinesClassName();\\n    }\\n  };\\n\\n  const handleDeltaDecorationsUpdate = useCallback(() => {\\n    const model = editorRef.current?.getModel();\\n    if (model) {\\n      let _breakPoints = model\\n        .getAllDecorations()\\n        .filter((decoration) => decoration.options.linesDecorationsClassName === \'breakpoints\')\\n        .map((v) => ({ range: v.range, options: v.options }));\\n      _breakPoints = uniqWith(_breakPoints, (arrVal, othVal) => {\\n        return arrVal.range.startLineNumber === othVal.range.startLineNumber;\\n      });\\n      onBreakPointsChange?.(_breakPoints);\\n    }\\n  }, []);\\n\\n  // \u8be5\u4f4d\u7f6e\u4e0a\u662f\u5426\u5df2\u7ecf\u5b58\u5728\u65ad\u70b9\\n  const hasBreakPoint = useCallback((line) => {\\n    const decorations = editorRef.current?.getLineDecorations(line);\\n    if (decorations?.length) {\\n      for (const decoration of decorations) {\\n        if (decoration.options.linesDecorationsClassName === \'breakpoints\') {\\n          return true;\\n        }\\n      }\\n    }\\n    return false;\\n  }, []);\\n\\n  // \u6dfb\u52a0\u63d0\u793a\u65ad\u70b9\\n  const addFakeBreakPoint = useCallback((line) => {\\n    const fakeBreakPointValue = {\\n      range: new monacoRef.current!.Range(line, 1, line, 1),\\n      options: {\\n        isWholeLine: true,\\n        linesDecorationsClassName: \'breakpoints-fake\',\\n      },\\n    };\\n    if (decorationsRef.current) {\\n      decorationsRef.current =\\n        editorRef.current?.deltaDecorations(decorationsRef.current, [fakeBreakPointValue]) || [];\\n    }\\n  }, []);\\n\\n  // \u5220\u9664\u63d0\u793a\u65ad\u70b9\\n  const removeFakeBreakPoint = useCallback(() => {\\n    if (decorationsRef.current) {\\n      decorationsRef.current =\\n        editorRef.current?.deltaDecorations(decorationsRef.current, []) || [];\\n    }\\n  }, []);\\n\\n  // \u6dfb\u52a0\u65ad\u70b9\\n  const addBreakPoint = useCallback((line) => {\\n    const model = editorRef.current?.getModel();\\n    if (!model) return;\\n    if (monacoRef.current) {\\n      const breakPointValue = {\\n        range: new monacoRef.current.Range(line, 1, line, 1),\\n        options: {\\n          isWholeLine: true,\\n          linesDecorationsClassName: \'breakpoints\',\\n        },\\n      };\\n      model.deltaDecorations([], [breakPointValue]);\\n      handleDeltaDecorationsUpdate();\\n    }\\n  }, []);\\n\\n  // \u5220\u9664\u65ad\u70b9\\n  const removeBreakPoint = useCallback((line) => {\\n    if (editorRef.current) {\\n      const model = editorRef.current?.getModel();\\n      if (!model) return;\\n      let decorations;\\n      const ids: string[] = [];\\n      if (line !== undefined) {\\n        decorations = editorRef.current.getLineDecorations(line);\\n      } else {\\n        decorations = editorRef.current.getModel()?.getAllDecorations();\\n      }\\n      for (const decoration of decorations) {\\n        if (decoration.options.linesDecorationsClassName === \'breakpoints\') {\\n          ids.push(decoration.id);\\n        }\\n      }\\n      if (ids?.length) {\\n        model.deltaDecorations(ids, []);\\n      }\\n      handleDeltaDecorationsUpdate();\\n    }\\n  }, []);\\n\\n  // \u83b7\u53d6\u7f16\u8f91\u5668\u5b9e\u4f8b\\n  const editorDidMountHandle = useCallback(\\n    (editor: monaco.editor.IStandaloneCodeEditor, monacoIns: typeof monaco) => {\\n      editorRef.current = editor;\\n      monacoRef.current = monacoIns;\\n      editorDidMount?.(editor, monacoIns);\\n    },\\n    []\\n  );\\n\\n  return <MonacoEditor editorDidMount={editorDidMountHandle} {...props} />;\\n};\\n\\nexport default MonacoDebugger;\\n\\n```\\neditor.css \u6587\u4ef6\\n\\n```css\\n.breakpoints-fake {\\n  width: 18px !important;\\n  height: 18px !important;\\n  left: 0 !important;\\n  top: 0 !important;\\n  cursor: pointer !important;\\n}\\n\\n.breakpoints-fake::after {\\n  content: \'\';\\n  position: absolute;\\n  width: 10px;\\n  height: 10px;\\n  left: 50%;\\n  top: 50%;\\n  transform: translate(-50%, -50%);\\n  border-radius: 50%;\\n  background: #F23A50;\\n  opacity: 0.5;\\n  cursor: pointer;\\n}\\n\\n.breakpoints {\\n  width: 10px !important;\\n  height: 10px !important;\\n  left: 9px !important;\\n  top: 50% !important;\\n  transform: translate(-50%, -50%) !important;\\n  border-radius: 50%;\\n  background: #F23A50;\\n  cursor: pointer;\\n}\\n\\n.breakpoints-line {\\n  background-color: rgba(242,58,80,0.4);\\n}\\n```\\n### \u6dfb\u52a0\u9f20\u6807\u53f3\u952e\u83dc\u5355\\n\\n\u4e3b\u8981\u662f\u4f7f\u7528 monaco \u5b9e\u4f8b\u4e0a\u7684 `addAction` \u65b9\u6cd5\uff0c\u6dfb\u52a0\u4e00\u4e2a\u53f3\u952e\u83dc\u5355\u3002\u4e3a\u4e86\u65b9\u4fbf\u4f7f\u7528\u53ef\u4ee5\u5c01\u88c5\u6210\u4e00\u4e2a hook\u3002  \\n\u8fd9\u91cc\u4ee5\u6dfb\u52a0\u4e00\u4e2a js \u4ee3\u7801\u7f8e\u5316\u529f\u80fd\u7684\u53f3\u952e\u83dc\u5355\u4e3a\u4f8b\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\\n```ts\\nimport * as monaco from \'monaco-editor\';\\nimport beautify from \'js-beautify\';\\nimport { useEffect } from \'react\';\\n\\n/**\\n * \u4e3a monaco-editor \u53f3\u952e\u9009\u9879\u6dfb\u52a0\u4ee3\u7801\u7f8e\u5316\u529f\u80fd\\n * @param editorInstance\\n */\\nconst useEditorBeautifyJsCode = (editorInstance?: monaco.editor.IStandaloneCodeEditor) => {\\n  useEffect(() => {\\n    if (editorInstance) {\\n      editorInstance.addAction({\\n        id: \'beautifyJsCode\',\\n        label: \'\u7f8e\u5316 JS \u4ee3\u7801\',\\n        keybindings: [monaco.KeyMod.CtrlCmd | monaco.KeyMod.Alt | monaco.KeyCode.KeyF],\\n        contextMenuGroupId: \'2_customCommand\',\\n        run() {\\n          const oldCode = editorInstance.getValue();\\n          const newCode = beautify(oldCode, {\\n            indent_size: 2,\\n          });\\n          editorInstance.executeEdits(\'\', [\\n            {\\n              range: new monaco.Range(1, 1, editorInstance.getModel()!.getLineCount() + 1, 1),\\n              text: newCode,\\n            },\\n          ]);\\n        },\\n      });\\n    }\\n  }, [editorInstance]);\\n};\\n\\nexport default useEditorBeautifyJsCode;\\n\\n```\\n\\n\u4f7f\u7528\\n```tsx\\nimport React, { useState, useCallback, useRef } from \\"react\\";\\nimport MonacoEditor from \\"react-monaco-editor\\";\\nimport { EditorDidMount} from \'react-monaco-editor/lib/types\';\\n\\nimport useEditorBeautifyJsCode from \'./useEditorBeautifyJsCode\'\\n\\nconst Demo = () => {\\n\\n  const editorRef = useRef<Parameters<EditorDidMount>[0]>(); // \u7f16\u8f91\u5668\u5b9e\u4f8b\\n  \\n  // This will right\\n  useEditorBeautifyJsCode(editorRef.current);\\n\\n  // \u83b7\u53d6\u7f16\u8f91\u5668\u5b9e\u4f8b\\n  const editorDidMountHandle: EditorDidMount = useCallback(\\n    (editor) => {\\n      editorRef.current = editor;\\n    },[]);\\n\\n  return (\\n    <MonacoEditor\\n      language=\\"javascript\\"\\n      height=\\"100%\\"\\n      theme=\\"vs\\"\\n      options={{\\n        roundedSelection: false,\\n        cursorStyle: \\"line\\",\\n        wordWrap: \\"on\\",\\n      }}\\n      editorDidMount={editorDidMountHandle}\\n    />\\n  );\\n};\\n\\n```\\n\\n<comment/>"},{"id":"Promise \u77e5\u8bc6\u70b9","metadata":{"permalink":"/apaas-front-doc/blog/Promise \u77e5\u8bc6\u70b9","source":"@site/blog/2022-08-01-Promise/index.md","title":"Promise \u77e5\u8bc6\u70b9","description":"\u56de\u8c03\u5730\u57df\u95ee\u9898","date":"2022-08-01T00:00:00.000Z","formattedDate":"2022\u5e748\u67081\u65e5","tags":[{"label":"JavaScript","permalink":"/apaas-front-doc/blog/tags/java-script"},{"label":"ES6","permalink":"/apaas-front-doc/blog/tags/es-6"},{"label":"Promise","permalink":"/apaas-front-doc/blog/tags/promise"}],"readingTime":6.63,"hasTruncateMarker":true,"authors":[{"name":"\u9ec4\u632f\u654f","title":"\u70df\u82b1\u6613\u51b7","job_no":25748,"url":"https://github.com/hzm0321","imageURL":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.92fa.com%2Fpic%2FTX1251_03.jpg&refer=http%3A%2F%2Fimg.92fa.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1670915005&t=61e1ff50cd599d4affcc74dfa4b7545d","key":"hzm"}],"frontMatter":{"slug":"Promise \u77e5\u8bc6\u70b9","title":"Promise \u77e5\u8bc6\u70b9","authors":["hzm"],"tags":["JavaScript","ES6","Promise"]},"prevItem":{"title":"react-monaco-editor \u5e38\u7528\u914d\u7f6e\u9879","permalink":"/apaas-front-doc/blog/react-monaco-editor \u5e38\u7528\u914d\u7f6e\u9879"}},"content":"### \u56de\u8c03\u5730\u57df\u95ee\u9898\\n\\n\u4f20\u7edf\u7684\u5f02\u6b65\u7f16\u7a0b\u65b9\u5f0f\u901a\u8fc7\u56de\u8c03\u51fd\u6570\uff0c\u5904\u7406\u5f02\u6b65\u4efb\u52a1\u5230\u671f\u7684\u6267\u884c\u95ee\u9898\u3002\u800c\u5f02\u6b65\u4efb\u52a1\u4e4b\u95f4\u5982\u679c\u4ea7\u751f\u4f9d\u8d56\u5173\u7cfb\uff0c\u5c31\u4f1a\u9677\u5165\u201c\u56de\u8c03\u5730\u57df\u201d\u95ee\u9898\u3002\\n\\n![callback](./callback.png)\\n\\n### \u72b6\u6001\\n`Promise` \u7684\u72b6\u6001`\u4e0d\u53ef\u9006`  \\n\u67093\u4e2a\u72b6\u6001\\n- **Pending**\\n- **Resolved**\\n- **Rejected**\\n\\n### \u9759\u6001\u65b9\u6cd5\\n\\n- **Promise.resolve**\\n- **Promise.reject**\\n\\n:::tip\\n\\n\u53ea\u63a5\u6536\u7b2c\u4e00\u4e2a\u53c2\u6570\\n\\n:::\\n\\n\x3c!--truncate--\x3e\\n\\n### \u5b9e\u4f8b\u65b9\u6cd5\\n\\n#### .then\\n\\n\u63a5\u65362\u4e2a\u53c2\u6570\uff0c`resolve` \u65b9\u6cd5\u548c `reject` \u65b9\u6cd5\uff0c\u5f62\u53c2\u4e3a\u4e0a\u4e00\u6b21\u72b6\u6001\u7684\u503c\u3002\u4e14\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u4e92\u65a5\uff0c\u53ea\u80fd\u8fdb\u5165\u4e00\u4e2a\u3002  \\n\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684 Promise \u5b9e\u4f8b\u3002\\n\\n**\u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a resolve \u72b6\u6001\u7684\u65b9\u5f0f\uff1a**\\n- return \u4e00\u4e2a\u503c\\n- return Promise.resolve(\u503c)\\n- \u4e0d\u5199 return\uff0c\u9ed8\u8ba4\u8fd4\u56de resolved \uff0c\u4f20\u9012\u7684\u503c\u4e3a `undefined`\\n\\n**\u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a rejected \u72b6\u6001\u7684\u65b9\u5f0f\uff1a**\\n- throw \u629b\u51fa\u4e00\u4e2a\u9519\u8bef\\n- return Promise.reject(\u503c)\\n- \u9519\u8bef\u4ee3\u7801\\n\\n#### .catch\\n\u63a5\u65361\u4e2a\u53c2\u6570\uff0c`reject` \u65b9\u6cd5\u3002\u5f62\u53c2\u4e3a\u4e0a\u4e00\u6b21 reject \u72b6\u6001\u7684\u503c\\n\u8fd4\u56de\u503c\u540c `.then` ,\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e2a`\u65b0\u7684 Promise`\\n\\n#### .finally\\n\u63a5\u6536\u4e00\u4e2a\u65b9\u6cd5\uff0c\u6ca1\u6709\u4efb\u4f55\u72b6\u6001\u503c\\n\u8fd4\u56de\u503c\u540c `.then` ,\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e2a`\u65b0\u7684 Promise`\\n\\n\u8fd4\u56de\u5f85\u5b9a Promise \uff0c\u53ea\u8981 Promise \u4e00\u89e3\u51b3\uff0c\u65b0 Promise \u4ecd\u7136\u4f1a\u539f\u6837\u540e\u4f20\u521d\u59cb\u7684 Promise\\n\\n```javascript\\nlet p1  = Promise.resolve(1);\\nlet p2 = p1.finally(() => {\\n  return new Promise((resolve, reject)=>{\\nsetTimeout(resolve,100,2)\\n  })\\n})\\n\\n\\n\\nsetTimeout(() => {\\n  setTimeout(console.log, 0, p2); // 1\\n},200)\\n```\\n### Thenable \u63a5\u53e3\u5bf9\u8c61\\n\\n\u5982\u679c\u8fd4\u56de\u4e00\u4e2a \u5b9e\u73b0\u4e86 `thenable` \u7684\u63a5\u53e3\u5bf9\u8c61\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 Promise \u4e0a\u7684 resolve \u548c reject \u65b9\u6cd5\u3002\\n\\n```javascript\\nconst p  = new Promise((resolve, reject) => {\\n  resolve(1)\\n}).then(() => {\\n  return {\\n    // \u5b9e\u73b0\u4e86 thenable \u63a5\u53e3\u5bf9\u8c61\\n    then: (resolve, reject) => {\\n      reject(2);\\n    }\\n  }\\n}).catch((error) => {\\n  return error\\n})\\n\\nsetTimeout(console.log,0,p)\\n```\\n\\n### \u5e42\u7b49\u6027(resolve)\\n\\n\u7ed9 Promise \u4f20\u5165 \u9759\u6001 Promise\uff0c\u7c7b\u4f3c\u4e8e\u7a7a\u5305\u88c5  \\n\\n```javascript\\nconst p = Promise.resolve(1);  \\nconsole.log(p === Promise.resolve(p)); // true  \\n```\\n\\n:::tip\\n\\n`Promise.reject` \u6ca1\u6709\u5e42\u7b49\u6027\uff0c\u7ed9\u5b83\u4f20\u5165\u4e00\u4e2a Promise\u5bf9\u8c61\uff0c\u4f1a\u53d8\u6210\u62d2\u7edd\u7684\u7406\u7531\\n\\n:::\\n\\n### \u4e8c\u5143\u6027\\n\\n\u540c\u6b65\u5bf9\u8c61(\u5728\u540c\u6b65\u6267\u884c\u6a21\u5f0f\u4e2d\u4f7f\u7528)\uff0c\u4f46\u4e5f\u662f\u5f02\u6b65\u6267\u884c\u6a21\u5f0f\u7684\u5a92\u4ecb \u3002\\n\\n```javascript\\n try {\\n    Promise.reject(new Error(\\"bar\\"));\\n  } catch (e) {\\n    // Promise.reject \u4e0d\u4f1a\u8fdb\u5165\\n    console.log(e);\\n  }\\n```\\n\\n### \u503c\u7a7f\u900f\\n\\n\u4f20\u7ed9 `then()` \u7684\u4efb\u4f55`\u975e\u51fd\u6570\u7c7b\u578b\u7684\u53c2\u6570`\u90fd\u4f1a\u88ab\u9759\u9ed8\u5ffd\u7565\\n\\n```javascript\\nlet p1  = Promise.resolve(1);\\nlet p2 = p1.then(2).then({}).then(undefined).then((res) => {\\n  console.log(res); // 1\\n})\\n```\\n\\n### \u72b6\u6001\u7a7f\u900f\\n\\n\u5e76\u4e0d\u662f\u8c03\u7528\u4e86 `resolve \u65b9\u6cd5`\u5c31\u4e00\u5b9a\u4f1a\u8fdb\u5165\u5b8c\u6210\u72b6\u6001\uff0c\u5982\u679c\u4f20\u5165\u7684\u662f\u4e00\u4e2a `promise \u72b6\u6001`\uff0c\u90a3\u4e48\u6700\u7ec8\u72b6\u6001\u7531\u8be5 promise \u72b6\u6001\u51b3\u5b9a\\n\\n### \u4e8b\u4ef6\u5faa\u73af\u673a\u5236\\n\\nPromise \u5c5e\u4e8e `\u5fae\u4efb\u52a1`\\n\\n### \u6279\u5904\u7406\\n\\n\u53ef\u4ee5\u7ed9 Promise \u6dfb\u52a0\u591a\u4e2a\u4efb\u52a1\uff0c\u6309\u6dfb\u52a0\u7684\u987a\u5e8f\u4f9d\u6b21\u6267\u884c\\n\\n```javascript\\nlet p1 = Promise.resolve();\\np1.then(() => setTimeout(console.log, 0, 1));\\np1.then(() => setTimeout(console.log, 0, 2));\\n// 1\\n// 2\\n```\\n\\n### \u4e2d\u65ad Promise \u94fe\\n\\n\u5728\u94fe\u8def\u4e2d\u8fd4\u56de `pending` \u72b6\u6001\u7684 Promise \uff0c\u5373\u53ef\u4e2d\u65ad\u540e\u7eed\u94fe\u8def\u3002\\n\\n```javascript\\nconst p1 = new Promise((resolve, reject) => {\\n  resolve(1);\\n}).then((res) => {\\n  console.log(res);\\n  // \u4e2d\u65ad\\n  return new Promise(()=>{})\\n}).then((res) => {\\n  console.log(res)\\n})\\n```\\n\\n### Promise \u961f\u5217\\n\\n**reduce \u5b9e\u73b0**\\n\\n```javascript\\nconst p1 = new Promise((resolve, reject) => {\\n  setTimeout(() => {\\n    resolve(1)\\n  },2000)\\n})\\n\\nconst p2 = new Promise((resolve) => {\\n  setTimeout(() => {\\n    resolve(2)\\n  },1000)\\n});\\n\\nconst p3 = new Promise((resolve) => {\\n  setTimeout(() => {\\n    resolve(3)\\n  },1000)\\n});\\n\\nconst promiseQueue = [p1,p2,p3];\\npromiseQueue.reduce((pre, cur) => {\\n  return pre.then(() =>{\\n    return cur.then((res) => {\\n      console.log(res)\\n    })\\n  })\\n},Promise.resolve())\\n```\\n\\n**forEach \u5b9e\u73b0**\\n\\n```javascript\\nconst numbs = [1,2,3,4];\\n\\nlet promise = Promise.resolve();\\n\\nnumbs.forEach((v) => {\\n  promise = promise.then(() => {\\n    return new Promise((resolve)=>{\\n      setTimeout(() => {\\n        console.log(v);\\n        resolve();\\n      },1000)\\n    })\\n  })\\n})\\n```\\n\\n### Promise.all\\n\\n\u63a5\u6536\u4e00\u4e2a Promise \u5b9e\u4f8b\u6570\u7ec4  \\n\u6570\u7ec4\u5185\u7684\u5168\u90e8 Promise \u5b9e\u4f8b`\u5168\u90fd\u53d8\u6210\u4e86 resolve \u72b6\u6001`\uff0c\u5c31\u8fdb\u5165 resolved \u72b6\u6001\u3002\u5982\u679c`\u6709\u4e00\u4e2a rejected` \u5c31\u8fdb\u5165 rejected \u72b6\u6001\u3002  \\n\u5982\u679c\u8fdb\u5165 resolved \u72b6\u6001\uff0c\u8fd4\u56de\u7684\u65b0 Promise \u5b9e\u4f8b\u7b2c\u4e00\u4e2a\u65b9\u6cd5\u53c2\u6570\u4f1a\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u4f20\u5165\u6bcf\u9879\u7ed3\u679c\u3002  \\n\u5982\u679c\u8fdb\u5165 rejected \u72b6\u6001\uff0c\u8fd4\u56de\u7684\u65b0 Promise \u5b9e\u4f8b\u7b2c\u4e8c\u4e2a\u65b9\u6cd5\u53c2\u6570\u4f1a\u4ee5\u5355\u4e2a\u503c\u7684\u5f62\u5f0f\u4f20\u5165\u62d2\u7edd\u7684\u7ed3\u679c\u3002  \\n\\n```javascript\\n// resolved \u72b6\u6001\\nconst p1 = Promise.resolve(1);\\nconst p2 = Promise.resolve(2);\\n\\nPromise.all([p1, p2]).then((res) => {\\n  console.log(res); // \u6253\u5370 [1,2]\\n}, (res) => {\\n  console.log(res);\\n})\\n\\n// rejected \u72b6\u6001\\nconst p1 = Promise.resolve(1);\\nconst p2 = Promise.reject(2);\\n\\nPromise.all([p1, p2]).then((res) => {\\n  console.log(res);\\n}, (res) => {\\n  console.log(res); // \u6253\u5370 2\\n})\\n```\\n\\n### Promise.race\\n\\n\u63a5\u6536\u4e00\u4e2a Promise \u5b9e\u4f8b\u6570\u7ec4  \\n\u53ea\u8981 Promise \u5b9e\u4f8b\u6570\u7ec4\u4e4b\u4e2d`\u6709\u4e00\u4e2a\u5b9e\u4f8b\u7387\u5148\u6539\u53d8\u72b6\u6001`\uff0cPromise.reace \u7684\u72b6\u6001\u5c31`\u8ddf\u7740\u6539\u53d8`\u3002\u90a3\u4e2a\u7387\u5148\u6539\u53d8\u7684 Promise \u5b9e\u4f8b\u7684\u8fd4\u56de\u503c\uff0c\u5c31\u4f20\u9012\u7ed9 Promise.reace \u7684\u56de\u8c03\u51fd\u6570\u3002  \\n\u8fd4\u56de\u7684\u65b0\u7684 Promise \u5b9e\u4f8b\uff0c\u4f1a\u4f20\u5165\u7b2c\u4e00\u4e2a\u6539\u53d8\u7684 Promise \u7ed3\u679c\u3002\\n\\n```javascript\\nconst p1 = Promise.resolve(1); // \u7387\u5148\u6539\u53d8\\nconst p2 = Promise.reject(2);\\n\\nPromise.race([p1, p2]).then((res) => {\\n  console.log(res); // 1\\n}, (res) => {\\n  console.log(res);\\n})\\n```\\n\\n### Promise.allSettled\\n\\n\u63a5\u6536\u4e00\u4e2a Promise \u5b9e\u4f8b\u6570\u7ec4  \\n\u53ea\u6709\u7b49\u5230\u53c2\u6570\u6570\u7ec4\u7684`\u6240\u6709 Promise \u5bf9\u8c61\u90fd\u53d1\u751f\u72b6\u6001\u53d8\u66f4\uff08\u4e0d\u7ba1\u662f resolved \u8fd8\u662f rejected \uff09`\uff0c\u8fd4\u56de\u7684 Promise \u5bf9\u8c61\u624d\u4f1a\u53d1\u751f\u72b6\u6001\u53d8\u66f4\u3002  \\n\u8fd4\u56de\u7684\u65b0\u7684 Promise \u5b9e\u4f8b\uff0c\u53ea\u63a5\u6536\u7b2c\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u4e14\u72b6\u6001\u4e3a resolved,\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u4f20\u5165\u6bcf\u9879\u7ed3\u679c\u3002\u6570\u7ec4\u7531\u5bf9\u8c61\u7ec4\u6210\u3002\u5bf9\u8c61\u4e2d\u5305\u542b2\u4e2a\u503c\u2014\u2014status\uff08Promise\u72b6\u6001\uff09 \u548c value\u3002\\n\\n```javascript\\nconst p1 = Promise.resolve(1);\\nconst p2 = Promise.reject(2);\\n\\nPromise.allSettled([p1, p2]).then((res) => {\\n  console.log(res); // [{ status: \'fulfilled\', value: 1 },{ status: \'rejected\', reason: 2 }]\\n})\\n```\\n\\n### Promise.any(ES 2021 \u65b0\u7279\u6027)\\n\\n\u63a5\u6536\u4e00\u4e2a Promise \u5b9e\u4f8b\u6570\u7ec4  \\n\u53ea\u8981\u53c2\u6570\u5b9e\u4f8b`\u6709\u4e00\u4e2a\u53d8\u6210 fulfilled \u72b6\u6001\uff0c\u5305\u88c5\u5b9e\u4f8b\u5c31\u4f1a\u53d8\u6210 fulfilled \u72b6\u6001`\uff1b\u5982\u679c\u6240\u6709\u53c2\u6570\u5b9e\u4f8b\u90fd\u53d8\u6210 rejected \u72b6\u6001\uff0c\u5305\u88c5\u5b9e\u4f8b\u5c31\u4f1a\u53d8\u6210 rejected \u72b6\u6001\u3002\\n\\n### \u5c01\u88c5\u4e00\u4e2a\u7b80\u6613\u5b9a\u65f6\u5668\\n\\n```javascript\\nfunction timeout(delay = 1000) {\\n  return new Promise((resolve, reject) => {\\n    setTimeout(() => {\\n      resolve();\\n    }, delay)\\n  })\\n}\\n```\\n\\n### \u8bed\u6cd5\u7cd6 async await\\n\\n<comment/>"}]}')}}]);